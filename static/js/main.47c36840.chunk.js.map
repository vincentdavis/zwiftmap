{"version":3,"sources":["App.module.css","RouteMap.module.css","RouteSelector.module.css","RouteSelector.tsx","RouteGeoJSONRepository.ts","RouteMap.tsx","App.tsx","index.tsx"],"names":["module","exports","filteredRoutes","routes","filter","route","world","sport","stravaid","sort","a","b","localeCompare","RouteSelector","selectedRouteId","routeId","onChange","className","styles","Container","Sidebar","map","c","Item","selected","routeid","onClick","routeGeoJSONCache","getRouteGeoJSON","fetch","response","json","MAX_BOUNDS","Mapbox","ReactMapboxGl","accessToken","minZoom","maxZoom","routePaint","RouteMap","geojson","useAsync","undefined","result","useState","setMap","useEffect","coordinates","geometry","bounds","reduce","coord","extend","LngLatBounds","fitBounds","padding","style","maxBounds","onStyleLoad","data","linePaint","App","setRouteId","Wrapper","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"y6uBACAA,EAAOC,QAAU,CAAC,QAAU,uB,mBCA5BD,EAAOC,QAAU,CAAC,UAAY,4BAA4B,kBAAoB,sC,kBCA9ED,EAAOC,QAAU,CAAC,UAAY,iCAAiC,QAAU,+BAA+B,KAAO,4BAA4B,SAAW,kC,qKCIhJC,EAA4BC,EAC/BC,QAAO,SAACC,GAAD,MAA2B,YAAhBA,EAAMC,SACxBF,QAAO,SAACC,GAAD,MAA2B,YAAhBA,EAAME,SACxBH,QAAO,SAACC,GAAD,OAAWA,EAAMG,SAAW,KACnCC,MAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAEL,MAAMO,cAAcD,EAAEN,UAO3B,SAASQ,EAAT,GAGJ,IAFAC,EAED,EAFRC,QACAC,EACQ,EADRA,SAEA,OACE,qBAAKC,UAAWC,IAAOC,UAAvB,SACE,qBAAKF,UAAWC,IAAOE,QAAvB,SACGlB,EAAemB,KAAI,SAAChB,GAAD,OAClB,wBAEEY,UAAWK,IAAEJ,IAAOK,KAAR,eACTL,IAAOM,SAAWV,IAAoBT,EAAMoB,UAE/CC,QAAS,kBAAMV,EAASX,EAAMoB,UALhC,SAOGpB,EAAMA,OANFA,EAAMoB,gB,2DCzBjBE,EAAgD,GAE/C,SAAeC,EAAtB,kC,4CAAO,WAA+Bb,GAA/B,eAAAL,EAAA,yDACAiB,EAAkBZ,GADlB,gCAEoBc,MAAM,YAAD,OAAad,EAAb,aAFzB,cAEGe,EAFH,gBAGgCA,EAASC,OAHzC,OAGHJ,EAAkBZ,GAHf,uCAMEY,EAAkBZ,IANpB,4C,mDCUDiB,EAAwB,CAC5B,CAAC,UAAW,UACZ,CAAC,UAAW,UAKRC,EAASC,YAAc,CAC3BC,YACE,mGACFC,QANe,GAOfC,QANe,KAWXC,EAAwB,CAC5B,aAAc,UACd,aAAc,GAOD,SAASC,EAAT,GAAuC,IAAnBxB,EAAkB,EAAlBA,QACjByB,EAAYC,YAAQ,sBAAC,sBAAA/B,EAAA,yDAC9BK,EAD8B,8CAE1B2B,GAF0B,uBAKtBd,EAAgBb,GALM,mFAMlC,CAACA,IANI4B,OAD2C,EAS7BC,wBAA0BF,GATG,mBAS5CrB,EAT4C,KASvCwB,EATuC,KA4BnD,OAjBAC,qBAAU,WACR,GAAKzB,GAAQmB,EAAb,CAIA,IAAMO,EAAkCP,EAAQQ,SAASD,YAEnDE,EAASF,EAAYG,QACzB,SAACD,EAAQE,GAAT,OAAmBF,EAAOG,OAAOD,KACjC,IAAIE,eAAaN,EAAY,GAAIA,EAAY,KAG/C1B,EAAIiC,UAAUL,EAAQ,CACpBM,QAAS,QAEV,CAAClC,EAAKmB,IAGP,eAACP,EAAD,CAEEuB,MA1CQ,yDA2CRvC,UAAWC,IAAOC,UAClBsC,UAAWzB,EACX0B,YAAa,SAACrC,GAAD,OAASwB,EAAOxB,IAL/B,UAOE,cAAC,IAAD,IAECmB,GAAW,cAAC,IAAD,CAAcmB,KAAMnB,EAASoB,UAAWtB,OCtE3C,SAASuB,IAAO,IAAD,EACEjB,qBADF,mBACrB7B,EADqB,KACZ+C,EADY,KAG5B,OACE,sBAAK7C,UAAWC,IAAO6C,QAAvB,UACE,cAAClD,EAAD,CAAeE,QAASA,EAASC,SAAU8C,IAC3C,cAACvB,EAAD,CAAUxB,QAASA,O,MCLzBiD,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAACL,EAAD,MAEFM,SAASC,eAAe,U","file":"static/js/main.47c36840.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"Wrapper\":\"App_Wrapper__2FdRQ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Container\":\"RouteMap_Container__15uh3\",\"navigationControl\":\"RouteMap_navigationControl__1ZKIj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Container\":\"RouteSelector_Container__2aeQm\",\"Sidebar\":\"RouteSelector_Sidebar__25tGa\",\"Item\":\"RouteSelector_Item__402nz\",\"selected\":\"RouteSelector_selected__2JMs6\"};","import routes from \"./routes.json\";\nimport styles from \"./RouteSelector.module.css\";\nimport c from \"classnames\";\nimport { Route } from \"./types\";\n\nconst filteredRoutes: Route[] = ((routes as unknown) as Route[])\n  .filter((route) => route.world === \"Watopia\")\n  .filter((route) => route.sport === \"cycling\")\n  .filter((route) => route.stravaid > 1)\n  .sort((a, b) => a.route.localeCompare(b.route));\n\ninterface Props {\n  routeId: number | undefined;\n  onChange: (routeKey: number | undefined) => void;\n}\n\nexport default function RouteSelector({\n  routeId: selectedRouteId,\n  onChange,\n}: Props) {\n  return (\n    <div className={styles.Container}>\n      <div className={styles.Sidebar}>\n        {filteredRoutes.map((route) => (\n          <button\n            key={route.routeid}\n            className={c(styles.Item, {\n              [styles.selected]: selectedRouteId === route.routeid,\n            })}\n            onClick={() => onChange(route.routeid)}\n          >\n            {route.route}\n          </button>\n        ))}\n      </div>\n    </div>\n  );\n}\n","const routeGeoJSONCache: { [routeid: number]: any } = {};\n\nexport async function getRouteGeoJSON(routeId: number): Promise<any> {\n  if (!routeGeoJSONCache[routeId]) {\n    const response = await fetch(`segments/${routeId}.geojson`);\n    routeGeoJSONCache[routeId] = await response.json();\n  }\n\n  return routeGeoJSONCache[routeId];\n}\n","import { LinePaint, LngLatBounds, Map } from \"mapbox-gl\";\nimport React, { useEffect, useState } from \"react\";\nimport ReactMapboxGl, {\n  GeoJSONLayer,\n  // ScaleControl,\n  ZoomControl,\n} from \"react-mapbox-gl\";\nimport { FitBounds } from \"react-mapbox-gl/lib/map\";\nimport { getRouteGeoJSON } from \"./RouteGeoJSONRepository\";\nimport { useAsync } from \"react-async-hook\";\nimport styles from \"./RouteMap.module.css\";\n\nconst MAX_BOUNDS: FitBounds = [\n  [166.8778, -11.70256],\n  [167.0321, -11.6259],\n];\nconst MIN_ZOOM = 13;\nconst MAX_ZOOM = 18;\n\nconst Mapbox = ReactMapboxGl({\n  accessToken:\n    \"pk.eyJ1IjoiYW5kaXBhZXR6b2xkIiwiYSI6ImNqOWgyY2F5NjBnNnAyeXBodzByemRsbWoifQ.wW4aCiUFv2PLhGB2S75sNg\",\n  minZoom: MIN_ZOOM,\n  maxZoom: MAX_ZOOM,\n});\n\nconst STYLE = \"mapbox://styles/andipaetzold/ckn7q8rj60q2f17qxug5shkjq\";\n\nconst routePaint: LinePaint = {\n  \"line-color\": \"#fc6719\",\n  \"line-width\": 4,\n};\n\ninterface Props {\n  routeId: number | undefined;\n}\n\nexport default function RouteMap({ routeId }: Props) {\n  const { result: geojson } = useAsync(async () => {\n    if (!routeId) {\n      return undefined;\n    }\n\n    return await getRouteGeoJSON(routeId);\n  }, [routeId]);\n\n  const [map, setMap] = useState<Map | undefined>(undefined);\n\n  useEffect(() => {\n    if (!map || !geojson) {\n      return;\n    }\n\n    const coordinates: [number, number][] = geojson.geometry.coordinates;\n\n    const bounds = coordinates.reduce(\n      (bounds, coord) => bounds.extend(coord),\n      new LngLatBounds(coordinates[0], coordinates[0])\n    );\n\n    map.fitBounds(bounds, {\n      padding: 20,\n    });\n  }, [map, geojson]);\n\n  return (\n    <Mapbox\n      // eslint-disable-next-line react/style-prop-object\n      style={STYLE}\n      className={styles.Container}\n      maxBounds={MAX_BOUNDS}\n      onStyleLoad={(map) => setMap(map)}\n    >\n      <ZoomControl />\n      {/* <ScaleControl /> */}\n      {geojson && <GeoJSONLayer data={geojson} linePaint={routePaint} />}\n    </Mapbox>\n  );\n}\n","import React, { useState } from \"react\";\nimport RouteSelector from \"./RouteSelector\";\nimport styles from \"./App.module.css\";\nimport RouteMap from \"./RouteMap\";\n\nexport default function App() {\n  const [routeId, setRouteId] = useState<number | undefined>();\n\n  return (\n    <div className={styles.Wrapper}>\n      <RouteSelector routeId={routeId} onChange={setRouteId} />\n      <RouteMap routeId={routeId} />\n    </div>\n  );\n}\n","import \"mapbox-gl/dist/mapbox-gl.css\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"app\")\n);\n"],"sourceRoot":""}