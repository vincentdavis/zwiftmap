(this["webpackJsonpzwiftmap-frontend"]=this["webpackJsonpzwiftmap-frontend"]||[]).push([[0],{172:function(e,t,n){e.exports={Container:"RouteMap_Container__1kS2N",MapContainer:"RouteMap_MapContainer__1oyLk",navigationControl:"RouteMap_navigationControl__2RyF3"}},226:function(e,t,n){e.exports={Wrapper:"App_Wrapper__2vPXK"}},229:function(e,t,n){e.exports={Container:"WorldSelect_Container__3BQ6b"}},250:function(e,t,n){e.exports={Dialog:"InfoDialog_Dialog__3j2NL"}},427:function(e,t,n){},428:function(e,t,n){"use strict";n.r(t);var a=n(478),r=n(252),i=n(0),c=n.n(i),o=n(39),s=n.n(o),A=n(5),l=n(226),u=n.n(l),d=n(10),j=n.n(d),b=n(14),f=n(20),p=n(40),g=(n(273),n(31)),O=n(444),h=n(489),v=n(484),m=n(445),x=n(490),w=n(130),y="strava-auth",k=Object(w.a)();function C(e,t){null===t?localStorage.removeItem(e):localStorage.setItem(e,t),k.emit(e,t)}function D(e){return localStorage.getItem(e)}function B(){var e=Object(i.useState)((function(){return null!==D(y)})),t=Object(A.a)(e,2),n=t[0],a=t[1];return Object(i.useEffect)((function(){!function(e,t){var n=function(e){return t(e)};k.on(e,n)}(y,(function(e){return a(null!==e)}))}),[]),n}window.addEventListener("storage",(function(e){e.key&&k.emit(e.key,e.newValue)}));var S=n(25),I=S.c.find((function(e){return"watopia"===e.slug})),M=[];function E(){var e=Object(i.useState)(T),t=Object(A.a)(e,2),n=t[0],a=t[1];return Object(i.useEffect)((function(){var e=function(){return a(T())};return window.addEventListener("popstate",e),function(){return window.removeEventListener("popstate",e)}}),[]),Object(i.useEffect)((function(){var e=function(e){return a(e)};return M.push(e),function(){M.splice(M.indexOf(e),1)}}),[]),[n,Object(i.useCallback)((function(e){var t=new URLSearchParams;switch(t.set("world",e.world.slug),e.query.length>0&&t.set("q",e.query),e.type){case"default":break;case"route":t.set("route",e.route.slug),e.segments.length>0&&t.set("segments",e.segments.map((function(e){return e.slug})).join(","));break;case"strava-activities":t.set("strava-activities","");break;case"strava-activity":t.set("strava-activity",e.stravaActivityId)}window.history.pushState(void 0,"","?".concat(t.toString())),a(e),M.forEach((function(t){return t(e)}))}),[])]}function T(){var e,t,n=new URLSearchParams(window.location.search),a=null!==(e=S.c.find((function(e){return e.slug===n.get("world")})))&&void 0!==e?e:I,r=null!==(t=n.get("q"))&&void 0!==t?t:"";if(n.has("route")){var i,c=S.a.filter((function(e){return e.world===(null===a||void 0===a?void 0:a.slug)})).find((function(e){return e.slug===n.get("route")})),o=(null!==(i=n.get("segments"))&&void 0!==i?i:"").split(",").map((function(e){return S.b.find((function(t){return t.slug===e}))})).filter((function(e){return!!e}));return c?{world:a,query:r,type:"route",route:c,segments:o}:{world:a,query:r,type:"default"}}return n.has("strava-activities")?{world:a,query:r,type:"strava-activities"}:n.has("strava-activity")?{world:a,query:r,type:"strava-activity",stravaActivityId:n.get("strava-activity")}:{world:a,query:r,type:"default"}}var F={bologna:{imageBounds:[[44.5308037,11.26261748],[44.45463821,11.36991729102076]],initialBounds:[[44.501423,11.294653],[44.478222,11.341099]],image:n.p+"static/media/bologna.6f13d4d4.png",backgroundColor:"#b9b9b8"},"crit-city":{imageBounds:[[-10.3657,165.7824],[-10.4038,165.8207]],initialBounds:[[-10.382352,165.798758],[-10.386016,165.803496]],image:n.p+"static/media/crit-city.3bab2d0f.png",backgroundColor:"#7c9938"},france:{imageBounds:[[-21.64155,166.1384],[-21.7564,166.26125]],initialBounds:[[-21.697812,166.148225],[-21.744906,166.202642]],image:n.p+"static/media/france.aded90ff.png",backgroundColor:"#6f992d"},innsbruck:{imageBounds:[[47.2947,11.3501],[47.2055,11.4822]],initialBounds:[[47.280902,11.386414],[47.214544,11.445934]],image:n.p+"static/media/innsbruck.9821ed90.png",backgroundColor:"#7c9938"},london:{imageBounds:[[51.5362,-.1776],[51.4601,-.0555]],initialBounds:[[51.511261,-.134875],[51.489256,-.072996]],image:n.p+"static/media/london.54ae112e.png",backgroundColor:"#6f992d"},"makuri-islands":{imageBounds:[[-10.73746,165.80468],[-10.81405,165.88222]],initialBounds:[[-10.743702,165.830083],[-10.775156,165.859212]],image:n.p+"static/media/makuri-islands.5fe6bee4.png",backgroundColor:"#7c9938"},"new-york":{imageBounds:[[40.81725,-74.0227],[40.74085,-73.9222]],initialBounds:[[40.799618,-73.982068],[40.763547,-73.949602]],image:n.p+"static/media/new-york.5bf9b5e8.png",backgroundColor:"#bbbbb7"},paris:{imageBounds:[[48.9058,2.2561],[48.82945,2.3722]],initialBounds:[[48.874328,2.294207],[48.860895,2.331992]],image:n.p+"static/media/paris.d1eaa520.png",backgroundColor:"#b9b9b9"},richmond:{imageBounds:[[37.5774,-77.48954],[37.5014,-77.394]],initialBounds:[[37.558393,-77.467668],[37.520429,-77.415864]],image:n.p+"static/media/richmond.72df812b.png",backgroundColor:"#7c9938"},watopia:{imageBounds:[[-11.62597,166.87747],[-11.70255,167.03255]],initialBounds:[[-11.635444,166.93555],[-11.673613,166.972511]],image:n.p+"static/media/watopia.0901a23e.png",backgroundColor:"#0884e2"},yorkshire:{imageBounds:[[54.0254,-1.632],[53.9491,-1.5022]],initialBounds:[[53.999691,-1.592961],[53.974875,-1.539474]],image:n.p+"static/media/yorkshire.b83235cf.png",backgroundColor:"#7c9938"}};function Q(e){if(null!==e.start_latlng)return S.c.find((function(t){var n=F[t.slug].imageBounds;return n[0][0]>=e.start_latlng[0]&&e.start_latlng[0]>=n[1][0]&&n[0][1]<=e.start_latlng[1]&&e.start_latlng[1]<=n[1][1]}))}var R=n(32),U=n(45),H=n.n(U);function L(){var e=D(y);return null===e?null:JSON.parse(e)}function N(e){C(y,JSON.stringify(e))}function W(){return z.apply(this,arguments)}function z(){return(z=Object(f.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=L()){e.next=3;break}return e.abrupt("return");case 3:return C(y,null),e.prev=4,e.next=7,H.a.post("https://www.strava.com/oauth/deauthorize",void 0,{params:{access_token:t.access_token}});case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:case"end":return e.stop()}}),e,null,[[4,9]])})))).apply(this,arguments)}function P(){window.location.href=function(e){var t=new URLSearchParams;return t.set("state",JSON.stringify(e)),"".concat("https://api.zwiftmap.com","/strava/authorize?").concat(t.toString())}(Object.fromEntries(new URLSearchParams(window.location.search).entries()))}function G(e){return J.apply(this,arguments)}function J(){return(J=Object(f.a)(j.a.mark((function e(t){var n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat("https://api.zwiftmap.com","/strava/refresh"),e.next=3,H.a.post(n,{refresh_token:t});case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Y=n(227),Z=n(228);function V(e){return JSON.stringify({url:e.url,params:e.params})}function X(){var e=new _;return{request:function(){var t=Object(f.a)(j.a.mark((function t(n){var a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=V(n),"get"!==n.method){t.next=11;break}if(!e.hasResponse(a)){t.next=10;break}return n.headers.cached=!0,t.next=6,e.getResponse(a);case 6:throw n.data=t.sent,n;case 10:e.prepareResponse(a);case 11:return t.abrupt("return",n);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),response:[function(t){var n;return"get"===(null===(n=t.config.method)||void 0===n?void 0:n.toLocaleLowerCase())&&e.storeResponse(V(t.config),t.data),t},function(e){return!0===e.headers.cached?Promise.resolve(e):Promise.reject(e)}]}}var q,K,_=function(){function e(){Object(Y.a)(this,e),this.store={},this.emitter=Object(w.a)()}return Object(Z.a)(e,[{key:"prepareResponse",value:function(e){var t=this;this.store[e]=new Promise((function(n){t.emitter.on(e,(function a(r){t.emitter.off(e,a),n(r)}))}))}},{key:"storeResponse",value:function(e,t){this.emitter.emit(e,t)}},{key:"hasResponse",value:function(e){return void 0!==this.store[e]}},{key:"getResponse",value:function(e){return this.hasResponse(e)?this.store[e]:Promise.reject()}}]),e}(),$=X(),ee=H.a.create({baseURL:"https://www.strava.com/api/v3"});function te(e){return ne.apply(this,arguments)}function ne(){return(ne=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.get("/activities/".concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(e){return re.apply(this,arguments)}function re(){return(re=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.get("/activities/".concat(t,"/streams"),{params:{keys:["distance","latlng","time","altitude","wattage","velocity_smooth","watts","cadence","heartrate"].join(","),key_by_type:!0}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(e){return ce.apply(this,arguments)}function ce(){return(ce=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.get("/segments/".concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(){return se.apply(this,arguments)}function se(){return(se=Object(f.a)(j.a.mark((function e(){var t,n,a=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,ee.get("/athlete/activities",{params:t});case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ae(e){return le.apply(this,arguments)}function le(){return(le=Object(f.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te(t);case 2:if(a=e.sent,r=Q(a)){e.next=6;break}throw new Error("Activity was not recorded in Zwift");case 6:return e.t0=a.id.toString(),e.t1=a.name,e.t2=a.athlete.id.toString(),e.t3=a.distance/1e3,e.t4=a.total_elevation_gain,e.t5=a.moving_time,e.t6=r,e.t7=a.average_watts,e.t8=null===(n=a.photos.primary)||void 0===n?void 0:n.urls[100],e.next=17,ue(t);case 17:return e.t9=e.sent,e.abrupt("return",{id:e.t0,name:e.t1,athleteId:e.t2,distance:e.t3,elevation:e.t4,time:e.t5,world:e.t6,avgWatts:e.t7,photoUrl:e.t8,streams:e.t9});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e){return de.apply(this,arguments)}function de(){return(de=Object(f.a)(j.a.mark((function e(t){var n,a,r,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae(t);case 2:return i=e.sent,e.abrupt("return",{altitude:i.altitude.data,cadence:null===(n=i.cadence)||void 0===n?void 0:n.data,distance:i.distance.data,heartrate:null===(a=i.heartrate)||void 0===a?void 0:a.data,latlng:i.latlng.data,time:i.time.data,velocity:i.velocity_smooth.data,watts:null===(r=i.watts)||void 0===r?void 0:r.data});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}ee.interceptors.request.use($.request),(q=ee.interceptors.response).use.apply(q,Object(R.a)($.response)),ee.interceptors.request.use(function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=L())){e.next=15;break}if(!(n.expires_at<Math.round(Date.now()/1e3))){e.next=14;break}return e.prev=3,e.next=6,G(n.refresh_token);case 6:N(n=e.sent),e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(3),e.next=14,W();case 14:t.headers=Object(b.a)(Object(b.a)({},t.headers),{},{Authorization:"".concat(n.token_type," ").concat(n.access_token)});case 15:return e.abrupt("return",t);case 16:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}());var je=X(),be=H.a.create();function fe(e,t,n){return pe.apply(this,arguments)}function pe(){return(pe=Object(f.a)(j.a.mark((function e(t,n,a){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be.get("".concat(n,"/").concat(t,"/").concat(a,".json"));case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(e,t,n){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(f.a)(j.a.mark((function e(t,n,a){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(a.map((function(e){return fe(t,n,e)})));case 2:return r=e.sent,e.abrupt("return",Object.fromEntries(a.map((function(e,t){return[e,r[t]]}))));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}be.interceptors.request.use(je.request),(K=be.interceptors.response).use.apply(K,Object(R.a)(je.response));var he=n(172),ve=n.n(he),me=n(483),xe=n(229),we=n.n(xe),ye=n(1),ke=Object(R.a)(S.c).sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return{label:e.name,value:e.slug}}));function Ce(){var e=E(),t=Object(A.a)(e,2),n=t[0],a=t[1];return Object(ye.jsx)("div",{className:we.a.Container,children:Object(ye.jsx)(me.a,{id:"world-select",options:ke,value:n.world.slug,listboxStyle:{zIndex:3e3},onChange:function(e){a({world:S.c.find((function(t){return t.slug===e})),query:"",type:"default"})}})})}function De(e){var t=e.mouseHoverDistance,n=e.previewRoute,a=E(),r=Object(A.a)(a,1)[0],c=r.world,o=F[c.slug],s=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("route"===t.type){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,Promise.all(t.segments.map((function(e){return fe(e.slug,"segments","latlng")})));case 4:return n=e.sent,e.abrupt("return",t.segments.map((function(e,t){return Object(b.a)(Object(b.a)({},e),{},{stravaData:n[t]})})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[r]).result,l=Object(i.useState)(),u=Object(A.a)(l,2),d=u[0],w=u[1];Object(i.useEffect)((function(){null===d||void 0===d||d.zoomControl.setPosition("topright")}),[d]);var y=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("route"===t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,ge(n.slug,"routes",["distance","latlng"]);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[r.type,r.route]).result,k=B(),C=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&"strava-activity"===n.type){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Ae(n.stravaActivityId);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[k,r]).result,D=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,ge(t,"routes",["latlng"]);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n]).result;Object(i.useEffect)((function(){if(d&&y){var e=y.latlng.reduce((function(e,t){return e.extend(t)}),new p.LatLngBounds(y.latlng[0],y.latlng[0]));d.invalidateSize(),d.fitBounds(e)}}),[d,y,o]),Object(i.useEffect)((function(){if(d){var e=F[r.world.slug];d.invalidateSize(),d.setMaxBounds(e.imageBounds);var t=d.getBoundsZoom(e.imageBounds,!1);d.setMinZoom(t),"route"!==r.type&&d.fitBounds(e.initialBounds)}}),[d,r.world,r.type]);var S=Object(i.useMemo)((function(){if(y&&t){var e=y.distance.findIndex((function(e){return e>1e3*t}));if(e)return y.latlng[e]}}),[y,t]);return Object(ye.jsxs)("div",{className:ve.a.Container,children:[Object(ye.jsx)(Ce,{}),Object(ye.jsxs)(O.a,{whenCreated:function(e){return w(e)},bounds:o.imageBounds,style:{backgroundColor:o.backgroundColor},maxZoom:19,className:ve.a.MapContainer,children:[Object(ye.jsx)(h.a,{url:o.image,bounds:o.imageBounds,attribution:'&copy <a href="https://zwift.com" rel="noreferrer noopener">Zwift</a>'}),D&&Object(ye.jsx)(v.a,{name:"preview-route",style:{zIndex:506},children:Object(ye.jsx)(m.a,{positions:D.latlng,pathOptions:{color:"#D3D3D3",weight:5}})}),y&&Object(ye.jsx)(v.a,{name:"route",style:{zIndex:504},children:Object(ye.jsx)(m.a,{positions:y.latlng,pathOptions:{color:"#fc6719",weight:5}})}),C&&Object(ye.jsx)(v.a,{name:"strava-activity",style:{zIndex:504},children:Object(ye.jsx)(m.a,{positions:C.streams.latlng,pathOptions:{color:"#fc6719",weight:5}})}),s&&Object(ye.jsx)(v.a,{name:"segments",style:{zIndex:505},children:null===s||void 0===s?void 0:s.map((function(e){return Object(ye.jsx)(m.a,{positions:e.stravaData,pathOptions:{color:"#64ac39",weight:8}},e.slug)}))}),S&&Object(ye.jsx)(v.a,{name:"mouse-position",style:{zIndex:507},children:Object(ye.jsx)(x.a,{center:S,radius:15,pathOptions:{color:"black",fillColor:"black",fillOpacity:1}})})]},r.world.slug)]})}var Be=n(107),Se=n(475),Ie=n(443),Me=n(230),Ee=n(476),Te=n(477),Fe=n(4),Qe=n.n(Fe),Re=n(464),Ue=n(486),He=n(441),Le=n(463),Ne=n(430),We=n(458),ze=n(459),Pe=n(460),Ge=n(461),Je=n(453),Ye=n(462),Ze=n(457),Ve=n(452),Xe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACXlBMVEX/awD/agD/aQD/aAD/ZwD/ZQD/ZAD/YgD/YQD/YAD/XwD/XQD/XAD/WgD/WQD/VwD/VgD/VAD/UwD/UQD/WwD/UgD/UAD/XgD/gjj/eCr/TwD/TgD/Zgv/z7T/vJb/XgL/j07/+vf/8Oj/fTT/z7P/////vJj/XAP/TQD/TAD/kVD/+fb/8en/fTf/ZQz/0bb/vZr/WgT/kFD/8uv/fjr/VQD/waD/WQX/SwD/klP/9O3/fz3/ZQ7/0rn/w6T/WAb/SgD/klb//f3//v3/9O//gEL/0rr/y7H/1L//xan/Vgj/SQD/fj3/ilD/9vH/gEX/ZA//07z/WAX/Wwv/zbX/x63/Vgn/WAD/k1r/+/n/f0D/iE//+PX/9/P/gkr/ZBD/1b7/waL/WQr/yrD/ya//VQr/lFr/8+3/fT7/hEn/hE3/ZBH/1L3/vp7/VwX/UgH/Vwn/xqr//fz/yrH/VQz/TAH/SwH/ZBP/kVj/lV7/k17/kl3/bCP/Yxj/jlf/kFr/j1r/nGz/kF//i1j/iVb/iFT/jln/jVn/jVr/h1H/Vg//Wgv/nm7/tpH/tZD/rYX/aCT/SAD/dDb/sIr/so7/s4//j13/TQT/dTT/sYv/sYz/sY3/k2D/UAX/Vg3/nXD/sIz/qoL/ZSP/Vgr/mmr/sIv/rIX/ayj/dzv/jFj/TAP/cS//rof/kl//WxP/qoH/ZCL/Ugj/l2b/q4T/lGH/roj/by//qYD/YyD/Ugf/lmX/ilT/SwL/bCv/qH//YR3/TwX/iVP/aSj/TQX/kV//aSn/pHn/YR7/Tgf/ayv0qRl1AAAAAWJLR0QlwwHJDwAAAAd0SU1FB+UECw4ZCUCePeYAAAJ3SURBVDjLjdTnX9NAGMDxsypim66kabXFgXraiFvRqijR4jz3qgPce6EoOHDj3hFxEEcdVxXBvTdu/yvvujIuH/FetHnx/fyaNs9TAOhpZbPZWrchp21OTrvc3PZ2u8Ph4JxOl9vt9ni9Xl4Q/uF8WecVU7ClHnUC6+yWzs+4QIeOHOuCIaaX16lzFwsXAqb7c3TN79bd6TN9bigJ9S6Q1wPCnr2YXlgCxu/L9S6AsE9ft6kXliRgcIF+/SE5AwaaewQafj/foAIKBw8pNPVSUPudU0EIhw4z9aQI0Dvf8PwUHDFSNPYiBGqOKxoF02d0MW/oRWSge76+MTQ4NkpeSsYFDT1ZBprjisbT2ISJ9HXSZENPRkCbF2cyWDJlKv3m06YH9T2EgDZXM2Ym727W7Dn0fe48g0Mg62LzF9DgQlFcVEouyhZLekdgZk6XLKWhZcVefvkKerVyld4hkJn72GoaXLNW5MXgujJyWbpeJizjEEj3XBs2wmgUbtrMl5cLW7bCigq4bbtUWVmVdgSm5j62Y+eu3dXVe0Rh7779Bw4eqjl8pOboseMnTqIMzOyHp5A+C1H0nzp95uy58wpSLtRerLt0WQdNc++/crVevXY9cuOmGr91W9Egsx937qo4cQ/dr8XqgwaUhRyzH+GHjVhtekSCj58oGmT3Lfz0mYqfv3hpCBLoYvYj8qoR4ziOv36j6CC7b5L09p2KMVbff0A6yO6bJMkfExjXf/qsGKGH2Q/5S5OK1eYqZIBMjzxf9DVhCiLA9ugcfPte16y/QwItemQOlB8/fykMZHrk/P7TgMyQ7VkdwFv1rKDwfy4J6f9kSw79BReDIgKN7zeEAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIxLTA0LTExVDE0OjI0OjUyKzAwOjAwCFzYFAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMS0wNC0xMVQxNDoyNDozMiswMDowML9uaS8AAAAASUVORK5CYII=",qe="settings",Ke=[];function _e(){try{var e,t,n,a=null!==(e=localStorage.getItem(qe))&&void 0!==e?e:"{}",r=JSON.parse(a);return{sport:null!==(t=r.sport)&&void 0!==t?t:"cycling",units:null!==(n=r.units)&&void 0!==n?n:"metric"}}catch(i){return{sport:"cycling",units:"metric"}}}function $e(){var e=Object(i.useState)(_e),t=Object(A.a)(e,2),n=t[0],a=t[1];return Object(i.useEffect)((function(){var e=function(e){return a(e)};return Ke.push(e),function(){Ke.splice(Ke.indexOf(e),1)}}),[n]),[n,Object(i.useCallback)((function(e){a(e),function(e){localStorage.setItem(qe,JSON.stringify(e))}(e),Ke.forEach((function(t){return t(e)}))}),[])]}var et=new Intl.NumberFormat("en-US",{minimumFractionDigits:1,maximumFractionDigits:1,style:"decimal"}),tt=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0,style:"decimal"});function nt(e){var t=e.distance,n=$e();switch(Object(A.a)(n,1)[0].units){case"imperial":var a=t/1.609;return a<.3?Object(ye.jsxs)(ye.Fragment,{children:[tt.format(5280*a),"ft"]}):Object(ye.jsxs)(ye.Fragment,{children:[et.format(a),"mi"]});case"metric":return t<1?Object(ye.jsxs)(ye.Fragment,{children:[tt.format(1e3*t),"m"]}):Object(ye.jsxs)(ye.Fragment,{children:[et.format(t),"km"]})}}var at=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0,style:"decimal"});function rt(e){var t=e.elevation,n=$e();switch(Object(A.a)(n,1)[0].units){case"imperial":return Object(ye.jsxs)(ye.Fragment,{children:[at.format(3.28084*t),"ft"]});case"metric":return Object(ye.jsxs)(ye.Fragment,{children:[at.format(t),"m"]})}}var it=n(137),ct=n.n(it),ot=n(446),st=n(447),At=n(451),lt=n(246),ut=n(247),dt=n(117),jt=n(256);function bt(){return Object(ye.jsxs)("linearGradient",{id:"colorElevation",x1:"0",y1:"0",x2:"0",y2:"1",children:[Object(ye.jsx)("stop",{offset:"5%",stopColor:"black",stopOpacity:.8}),Object(ye.jsx)("stop",{offset:"95%",stopColor:"black",stopOpacity:0})]})}var ft=["altitude","distance"];function pt(e){var t=e.route,n=e.onMouseHoverDistanceChange,a=Object(g.a)(ge,[t.slug,"routes",ft]).result,r=Object(i.useState)(void 0),c=Object(A.a)(r,2),o=c[0],s=c[1],l=function(e){n(null===e||void 0===e?void 0:e.distance),s(e)},u=Object(i.useMemo)((function(){if(void 0!==a)return ct()(a.distance.map((function(e,t){return{distance:Math.round(e/10)/100,elevation:a.altitude[t]}})),(function(e,t){return e.distance===t.distance}))}),[a]);return void 0===u?null:Object(ye.jsxs)("div",{style:{width:"100%",height:100,marginBottom:"1em"},children:[Object(ye.jsx)(ot.a,{width:"100%",height:"100%",children:Object(ye.jsxs)(st.a,{data:u,margin:{top:25,right:15,left:15,bottom:15},baseValue:"dataMin",children:[Object(ye.jsx)("defs",{children:Object(ye.jsx)(bt,{})}),Object(ye.jsx)(At.a,{vertical:!1}),Object(ye.jsx)(lt.a,{name:"Distance",dataKey:"distance",type:"number",allowDecimals:!1,tick:!1,unit:"km",domain:[0,"dataMax"],hide:!0}),Object(ye.jsx)(ut.a,{name:"Elevation",type:"number",allowDecimals:!1,tickCount:5,domain:["dataMin","auto"],unit:"m",hide:!0}),Object(ye.jsx)(dt.a,{content:function(e){return Object(ye.jsx)(gt,Object(b.a)(Object(b.a)({},e),{},{onMouseMove:l}))},isAnimationActive:!1,position:{y:10},cursor:{stroke:"black"}}),Object(ye.jsx)(jt.a,{type:"monotone",dataKey:"elevation",name:"Elevation",stroke:"black",fillOpacity:1,fill:"url(#colorElevation)",unit:"m",isAnimationActive:!1})]})}),Object(ye.jsxs)("div",{style:{display:"flex",gap:"1em"},children:[Object(ye.jsxs)(Ve.a,{type:"caption",style:{whiteSpace:"nowrap"},children:["Distance:"," ",(null===o||void 0===o?void 0:o.distance)?Object(ye.jsx)(nt,{distance:o.distance}):"- km"]}),Object(ye.jsxs)(Ve.a,{type:"caption",style:{whiteSpace:"nowrap"},children:["Altitude:"," ",(null===o||void 0===o?void 0:o.altitude)?Object(ye.jsx)(rt,{elevation:o.altitude}):"- m"]})]})]})}function gt(e){return Object(i.useEffect)((function(){void 0===e.payload||0===e.payload.length?e.onMouseMove(void 0):e.onMouseMove({distance:e.payload[0].payload.distance,altitude:e.payload[0].payload.elevation})}),[e]),null}var Ot,ht,vt,mt=n(492),xt=n(248),wt=n.n(xt);function yt(){return kt.apply(this,arguments)}function kt(){return(kt=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ot){e.next=4;break}return e.next=3,H.a.get("https://us-or-rly101.zwift.com/api/public/events/upcoming").then((function(e){return e.data}));case 3:Ot=e.sent;case 4:return e.next=6,Ot;case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ct(e){var t=e.route,n=Object(g.a)(yt,[]).result,a=Object(i.useMemo)((function(){if(n)return n.filter((function(e){var n=[e.routeId].concat(Object(R.a)(e.eventSubgroups.map((function(e){return e.routeId}))));return t.id&&n.includes(t.id)})).sort((function(e,t){return e.eventStart.localeCompare(t.eventStart)}))}),[n,t]);return void 0===a?Object(ye.jsx)(Me.a,{children:Object(ye.jsx)(mt.a,{id:"loading-events",small:!0,circleStyle:{stroke:"black"}})}):0===a.length?Object(ye.jsx)(Me.a,{children:Object(ye.jsx)(Ve.a,{type:"body-2",children:"No events on this route today."})}):Object(ye.jsxs)(ye.Fragment,{children:[a.slice(0,3).map((function(e){var t;return Object(ye.jsx)(Ne.a,{onClick:function(){return window.open("http://zwift.com/events/view/".concat(e.id),"_blank")},rightAddon:Object(ye.jsx)(Je.a,{}),rightAddonType:"icon",secondaryText:Object(ye.jsxs)(ye.Fragment,{children:[new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",weekday:"short"}).format(Date.parse(e.eventStart)),Object(ye.jsx)("br",{}),null!==(t=Dt[e.eventType])&&void 0!==t?t:e.eventType," |\xa0",0!==e.distanceInMeters?Object(ye.jsx)(nt,{distance:e.distanceInMeters/1e3}):e.durationInSeconds>0?Object(ye.jsxs)(ye.Fragment,{children:[wt()(e.durationInSeconds)/60,"min"]}):Object(ye.jsx)(ye.Fragment,{children:1===e.laps?"1 lap":"".concat(e.laps," laps")})]}),threeLines:!0,children:e.name},e.id)})),a.length>3&&Object(ye.jsx)(Me.a,{children:Object(ye.jsxs)(Ve.a,{type:"body-2",children:[a.length-3," more"," ",4===a.length?"event":"events"," happening today"]})})]})}!function(e){e.CullingEventOnly="CULLING_EVENT_ONLY",e.CullingEverybody="CULLING_EVERYBODY",e.CullingSubgroupOnly="CULLING_SUBGROUP_ONLY"}(ht||(ht={})),function(e){e.TourOfWatopiaRideStage5="Tour of Watopia - Ride Stage 5",e.TourOfWatopiaRunStage5="Tour of Watopia - Run Stage 5"}(vt||(vt={}));var Dt={GROUP_RIDE:"Group Ride",GROUP_WORKOUT:"Workout",RACE:"Race",TIME_TRIAL:"Time Trial"},Bt=n(454),St=n(455);function It(e){var t=e.seconds,n=t%60,a=(t-n)/60%60,r=((t-n)/60-a)/60;return 0===r?0===a?Object(ye.jsxs)(ye.Fragment,{children:[n,"s"]}):Object(ye.jsxs)(ye.Fragment,{children:[a,":",n.toString().padStart(2,"0"),"min"]}):Object(ye.jsxs)(ye.Fragment,{children:[r,":",a.toString().padStart(2,"0"),":",n.toString().padStart(2,"0"),"h"]})}function Mt(e){var t=e.route,n=E(),a=Object(A.a)(n,2),r=a[0],i=a[1],c=S.b.filter((function(e){return e.world===t.world})).filter((function(e){return t.segments.includes(e.slug)})).sort((function(e,t){return e.name.localeCompare(t.name)}));if(0===c.length)return Object(ye.jsx)(Me.a,{children:Object(ye.jsx)(Ve.a,{type:"body-2",children:"No segments on this route."})});var o=r.segments;return Object(ye.jsx)(ye.Fragment,{children:c.map((function(e){return Object(ye.jsx)(Ne.a,{disabled:void 0===e.stravaSegmentId,rightAddonType:"icon",rightAddon:void 0===e.stravaSegmentId?null:o.includes(e)?Object(ye.jsx)(Bt.a,{}):Object(ye.jsx)(St.a,{}),secondaryText:Object(ye.jsx)(Et,{segment:e}),threeLines:!0,onClick:function(){void 0!==e.stravaSegmentId&&(o.includes(e)?i(Object(b.a)(Object(b.a)({},r),{},{type:"route",route:r.route,segments:o.filter((function(t){return t!==e}))})):i(Object(b.a)(Object(b.a)({},r),{},{type:"route",route:r.route,segments:[].concat(Object(R.a)(o),[e])})))},children:e.name},e.slug)}))})}function Et(e){var t,n=e.segment,a=B(),r=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t&&n){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,ie(t.toString());case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[n.stravaSegmentId,a]).result,i=(null!==(t=null===r||void 0===r?void 0:r.athlete_segment_stats.effort_count)&&void 0!==t?t:0)>0?null===r||void 0===r?void 0:r.athlete_segment_stats.pr_elapsed_time:null;return Object(ye.jsxs)(ye.Fragment,{children:[Object(ye.jsx)(nt,{distance:n.distance}),n.avgIncline&&Object(ye.jsxs)(ye.Fragment,{children:[" ","|"," ",new Intl.NumberFormat("en-US",{minimumFractionDigits:1,maximumFractionDigits:1,style:"percent"}).format(n.avgIncline/100)]}),Object(ye.jsx)("br",{}),i?Object(ye.jsxs)(ye.Fragment,{children:["PB: ",Object(ye.jsx)(It,{seconds:i})]}):Tt[n.type]]})}var Tt={climb:"Climb",sprint:"Sprint",segment:"Segment"},Ft=n(456);function Qt(e){var t=e.route,n=B(),a=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&void 0!==n){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,ie(n.toString());case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[n,t.stravaSegmentId]),r=a.result,i=a.loading,c=a.error;if(i)return Object(ye.jsx)(Me.a,{leftAddon:Object(ye.jsx)(Ft.a,{}),leftAddonType:"icon",rightAddon:Object(ye.jsx)(Ze.a,{}),rightAddonType:"icon",children:Object(ye.jsx)(mt.a,{id:"strava-route-pb-".concat(t.id),circleStyle:{stroke:"black"},small:!0})});if(c||null===r||void 0===r)return null;return Object(ye.jsx)(Ne.a,{leftAddon:Object(ye.jsx)(Ft.a,{}),leftAddonType:"icon",rightAddon:Object(ye.jsx)(Ze.a,{}),rightAddonType:"icon",onClick:function(){window.open("https://www.strava.com/segments/".concat(r.id),"_blank")},children:0===r.athlete_segment_stats.effort_count?Object(ye.jsx)(ye.Fragment,{children:"No time set"}):Object(ye.jsx)(It,{seconds:r.athlete_segment_stats.pr_elapsed_time})})}function Rt(e){var t=e.route,n=e.onMouseHoverDistanceChange,a=e.backButtonText,r=e.onBackButtonClick,i=S.c.find((function(e){return e.slug===t.world}));return Object(ye.jsxs)(Ie.a,{children:[Object(ye.jsx)(Me.a,{children:Object(ye.jsx)(Ue.a,{themeType:"outline",onClick:r,children:Object(ye.jsx)(He.a,{icon:Object(ye.jsx)(We.a,{}),children:a})})}),Object(ye.jsx)(Me.a,{children:Object(ye.jsx)(Ve.a,{type:"headline-6",style:{margin:0},children:t.name})}),Object(ye.jsxs)(Me.a,{clickable:!1,leftAddon:Object(ye.jsx)(ze.a,{}),leftAddonType:"icon",children:[Object(ye.jsx)(nt,{distance:t.distance}),void 0!==t.leadInDistance&&Object(ye.jsxs)(ye.Fragment,{children:["\xa0",Object(ye.jsxs)("small",{children:["(+",Object(ye.jsx)(nt,{distance:t.leadInDistance}),")"]})]})]}),Object(ye.jsxs)(Me.a,{clickable:!1,leftAddon:Object(ye.jsx)(Pe.a,{}),leftAddonType:"icon",children:[Object(ye.jsx)(rt,{elevation:t.elevation}),void 0!==t.leadInElevation&&Object(ye.jsxs)(ye.Fragment,{children:["\xa0",Object(ye.jsxs)("small",{children:["(+",Object(ye.jsx)(rt,{elevation:t.leadInElevation}),")"]})]})]}),t.experience&&Object(ye.jsxs)(Me.a,{clickable:!1,leftAddon:Object(ye.jsx)(Ge.a,{}),leftAddonType:"icon",children:[t.experience,"XP"]}),t.eventOnly&&Object(ye.jsx)(Me.a,{clickable:!1,leftAddon:Object(ye.jsx)(Je.a,{}),leftAddonType:"icon",children:"Event only route"}),Object(ye.jsx)(Me.a,{clickable:!1,leftAddon:Object(ye.jsx)(Ye.a,{}),children:i.name}),Object(ye.jsx)(Qt,{route:t}),Object(ye.jsx)(Me.a,{children:Object(ye.jsx)(pt,{route:t,onMouseHoverDistanceChange:n})}),Object(ye.jsx)(Le.a,{children:"Upcoming Events"}),Object(ye.jsx)(Ct,{route:t}),Object(ye.jsx)(Le.a,{children:"Segments"}),Object(ye.jsx)(Mt,{route:t}),Object(ye.jsx)(Le.a,{children:"Links"}),t.zwiftInsiderUrl&&Object(ye.jsx)(Ne.a,{onClick:function(){return window.open(t.zwiftInsiderUrl,"_blank")},leftAddon:Object(ye.jsx)(Re.a,{color:"#fc6719",children:Object(ye.jsx)("img",{src:"data:image/jpeg;base64,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",alt:""})}),leftAddonType:"avatar",rightAddon:Object(ye.jsx)(Ze.a,{}),rightAddonType:"icon",children:"ZwiftInsider"}),t.stravaSegmentUrl&&Object(ye.jsx)(Ne.a,{onClick:function(){return window.open(t.stravaSegmentUrl,"_blank")},leftAddon:Object(ye.jsx)(Re.a,{color:"#ff6b00",children:Object(ye.jsx)("img",{src:Xe,alt:""})}),leftAddonType:"avatar",rightAddon:Object(ye.jsx)(Ze.a,{}),rightAddonType:"icon",children:"Strava Segment"}),t.whatsOnZwiftUrl&&Object(ye.jsx)(Ne.a,{onClick:function(){return window.open(t.whatsOnZwiftUrl,"_blank")},leftAddon:Object(ye.jsx)(Re.a,{color:"#000000",children:Object(ye.jsx)("img",{src:"data:image/png;base64,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",alt:""})}),leftAddonType:"avatar",rightAddon:Object(ye.jsx)(Ze.a,{}),rightAddonType:"icon",children:"What's on Zwift"})]})}function Ut(e){var t=e.activityId;return B()?Object(ye.jsx)(Ht,{activityId:t}):Object(ye.jsx)(Ie.a,{children:Object(ye.jsx)(Ne.a,{leftAddon:Object(ye.jsx)(Re.a,{color:"#ff6b00",children:Object(ye.jsx)("img",{src:Xe,alt:""})}),leftAddonType:"avatar",rightAddon:Object(ye.jsx)(Ze.a,{}),rightAddonType:"icon",secondaryText:"\u2026to view Strava activity",onClick:P,children:"Authorize Strava App\u2026"})})}function Ht(e){var t=e.activityId,n=E(),a=Object(A.a)(n,2),r=a[0],i=a[1],c=Object(g.a)(Ae,[t]),o=c.result,s=c.loading;return o?Object(ye.jsxs)(Ie.a,{children:[Object(ye.jsx)(Me.a,{children:Object(ye.jsx)(Ue.a,{themeType:"outline",onClick:function(){i({world:r.world,query:r.query,type:"strava-activities"})},children:Object(ye.jsx)(He.a,{icon:Object(ye.jsx)(We.a,{}),children:"Strava activities"})})}),Object(ye.jsx)(Me.a,{children:Object(ye.jsx)(Ve.a,{type:"headline-6",style:{margin:0},children:o.name})}),Object(ye.jsx)(Me.a,{clickable:!1,leftAddon:Object(ye.jsx)(Ft.a,{}),leftAddonType:"icon",children:Object(ye.jsx)(It,{seconds:o.time})}),Object(ye.jsx)(Me.a,{clickable:!1,leftAddon:Object(ye.jsx)(ze.a,{}),leftAddonType:"icon",children:Object(ye.jsx)(nt,{distance:o.distance})}),Object(ye.jsx)(Me.a,{clickable:!1,leftAddon:Object(ye.jsx)(Pe.a,{}),leftAddonType:"icon",children:Object(ye.jsx)(rt,{elevation:o.elevation})}),Object(ye.jsx)(Me.a,{clickable:!1,leftAddon:Object(ye.jsx)(Ye.a,{}),children:o.world.name}),Object(ye.jsx)(Le.a,{children:"Links"}),Object(ye.jsx)(Ne.a,{onClick:function(){return window.open("https://www.strava.com/activities/".concat(o.id),"_blank")},leftAddon:Object(ye.jsx)(Re.a,{color:"#000000",children:Object(ye.jsx)("img",{src:Xe,alt:""})}),leftAddonType:"avatar",rightAddon:Object(ye.jsx)(Ze.a,{}),rightAddonType:"icon",children:"Activity on Strava"})]}):s?Object(ye.jsx)(mt.a,{id:"strava-activity-".concat(t),circleStyle:{stroke:"black"}}):Object(ye.jsx)(Ie.a,{children:Object(ye.jsx)(Me.a,{secondaryText:"Make sure you can access the activity and it was recorded in Zwift.",threeLines:!0,children:"An error occurred"})})}function Lt(e){e.world;return null}function Nt(e){var t=e.onMouseHoverDistanceChange,n=e.backButtonText,a=e.onBackButtonClick,r=E(),i=Object(A.a)(r,1)[0];return"route"===i.type?Object(ye.jsx)(Rt,{route:i.route,onMouseHoverDistanceChange:t,backButtonText:n,onBackButtonClick:a}):"strava-activity"===i.type?Object(ye.jsx)(Ut,{activityId:i.stravaActivityId}):Object(ye.jsx)(Lt,{world:i.world})}var Wt=n(48),zt=n.n(Wt),Pt=n(470),Gt=n(471),Jt=n(473),Yt=n(474),Zt=n(482),Vt=n(472),Xt=n(429),qt=n(440),Kt=n(249);var _t=n(480),$t=n(465),en=n(466),tn=n(467),nn=n(468),an=n(250),rn=n.n(an);function cn(e){var t=e.visible,n=e.onClose;return Object(ye.jsxs)(_t.a,{id:"info-dialog","aria-labelledby":"info-dialog-title",visible:t,onRequestClose:n,className:rn.a.Dialog,children:[Object(ye.jsx)($t.a,{style:{paddingBottom:0},children:Object(ye.jsx)(en.a,{id:"info-dialog-title",children:"Zwift Map"})}),Object(ye.jsxs)(tn.a,{children:[Object(ye.jsx)(Ve.a,{children:"ZwiftMap is a fan project created by Andi P\xe4tzold."}),Object(ye.jsxs)(Ve.a,{children:["All code is open source and available on"," ",Object(ye.jsx)("a",{href:"https://github.com/andipaetzold/zwiftmap",rel:"noreferrer noopener",target:"_blank",children:"GitHub"}),"."]}),Object(ye.jsxs)(Ve.a,{children:["Route and Segment Information is collected and combined from:"," "]}),Object(ye.jsxs)("ul",{children:[Object(ye.jsx)("li",{children:Object(ye.jsx)("a",{href:"https://strava.com",rel:"noreferrer noopener",target:"_blank",children:"Strava"})}),Object(ye.jsx)("li",{children:Object(ye.jsx)("a",{href:"https://whatsonzwift.com",rel:"noreferrer noopener",target:"_blank",children:"What's on Zwift"})}),Object(ye.jsx)("li",{children:Object(ye.jsx)("a",{href:"https://zwift.com",rel:"noreferrer noopener",target:"_blank",children:"Zwift"})}),Object(ye.jsx)("li",{children:Object(ye.jsx)("a",{href:"https://zwifthub.com",rel:"noreferrer noopener",target:"_blank",children:"ZwiftHub"})}),Object(ye.jsx)("li",{children:Object(ye.jsx)("a",{href:"https://zwiftpower.com",rel:"noreferrer noopener",target:"_blank",children:"Zwift Power"})})]}),Object(ye.jsxs)(Ve.a,{children:["World maps were created by",Object(ye.jsx)("a",{href:"https://zwift.com",rel:"noreferrer noopener",target:"_blank",children:"Zwift"}),"."]}),Object(ye.jsx)(Ve.a,{children:"ZwiftMap does not collect, analyze or store any sensitive information. The app only uses data required for the operation and monitoring."}),Object(ye.jsx)(Ve.a,{type:"headline-6",style:{margin:0},children:"Contact"}),Object(ye.jsxs)(Ve.a,{children:["Andi P\xe4tzold",Object(ye.jsx)("br",{}),Object(ye.jsx)("a",{href:"mainto:info@zwiftmap.com",rel:"noreferrer noopener",target:"_blank",children:"info@zwiftmap.com"}),Object(ye.jsx)("br",{}),"Support this project via"," ",Object(ye.jsx)("a",{href:"https://paypal.me/andipaetzold",rel:"noreferrer noopener",target:"_blank",children:"PayPal"})]})]}),Object(ye.jsx)(nn.a,{children:Object(ye.jsx)(Ue.a,{id:"dialog-close",onClick:n,children:"Close"})})]})}var on=n(469),sn=n(485);function An(e){var t=e.visible,n=e.onClose,a=$e(),r=Object(A.a)(a,2),i=r[0],c=r[1],o=function(e){e.target.checked&&c(Object(b.a)(Object(b.a)({},i),{},{sport:e.target.value}))},s=function(e){e.target.checked&&c(Object(b.a)(Object(b.a)({},i),{},{units:e.target.value}))};return Object(ye.jsxs)(_t.a,{id:"settings-dialog","aria-labelledby":"settings-dialog-title",visible:t,onRequestClose:n,children:[Object(ye.jsx)($t.a,{style:{paddingBottom:0},children:Object(ye.jsx)(en.a,{id:"settings-dialog-title",children:"Settings"})}),Object(ye.jsxs)(tn.a,{children:[Object(ye.jsxs)(on.a,{legend:"Sport",children:[Object(ye.jsx)(sn.a,{id:"settings-dialog-cycling",name:"settings-dialog-sport",label:"Cycling",value:"cycling",checked:"cycling"===i.sport,onChange:o}),Object(ye.jsx)(sn.a,{id:"settings-dialog-running",name:"settings-dialog-sport",label:"Running",value:"running",checked:"running"===i.sport,onChange:o})]}),Object(ye.jsxs)(on.a,{legend:"Units",children:[Object(ye.jsx)(sn.a,{id:"settings-dialog-metric",name:"settings-dialog-units",label:"Metric",value:"metric",checked:"metric"===i.units,onChange:s}),Object(ye.jsx)(sn.a,{id:"settings-dialog-imperial",name:"settings-dialog-units",label:"Imperial",value:"imperial",checked:"imperial"===i.units,onChange:s})]})]}),Object(ye.jsx)(nn.a,{children:Object(ye.jsx)(Ue.a,{id:"dialog-close",onClick:n,children:"Close"})})]})}function ln(e){var t=e.onBottomSheetClose,n=Object(i.useRef)(null),a=Object(i.useState)(!1),r=Object(A.a)(a,2),c=r[0],o=r[1],s=Object(Xt.a)(!1),l=Object(A.a)(s,3),u=l[0],d=l[1],j=l[2],b=Object(Xt.a)(!1),f=Object(A.a)(b,3),p=f[0],g=f[1],O=f[2],h=Object(Kt.useMediaQuery)({query:"(max-width: 750px)"}),v=B();return Object(ye.jsxs)(ye.Fragment,{children:[Object(ye.jsx)(Ne.a,{onClick:function(e){e.stopPropagation(),o(!c)},rightAddon:h?Object(ye.jsx)(Pt.a,{}):Object(ye.jsx)(Gt.a,{}),rightAddonType:"icon",id:"sidebar-menu",ref:n,children:"Menu"}),Object(ye.jsx)(Zt.a,{id:"sidebar-menu",controlId:"sidebar-menu",visible:c,onRequestClose:function(){return o(!1)},"aria-labelledby":"sidebar-menu",anchor:qt.b,portal:!0,children:Object(ye.jsxs)(Ie.a,{children:[Object(ye.jsx)(Vt.a,{onClick:function(){g(),t()},leftAddon:Object(ye.jsx)(Jt.a,{}),leftAddonType:"icon",children:"Info"}),Object(ye.jsx)(Vt.a,{onClick:function(){d(),t()},leftAddon:Object(ye.jsx)(Yt.a,{}),leftAddonType:"icon",children:"Settings"}),Object(ye.jsx)(Se.a,{}),v?Object(ye.jsx)(Vt.a,{onClick:function(){W()},children:"Logout from Strava"}):Object(ye.jsx)(Vt.a,{onClick:P,children:"Login to Strava"})]})}),Object(ye.jsx)(An,{visible:u,onClose:j}),Object(ye.jsx)(cn,{visible:p,onClose:O})]})}var un=["altitude","distance"];function dn(e){var t=e.route,n=Object(g.a)(ge,[t.slug,"routes",un]).result,a=Object(i.useMemo)((function(){if(void 0!==n){var e=ct()(n.distance.map((function(e,t){return{distance:Math.round(e/100)/10,elevation:n.altitude[t]}})),(function(e,t){return e.distance===t.distance})),t=Math.min.apply(Math,Object(R.a)(e.map((function(e){return e.elevation}))));return e.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{elevation:e.elevation-t})}))}}),[n]);return a?Object(ye.jsxs)(st.a,{height:50,width:100,data:a,baseValue:"dataMin",children:[Object(ye.jsx)("defs",{children:Object(ye.jsx)(bt,{})}),Object(ye.jsx)(lt.a,{dataKey:"distance",type:"number",domain:[0,"dataMax"],unit:"km",hide:!0}),Object(ye.jsx)(ut.a,{dataKey:"elevation",type:"number",allowDecimals:!1,domain:[0,750],unit:"m",hide:!0}),Object(ye.jsx)(jt.a,{type:"monotone",dataKey:"elevation",name:"Elevation",stroke:"black",fillOpacity:1,fill:"url(#colorElevation)",unit:"m",isAnimationActive:!1})]}):Object(ye.jsx)(mt.a,{id:"elevation-preview-".concat(t.slug),small:!0,circleStyle:{stroke:"black"}})}function jn(e){var t=e.route,n=e.onHoverRoute,a=e.showWorldName,r=E(),i=Object(A.a)(r,2),c=i[0],o=i[1];return Object(ye.jsx)(Ne.a,{secondaryText:Object(ye.jsx)(bn,{route:t,showWorldName:a}),threeLines:a,onClick:function(){o({world:S.c.find((function(e){return e.slug===t.world})),route:t,segments:[],query:c.query,type:"route"}),n(void 0)},rightAddonType:"large-media",rightAddon:Object(ye.jsx)(fn,{route:t}),onMouseEnter:function(){return n(t.slug)},onMouseLeave:function(){return n(void 0)},children:t.name})}function bn(e){var t=e.route,n=e.showWorldName;return Object(ye.jsxs)(ye.Fragment,{children:[n&&Object(ye.jsxs)(ye.Fragment,{children:[S.c.find((function(e){return e.slug===t.world})).name,Object(ye.jsx)("br",{})]}),Object(ye.jsx)(nt,{distance:t.distance})," |"," ",Object(ye.jsx)(rt,{elevation:t.elevation})]})}function fn(e){var t=e.route,n=Object(i.useRef)(null),a=function(e){var t=Object(i.useState)(!1),n=Object(A.a)(t,2),a=n[0],r=n[1];return Object(i.useEffect)((function(){var t=e.current,n=new IntersectionObserver((function(e){var t=Object(A.a)(e,1)[0];r(t.isIntersecting)}));return t&&n.observe(t),function(){t&&n.unobserve(t)}}),[]),a}(n);return Object(ye.jsx)("div",{ref:n,style:{width:"100%",pointerEvents:"none"},children:a?Object(ye.jsx)(dn,{route:t}):null})}function pn(e){var t=e.onHoverRoute,n=$e(),a=Object(A.a)(n,1)[0],r=E(),i=Object(A.a)(r,2),c=i[0],o=i[1],s=B();return Object(ye.jsxs)(ye.Fragment,{children:[s&&Object(ye.jsxs)(ye.Fragment,{children:[Object(ye.jsx)(Ne.a,{secondaryText:"Last 30 days",onClick:function(){o({world:c.world,query:"",type:"strava-activities"})},children:"Recent Strava Activities"}),Object(ye.jsx)(Se.a,{})]}),S.a.filter((function(e){return e.world===c.world.slug})).filter((function(e){return e.sports.includes(a.sport)})).filter((function(e){return void 0!==e.stravaSegmentId})).sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return Object(ye.jsx)(jn,{route:e,onHoverRoute:t,showWorldName:!1},e.slug)}))]})}var gn=n(493),On=n(22);function hn(){var e=E(),t=Object(A.a)(e,2),n=t[0],a=t[1];return Object(ye.jsx)(gn.a,{id:"search-input",style:{width:"100%"},placeholder:"Search for worlds and routes\u2026",value:n.query,onChange:function(e){a({world:n.world,type:"default",query:e.target.value})},isRightAddon:!1,rightChildren:""!==n.query&&Object(ye.jsx)(Ue.a,{buttonType:"icon",style:{right:0,position:"absolute"},onClick:function(){a(Object(b.a)(Object(b.a)({},n),{},{query:""}))},"aria-label":"Clear search field",children:Object(ye.jsx)(On.a,{children:"clear"})})})}var vn=/strava\.com\/activities\/(\d{10})/,mn=[].concat(Object(R.a)(Object(R.a)(S.c).sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return{type:"world",terms:[e.name].map((function(e){return e.toLocaleLowerCase()})),data:e}}))),Object(R.a)(Object(R.a)(S.a).sort((function(e,t){return e.name.localeCompare(t.name)})).filter((function(e){return void 0!==e.stravaSegmentId})).map((function(e){return{type:"route",terms:[S.c.find((function(t){return t.slug===e.world})).name,e.name].map((function(e){return e.toLocaleLowerCase()})),data:e}}))));var xn={world:{title:"Worlds"},route:{title:"Routes"},segment:{title:"Segments"},"strava-activity":{title:"Strava Activity"}};function wn(e){var t=e.activity,n=e.onHoverRoute;return B()?Object(ye.jsx)(yn,{activity:t,onHoverRoute:n}):Object(ye.jsx)(Ne.a,{leftAddon:Object(ye.jsx)(Re.a,{color:"#ff6b00",children:Object(ye.jsx)("img",{src:Xe,alt:""})}),leftAddonType:"avatar",rightAddon:Object(ye.jsx)(Ze.a,{}),rightAddonType:"icon",secondaryText:"\u2026to view Strava activity",onClick:P,children:"Authorize Strava App\u2026"})}function yn(e){var t=e.activity.activityId,n=(e.onHoverRoute,Object(g.a)(Ae,[t])),a=n.result,r=n.loading,i=E(),c=Object(A.a)(i,2)[1];if(!a)return r?Object(ye.jsx)(mt.a,{id:"strava-activity-".concat(t),circleStyle:{stroke:"black"}}):Object(ye.jsx)(Me.a,{secondaryText:"Make sure you can access the activity and it was recorded in Zwift.",threeLines:!0,children:"An error occurred"});return Object(ye.jsx)(Ne.a,{onClick:function(){c({world:a.world,stravaActivityId:a.id,query:"",type:"strava-activity"})},secondaryText:Object(ye.jsxs)(ye.Fragment,{children:[Object(ye.jsx)(nt,{distance:a.distance})," |"," ",Object(ye.jsx)(rt,{elevation:a.elevation}),Object(ye.jsx)("br",{}),a.avgWatts&&Object(ye.jsxs)(ye.Fragment,{children:[Math.round(a.avgWatts),"W | "]}),Object(ye.jsx)(It,{seconds:a.time})]}),threeLines:!0,rightAddonType:a.photoUrl?"large-media":void 0,rightAddon:a.photoUrl?Object(ye.jsx)("img",{src:a.photoUrl,alt:"",width:"100"}):void 0,children:a.name})}function kn(e){var t=e.world,n=E(),a=Object(A.a)(n,2)[1],r=$e(),i=Object(A.a)(r,1)[0],c="".concat(S.a.filter((function(e){return e.sports.includes(i.sport)})).filter((function(e){return e.world===t.slug})).length," routes | ").concat(S.b.filter((function(e){return e.world===t.slug})).length," segments");return Object(ye.jsx)(Ne.a,{secondaryText:c,onClick:function(){a({world:t,query:"",type:"default"})},children:t.name})}function Cn(e){var t=e.onHoverRoute,n=E(),a=Object(A.a)(n,1)[0],r=$e(),c=Object(A.a)(r,1)[0],o=function(e,t){if(vn.test(e)){var n=vn.exec(e),a=Object(A.a)(n,2)[1];return[{type:"strava-activity",data:{activityId:a,slug:"strava-activity-".concat(a)}}]}var r=e.toLocaleLowerCase().split(" ").filter((function(e){return e.length>0}));return mn.filter((function(e){return"world"===e.type||"segment"===e.type||e.data.sports.includes(t)})).filter((function(e){return r.every((function(t){return e.terms.some((function(e){return e.includes(t)}))}))}))}(a.query,c.sport);return 0===o.length?Object(ye.jsx)(Me.a,{children:"No worlds or routes found"}):Object(ye.jsx)(ye.Fragment,{children:o.map((function(e,n){var a;return Object(ye.jsxs)(i.Fragment,{children:[(null===(a=o[n-1])||void 0===a?void 0:a.type)!==e.type&&Object(ye.jsxs)(ye.Fragment,{children:[o[n-1]&&Object(ye.jsx)(Se.a,{}),Object(ye.jsx)(Le.a,{children:xn[e.type].title})]}),Object(ye.jsx)(Dn,{searchResult:e,onHoverRoute:t})]},e.data.slug)}))})}function Dn(e){var t=e.searchResult,n=e.onHoverRoute;switch(t.type){case"world":return Object(ye.jsx)(kn,{world:t.data});case"route":return Object(ye.jsx)(jn,{route:t.data,onHoverRoute:n,showWorldName:!0});case"strava-activity":return Object(ye.jsx)(wn,{activity:t.data,onHoverRoute:n});default:return null}}var Bn=(new Date).getTime()/1e3;function Sn(){var e=E(),t=Object(A.a)(e,2),n=t[0],a=t[1],r=Object(g.a)(Object(f.a)(j.a.mark((function e(){var t,n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=1,a=[];case 3:return e.next=5,oe({after:Bn-2592e3,per_page:30,page:n});case 5:a=e.sent,t.push.apply(t,Object(R.a)(a)),++n;case 8:if(30===a.length){e.next=3;break}case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e)}))),[]).result;return Object(ye.jsxs)(Ie.a,{children:[Object(ye.jsx)(Me.a,{children:Object(ye.jsx)(Ue.a,{themeType:"outline",onClick:function(){a({world:n.world,query:"",type:"default"})},children:Object(ye.jsx)(He.a,{icon:Object(ye.jsx)(We.a,{}),children:"Route List"})})}),Object(ye.jsx)(Le.a,{children:"Recent Strava Activities"}),void 0===r&&Object(ye.jsx)(Me.a,{children:Object(ye.jsx)(mt.a,{id:"strava-activities",circleStyle:{stroke:"black"}})}),void 0!==r&&Object(R.a)(r).sort((function(e,t){return-e.start_date.localeCompare(t.start_date)})).map((function(e){return{world:Q(e),activity:e}})).filter((function(e){return void 0!==e.world})).map((function(e){var t=e.world,n=e.activity;return Object(ye.jsx)(Ne.a,{onClick:function(){a({world:t,query:"",type:"strava-activity",stravaActivityId:n.id.toString()})},secondaryText:Object(ye.jsxs)(ye.Fragment,{children:[Object(ye.jsx)(nt,{distance:n.distance/1e3})," |"," ",Object(ye.jsx)(rt,{elevation:n.total_elevation_gain}),Object(ye.jsx)("br",{}),n.average_watts&&Object(ye.jsxs)(ye.Fragment,{children:[Math.round(n.average_watts),"W | "]}),Object(ye.jsx)(It,{seconds:n.moving_time})]}),threeLines:!0,children:n.name},n.id)}))]})}function In(e){var t=e.onMouseHoverDistanceChange,n=e.onHoverRoute,a=Object(i.useState)(!1),r=Object(A.a)(a,2),c=r[0],o=r[1],s=E(),l=Object(A.a)(s,2),u=l[0],d=l[1],j=Object(i.useRef)(null);return Object(ye.jsxs)(ye.Fragment,{children:[Object(ye.jsxs)("div",{className:Qe()(zt.a.Container,Object(Be.a)({},zt.a.BottomSheetOpen,c)),ref:j,children:[Object(ye.jsx)("button",{className:zt.a.DragHandle,onClick:function(){return o(!1)},children:Object(ye.jsx)(Ee.a,{})}),Object(ye.jsxs)(Ie.a,{className:zt.a.SearchBox,children:[Object(ye.jsx)(Me.a,{children:Object(ye.jsx)(hn,{})}),Object(ye.jsx)(Se.a,{className:zt.a.NoGapDivider})]}),Object(ye.jsx)("div",{className:zt.a.Content,children:"route"===u.type||"strava-activity"===u.type?Object(ye.jsx)(Nt,{onMouseHoverDistanceChange:t,backButtonText:""===u.query?"Route List":"Search Results",onBackButtonClick:function(){d({world:u.world,query:u.query,type:"default"})}}):"strava-activities"===u.type?Object(ye.jsx)(Sn,{}):Object(ye.jsx)(Ie.a,{children:""===u.query?Object(ye.jsx)(pn,{onHoverRoute:n}):Object(ye.jsx)(Cn,{onHoverRoute:n})})}),Object(ye.jsxs)(Ie.a,{className:zt.a.BottomMenu,children:[Object(ye.jsx)(Se.a,{className:zt.a.NoGapDivider}),Object(ye.jsx)(ln,{onBottomSheetClose:function(){return o(!1)}})]})]}),Object(ye.jsx)("button",{className:Qe()(zt.a.DragHandle,zt.a.DragHandleBottom,Object(Be.a)({},zt.a.BottomSheetOpen,c)),onClick:function(){return o(!0)},children:Object(ye.jsx)(Te.a,{})})]})}function Mn(){Object(i.useEffect)((function(){try{H.a.get("".concat("https://api.zwiftmap.com","/ping"))}catch(e){}}),[]),function(){var e=Object(i.useCallback)((function(){var e=new URLSearchParams(window.location.search);e.has("strava-auth")&&(N(JSON.parse(e.get("strava-auth"))),e.delete("strava-auth"),window.history.replaceState(void 0,"","".concat(window.location.origin).concat(window.location.pathname,"?").concat(e.toString())))}),[]);Object(i.useEffect)((function(){e()}),[e]),Object(i.useEffect)((function(){return window.addEventListener("popstate",e),function(){return window.removeEventListener("popstate",e)}}),[e])}();var e=Object(i.useState)(void 0),t=Object(A.a)(e,2),n=t[0],a=t[1],r=Object(i.useState)(),c=Object(A.a)(r,2),o=c[0],s=c[1];return Object(ye.jsxs)("div",{className:u.a.Wrapper,children:[Object(ye.jsx)(In,{onMouseHoverDistanceChange:a,onHoverRoute:s}),Object(ye.jsx)(De,{mouseHoverDistance:n,previewRoute:o})]})}var En;n(427);a.a({enabled:(null!==(En="https://8fd04f9fdc64444391867b0088cf64f9@o260685.ingest.sentry.io/5791747")?En:"").length>0,dsn:"https://8fd04f9fdc64444391867b0088cf64f9@o260685.ingest.sentry.io/5791747",integrations:[new r.a.BrowserTracing],tracesSampleRate:1}),s.a.render(Object(ye.jsx)(c.a.StrictMode,{children:Object(ye.jsx)(Mn,{})}),document.getElementById("app"))},48:function(e,t,n){e.exports={Container:"Sidebar_Container__3o0kK",BottomSheetOpen:"Sidebar_BottomSheetOpen__22Bgs",SearchBox:"Sidebar_SearchBox__3wlGX",Content:"Sidebar_Content__15Hau",BottomMenu:"Sidebar_BottomMenu__2Obmz",NoGapDivider:"Sidebar_NoGapDivider__20DmD",DragHandle:"Sidebar_DragHandle__l0Son",DragHandleBottom:"Sidebar_DragHandleBottom__1sHmD"}}},[[428,1,2]]]);
//# sourceMappingURL=main.68df5a1e.chunk.js.map