{"version":3,"sources":["App.module.css","ElevationChart.module.css","constants.ts","data/routes.ts","StravaSegmentRepository.ts","ElevationChart.tsx","data/segments.ts","worldConfig.ts","maps/crit-city.png","maps/france.png","maps/innsbruck.png","maps/london.png","maps/new-york.png","maps/paris.png","maps/richmond.png","maps/watopia.png","maps/yorkshire.png","RouteMap.tsx","RouteSelector.tsx","App.tsx","hooks/useHash.ts","index.tsx","RouteSelector.module.css"],"names":["module","exports","WORLDS","routes","segmentCache","getStravaSegment","segmentSlug","a","fetchStravaSegment","fetch","response","json","ElevationChart","route","onMouseHoverDistanceChange","segment","useAsync","slug","result","data","useMemo","undefined","uniqWith","distance","map","index","Math","round","elevation","altitude","b","className","styles","Container","ResponsiveContainer","width","height","AreaChart","margin","top","right","left","bottom","baseValue","id","x1","y1","x2","y2","offset","stopColor","stopOpacity","CartesianGrid","vertical","XAxis","name","dataKey","type","allowDecimals","tickCount","domain","unit","YAxis","Tooltip","content","props","TooltipContent","onMouseDistance","isAnimationActive","position","y","cursor","stroke","Area","fillOpacity","fill","useEffect","payload","length","label","style","padding","backgroundColor","border","whiteSpace","display","paddingTop","paddingBottom","color","separator","fontWeight","segments","worldConfigs","imageBounds","routeBounds","image","france","innsbruck","london","paris","richmond","watopia","yorkshire","RouteMap","routeSelection","mouseHoverDistance","world","worldConfig","bounds","LatLngBounds","stravaSegmentsInWorld","w","segmentsInWorld","filter","s","sport","stravaSegmentId","Promise","all","stravaSegments","i","stravaData","useState","setMap","zoomControl","setPosition","routeStravaSegment","r","latlng","reduce","coord","extend","invalidateSize","fitBounds","setMaxBounds","minZoom","getBoundsZoom","setMinZoom","pointCoordinates","pointIndex","findIndex","d","MapContainer","whenCreated","maxZoom","ImageOverlay","url","attribution","Pane","Polyline","positions","pathOptions","weight","Circle","center","radius","fillColor","RouteSelector","selection","onChange","handleChange","e","target","checked","find","value","filteredRoutes","sort","localeCompare","Sidebar","c","Item","selected","App","window","location","hash","setHash","listener","addEventListener","removeEventListener","slice","useHash","includes","setMouseHoverDistance","Wrapper","routeSelected","rs","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.5fb4f71e.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"Wrapper\":\"App_Wrapper__2FdRQ\",\"routeSelected\":\"App_routeSelected__V3XxY\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Container\":\"ElevationChart_Container__3f2Iq\"};","import { World } from \"./types\";\n\nexport const WORLDS: World[] = [\n  \"crit-city\",\n  \"france\",\n  \"innsbruck\",\n  \"london\",\n  \"new-york\",\n  \"paris\",\n  \"richmond\",\n  \"watopia\",\n  \"yorkshire\",\n];\n","import { Route } from \"../types\";\nimport routesJSON from \"./routes.json\";\n\nexport const routes: Route[] = routesJSON as any;\n","import { StravaSegment } from \"./types\";\n\nconst segmentCache: { [segmentSlug: string]: Promise<StravaSegment> } = {};\n\nexport async function getStravaSegment(segmentSlug: string): Promise<StravaSegment> {\n  if (!segmentCache[segmentSlug]) {\n    segmentCache[segmentSlug] = fetchStravaSegment(segmentSlug);\n  }\n\n  return await segmentCache[segmentSlug];\n}\n\nasync function fetchStravaSegment(segmentSlug: string) {\n  const response = await fetch(`segments/${segmentSlug}.json`);\n  return await response.json();\n}\n","import uniqWith from \"lodash/uniqWith\";\nimport React, { useEffect, useMemo } from \"react\";\nimport { useAsync } from \"react-async-hook\";\nimport {\n  Area,\n  AreaChart,\n  CartesianGrid,\n  ResponsiveContainer,\n  Tooltip,\n  TooltipProps,\n  XAxis,\n  YAxis,\n} from \"recharts\";\nimport styles from \"./ElevationChart.module.css\";\nimport { getStravaSegment } from \"./StravaSegmentRepository\";\nimport { Route } from \"./types\";\n\ninterface Props {\n  route: Route;\n  onMouseHoverDistanceChange: (distance: number | undefined) => void;\n}\n\nexport function ElevationChart({ route, onMouseHoverDistanceChange }: Props) {\n  const { result: segment } = useAsync(getStravaSegment, [route.slug]);\n\n  const data: any[] | undefined = useMemo(() => {\n    if (segment === undefined) {\n      return;\n    }\n\n    return uniqWith(\n      segment.distance.map((distance, index) => ({\n        distance: Math.round(distance / 10) / 100,\n        elevation: segment.altitude[index],\n      })),\n      (a, b) => a.distance === b.distance\n    );\n  }, [segment]);\n\n  if (data === undefined) {\n    return null;\n  }\n\n  return (\n    <div className={styles.Container}>\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\n        <AreaChart\n          data={data}\n          margin={{\n            top: 5,\n            right: 30,\n            left: 20,\n            bottom: 5,\n          }}\n          // @ts-ignore\n          baseValue=\"dataMin\"\n        >\n          <defs>\n            <linearGradient id=\"colorElevation\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n              <stop offset=\"5%\" stopColor=\"black\" stopOpacity={0.8} />\n              <stop offset=\"95%\" stopColor=\"black\" stopOpacity={0} />\n            </linearGradient>\n          </defs>\n          <CartesianGrid vertical={false} />\n          <XAxis\n            name=\"Distance\"\n            dataKey=\"distance\"\n            type=\"number\"\n            allowDecimals={false}\n            tickCount={10}\n            domain={[0, \"dataMax\"]}\n            unit=\"km\"\n          />\n\n          <YAxis\n            name=\"Elevation\"\n            type=\"number\"\n            allowDecimals={false}\n            tickCount={5}\n            domain={[0, \"auto\"]}\n            unit=\"m\"\n          />\n          <Tooltip\n            content={(props) => (\n              <TooltipContent\n                {...props}\n                onMouseDistance={onMouseHoverDistanceChange}\n              />\n            )}\n            isAnimationActive={false}\n            position={{ y: 10 }}\n            cursor={{ stroke: \"black\" }}\n          />\n          <Area\n            type=\"monotone\"\n            dataKey=\"elevation\"\n            name=\"Elevation\"\n            stroke=\"black\"\n            fillOpacity={1}\n            fill=\"url(#colorElevation)\"\n            unit=\"m\"\n            isAnimationActive={false}\n          />\n        </AreaChart>\n      </ResponsiveContainer>\n    </div>\n  );\n}\n\ninterface TooltipContentProps extends TooltipProps<any, any> {\n  onMouseDistance: (distance: number | undefined) => void;\n}\n\nfunction TooltipContent(props: TooltipContentProps) {\n  useEffect(() => {\n    if (props.payload === undefined || props.payload.length === 0) {\n      props.onMouseDistance(undefined);\n    } else {\n      props.onMouseDistance(props.label * 1_000);\n    }\n  }, [props]);\n\n  if (props.payload === undefined || props.payload.length === 0) {\n    return null;\n  }\n\n  return (\n    <div\n      className=\"recharts-default-tooltip\"\n      style={{\n        margin: 0,\n        padding: 10,\n        backgroundColor: \"#fff\",\n        border: \"1px solid #ccc\",\n        whiteSpace: \"nowrap\",\n      }}\n    >\n      <ul\n        className=\"recharts-tooltip-item-list\"\n        style={{ padding: 0, margin: 0 }}\n      >\n        <li\n          className=\"recharts-tooltip-item\"\n          style={{\n            display: \"block\",\n            paddingTop: 4,\n            paddingBottom: 4,\n            color: \"#000\",\n          }}\n        >\n          <span className=\"recharts-tooltip-item-name\">Distance</span>\n          <span className=\"recharts-tooltip-item-separator\">\n            {props.separator}\n          </span>\n          <span\n            className=\"recharts-tooltip-item-value\"\n            style={{ fontWeight: \"bold\" }}\n          >\n            {Math.round(props.label * 10) / 10}\n          </span>\n          <span\n            className=\"recharts-tooltip-item-unit\"\n            style={{ fontWeight: \"bold\" }}\n          >\n            km\n          </span>\n        </li>\n\n        <li\n          className=\"recharts-tooltip-item\"\n          style={{\n            display: \"block\",\n            paddingTop: 4,\n            paddingBottom: 4,\n            color: \"#000\",\n          }}\n        >\n          <span className=\"recharts-tooltip-item-name\">\n            {props.payload[0].name}\n          </span>\n          <span className=\"recharts-tooltip-item-separator\">\n            {props.separator}\n          </span>\n          <span\n            className=\"recharts-tooltip-item-value\"\n            style={{ fontWeight: \"bold\" }}\n          >\n            {Math.round(\n              props.payload[0].payload[props.payload[0].dataKey as string]\n            )}\n          </span>\n          <span\n            className=\"recharts-tooltip-item-unit\"\n            style={{ fontWeight: \"bold\" }}\n          >\n            {props.payload[0].unit}\n          </span>\n        </li>\n      </ul>\n    </div>\n  );\n}\n","import { Segment } from \"../types\";\nimport segmentsJSON from \"./segments.json\";\n\nexport const segments: Segment[] = segmentsJSON as any;\n","import { LatLngTuple } from \"leaflet\";\nimport critCityMap from \"./maps/crit-city.png\";\nimport franceMap from \"./maps/france.png\";\nimport innsbruckMap from \"./maps/innsbruck.png\";\nimport londonMap from \"./maps/london.png\";\nimport newYorkMap from \"./maps/new-york.png\";\nimport parisMap from \"./maps/paris.png\";\nimport richmondMap from \"./maps/richmond.png\";\nimport watopiaMap from \"./maps/watopia.png\";\nimport yorkshireMap from \"./maps/yorkshire.png\";\nimport { World } from \"./types\";\n\nexport type WorldConfig = {\n  imageBounds: [LatLngTuple, LatLngTuple];\n  routeBounds: [LatLngTuple, LatLngTuple];\n  image: string;\n  backgroundColor: string;\n};\n\nexport const worldConfigs: Record<World, WorldConfig> = {\n  \"crit-city\": {\n    imageBounds: [\n      [-10.3657, 165.7824],\n      [-10.4038, 165.8207],\n    ],\n    routeBounds: [\n      [53.999691, -1.560305],\n      [53.99099, -1.545435],\n    ],\n    image: critCityMap,\n    backgroundColor: \"#7c9938\",\n  },\n  france: {\n    imageBounds: [\n      [-21.64155, 166.1384],\n      [-21.7564, 166.26125],\n    ],\n    routeBounds: [\n      [-21.652087, 166.148225],\n      [-21.74491, 166.251404],\n    ],\n    image: franceMap,\n    backgroundColor: \"#6f992d\",\n  },\n  innsbruck: {\n    imageBounds: [\n      [47.2947, 11.3501],\n      [47.2055, 11.4822],\n    ],\n    routeBounds: [\n      [47.280902, 11.386414],\n      [47.214544, 11.445934],\n    ],\n    image: innsbruckMap,\n    backgroundColor: \"#7c9938\",\n  },\n  london: {\n    imageBounds: [\n      [51.5362, -0.1776],\n      [51.4601, -0.0555],\n    ],\n    routeBounds: [\n      [51.511272, -0.164224],\n      [51.474343, -0.061869],\n    ],\n    image: londonMap,\n    backgroundColor: \"#6f992d\",\n  },\n  \"new-york\": {\n    imageBounds: [\n      [40.81725, -74.0227],\n      [40.74085, -73.9222],\n    ],\n    routeBounds: [\n      [40.799618, -73.982068],\n      [40.763547, -73.949602],\n    ],\n    image: newYorkMap,\n    backgroundColor: \"#bbbbb7\",\n  },\n  paris: {\n    imageBounds: [\n      [48.9058, 2.2561],\n      [48.82945, 2.3722],\n    ],\n    routeBounds: [\n      [48.874328, 2.294207],\n      [48.860895, 2.331992],\n    ],\n    image: parisMap,\n    backgroundColor: \"#b9b9b9\",\n  },\n  richmond: {\n    imageBounds: [\n      [37.5774, -77.48954],\n      [37.5014, -77.394],\n    ],\n    routeBounds: [\n      [37.558393, -77.467668],\n      [37.520429, -77.415864],\n    ],\n    image: richmondMap,\n    backgroundColor: \"#7c9938\",\n  },\n  watopia: {\n    imageBounds: [\n      [-11.62597, 166.87747],\n      [-11.70255, 167.03255],\n    ],\n    routeBounds: [\n      [-11.634595, 166.88756],\n      [-11.693004, 167.002777],\n    ],\n    image: watopiaMap,\n    backgroundColor: \"#0884e2\",\n  },\n  yorkshire: {\n    imageBounds: [\n      [54.0254, -1.632],\n      [53.9491, -1.5022],\n    ],\n    routeBounds: [\n      [53.999691, -1.592961],\n      [53.974875, -1.539474],\n    ],\n    image: yorkshireMap,\n    backgroundColor: \"#7c9938\",\n  },\n};\n","export default __webpack_public_path__ + \"static/media/crit-city.3bab2d0f.png\";","export default __webpack_public_path__ + \"static/media/france.aded90ff.png\";","export default __webpack_public_path__ + \"static/media/innsbruck.9821ed90.png\";","export default __webpack_public_path__ + \"static/media/london.54ae112e.png\";","export default __webpack_public_path__ + \"static/media/new-york.5bf9b5e8.png\";","export default __webpack_public_path__ + \"static/media/paris.d1eaa520.png\";","export default __webpack_public_path__ + \"static/media/richmond.72df812b.png\";","export default __webpack_public_path__ + \"static/media/watopia.0901a23e.png\";","export default __webpack_public_path__ + \"static/media/yorkshire.b83235cf.png\";","import { LatLngBounds, LatLngExpression, Map } from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { useAsync } from \"react-async-hook\";\nimport {\n  Circle,\n  ImageOverlay,\n  MapContainer,\n  Pane,\n  Polyline,\n} from \"react-leaflet\";\nimport { segments } from \"./data/segments\";\nimport { RouteSelection } from \"./RouteSelector\";\nimport { getStravaSegment } from \"./StravaSegmentRepository\";\nimport { Route, World } from \"./types\";\nimport { worldConfigs } from \"./worldConfig\";\n\ninterface Props {\n  routeSelection: RouteSelection;\n  mouseHoverDistance: number | undefined;\n}\n\nexport default function RouteMap({\n  routeSelection,\n  mouseHoverDistance,\n}: Props) {\n  const world = routeSelection.world;\n  const worldConfig = worldConfigs[world];\n  const bounds = useMemo(() => new LatLngBounds(worldConfig.imageBounds), [\n    worldConfig,\n  ]);\n\n  const { result: stravaSegmentsInWorld } = useAsync(\n    async (w: World) => {\n      const segmentsInWorld = segments\n        .filter((s) => s.sport === \"cycling\")\n        .filter((s) => s.world === w)\n        .filter((s) => s.stravaSegmentId !== undefined);\n\n      const stravaSegments = await Promise.all(\n        segmentsInWorld.map((s) => getStravaSegment(s.slug))\n      );\n      return segmentsInWorld.map((s, i) => ({\n        ...s,\n        stravaData: stravaSegments[i],\n      }));\n    },\n    [world]\n  );\n\n  const [map, setMap] = useState<Map | undefined>();\n  useEffect(() => {\n    map?.zoomControl.setPosition(\"topright\");\n  }, [map]);\n\n  const { result: routeStravaSegment } = useAsync(\n    async (r?: Route) => {\n      if (r === undefined) {\n        return;\n      }\n\n      return await getStravaSegment(r.slug);\n    },\n    [routeSelection.route]\n  );\n\n  useEffect(() => {\n    if (!map || !routeStravaSegment) {\n      return;\n    }\n\n    const bounds = routeStravaSegment.latlng.reduce(\n      (bounds, coord) => bounds.extend(coord),\n      new LatLngBounds(\n        routeStravaSegment.latlng[0],\n        routeStravaSegment.latlng[0]\n      )\n    );\n\n    map.invalidateSize();\n    map.fitBounds(bounds);\n  }, [map, routeStravaSegment, worldConfig]);\n\n  useEffect(() => {\n    if (!map || !routeSelection) {\n      return;\n    }\n\n    const world = routeSelection.world;\n    const worldConfig = worldConfigs[world];\n\n    map.invalidateSize();\n    map.setMaxBounds(worldConfig.imageBounds);\n\n    const minZoom = map.getBoundsZoom(worldConfig.imageBounds, false);\n    map.setMinZoom(minZoom);\n\n    if (!routeSelection.route) {\n      map.fitBounds(worldConfig.routeBounds);\n    }\n  }, [map, routeSelection]);\n\n  const pointCoordinates = useMemo<LatLngExpression | undefined>(() => {\n    if (!routeStravaSegment || !mouseHoverDistance) {\n      return;\n    }\n\n    const pointIndex = routeStravaSegment.distance.findIndex(\n      (d) => d > mouseHoverDistance\n    );\n    if (!pointIndex) {\n      return;\n    }\n    return routeStravaSegment.latlng[pointIndex];\n  }, [routeStravaSegment, mouseHoverDistance]);\n\n  return (\n    <MapContainer\n      key={routeSelection.world}\n      whenCreated={(map) => setMap(map)}\n      bounds={bounds}\n      style={{ backgroundColor: worldConfig.backgroundColor }}\n      maxZoom={19}\n    >\n      <ImageOverlay\n        url={worldConfig.image}\n        bounds={bounds}\n        attribution='&amp;copy <a href=\"https://zwift.com\" rel=\"noreferrer noopener\">Zwift</a>'\n      />\n      <Pane name=\"route\">\n        {routeStravaSegment && (\n          <Polyline\n            positions={routeStravaSegment.latlng}\n            pathOptions={{ color: \"#fc6719\", weight: 5 }}\n          />\n        )}\n      </Pane>\n      <Pane name=\"segments\">\n        {stravaSegmentsInWorld?.map((s) => (\n          <Polyline\n            key={s.slug}\n            positions={s.stravaData.latlng}\n            pathOptions={{ color: \"green\", weight: 5 }}\n          />\n        ))}\n      </Pane>\n      <Pane name=\"mouse-position\">\n        {pointCoordinates && (\n          <Circle\n            center={pointCoordinates}\n            radius={10}\n            pathOptions={{\n              color: \"black\",\n              fillColor: \"black\",\n              fillOpacity: 1,\n            }}\n          />\n        )}\n      </Pane>\n    </MapContainer>\n  );\n}\n","import c from \"classnames\";\nimport { ChangeEvent } from \"react\";\nimport { routes } from \"./data/routes\";\nimport styles from \"./RouteSelector.module.css\";\nimport { Route, World } from \"./types\";\n\nexport interface RouteSelection {\n  world: World;\n  route?: Route;\n}\n\ninterface Props {\n  selection: RouteSelection;\n  onChange: (route: RouteSelection) => void;\n}\nexport default function RouteSelector({ selection, onChange }: Props) {\n  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n    if (e.target.checked) {\n      const route = routes.find((r) => r.slug === e.target.value)!;\n      onChange({ world: route.world, route });\n    }\n  };\n\n  const filteredRoutes = routes\n    .filter((route) => route.world === selection.world)\n    .filter((route) => route.sport === \"cycling\")\n    .filter((route) => route.stravaSegmentId !== undefined)\n    .sort((a, b) => a.name.localeCompare(b.name));\n\n  return (\n    <div className={styles.Container}>\n      <div className={styles.Sidebar}>\n        <select\n          value={selection.world}\n          onChange={(e) => onChange({ world: e.target.value as World })}\n        >\n          <option value=\"crit-city\">Crit City</option>\n          <option value=\"france\">France</option>\n          <option value=\"innsbruck\">Innsbruck</option>\n          <option value=\"london\">London</option>\n          <option value=\"new-york\">New York</option>\n          <option value=\"paris\">Paris</option>\n          <option value=\"richmond\">Richmond</option>\n          <option value=\"watopia\">Watopia</option>\n          <option value=\"yorkshire\">Yorkshire</option>\n        </select>\n\n        {filteredRoutes.map((route) => (\n          <label\n            key={route.slug}\n            className={c(styles.Item, {\n              [styles.selected]: selection.route?.slug === route.slug,\n            })}\n          >\n            <input\n              type=\"radio\"\n              name=\"routes\"\n              value={route.slug}\n              checked={selection.route?.slug === route.slug}\n              onChange={handleChange}\n            />\n            {route.name}\n          </label>\n        ))}\n      </div>\n    </div>\n  );\n}\n","import c from \"classnames\";\nimport React, { useMemo, useState } from \"react\";\nimport styles from \"./App.module.css\";\nimport { WORLDS } from \"./constants\";\nimport { routes } from \"./data/routes\";\nimport { ElevationChart } from \"./ElevationChart\";\nimport { useHash } from \"./hooks/useHash\";\nimport RouteMap from \"./RouteMap\";\nimport RouteSelector, { RouteSelection } from \"./RouteSelector\";\nimport { World } from \"./types\";\n\nexport default function App() {\n  const [hash, setHash] = useHash();\n  const routeSelection = useMemo<RouteSelection>(() => {\n    if (WORLDS.includes(hash as any)) {\n      return { world: hash as World };\n    } else if (routes.find((r) => r.slug === hash)) {\n      const route = routes.find((r) => r.slug === hash)!;\n      return {\n        world: route.world,\n        route,\n      };\n    }\n\n    return { world: \"watopia\" as World };\n  }, [hash]);\n\n  const handleRouteSelectionChange = (rs: RouteSelection) => {\n    if (rs.route) {\n      setHash(rs.route.slug);\n    } else {\n      setHash(rs.world);\n    }\n  };\n\n  const [mouseHoverDistance, setMouseHoverDistance] = useState<\n    number | undefined\n  >(undefined);\n\n  return (\n    <div\n      className={c(styles.Wrapper, {\n        [styles.routeSelected]: routeSelection.route !== undefined,\n      })}\n    >\n      <RouteSelector\n        selection={routeSelection}\n        onChange={handleRouteSelectionChange}\n      />\n      <RouteMap\n        routeSelection={routeSelection}\n        mouseHoverDistance={mouseHoverDistance}\n      />\n      {routeSelection.route && (\n        <ElevationChart\n          route={routeSelection.route}\n          onMouseHoverDistanceChange={setMouseHoverDistance}\n        />\n      )}\n    </div>\n  );\n}\n","import { useEffect, useState } from \"react\";\n\nexport function useHash(): [string, (hash: string) => void] {\n  const [hash, setHash] = useState(window.location.hash);\n\n  useEffect(() => {\n    const listener = () => {\n      setHash(window.location.hash);\n    };\n\n    window.addEventListener(\"popstate\", listener);\n    return () => window.removeEventListener(\"popstate\", listener);\n  }, []);\n\n  const updateHash = (hash: string) => {\n    window.location.hash = `#${hash}`;\n  };\n\n  return [hash.slice(1), updateHash];\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"app\")\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Container\":\"RouteSelector_Container__2aeQm\",\"Sidebar\":\"RouteSelector_Sidebar__25tGa\",\"Item\":\"RouteSelector_Item__402nz\",\"selected\":\"RouteSelector_selected__2JMs6\"};"],"sourceRoot":""}