{"version":3,"sources":["App.module.css","ElevationChart.module.css","data/index.ts","StravaSegmentRepository.ts","ElevationChart.tsx","worldConfig.ts","maps/crit-city.png","maps/france.png","maps/innsbruck.png","maps/london.png","maps/new-york.png","maps/paris.png","maps/richmond.png","maps/watopia.png","maps/yorkshire.png","RouteMap.tsx","RouteSelector.tsx","App.tsx","hooks/useHash.ts","index.tsx","RouteSelector.module.css"],"names":["module","exports","routes","routesJSON","segments","segmentsJSON","worlds","worldsJSON","segmentCache","getStravaSegment","segmentSlug","a","fetchStravaSegment","fetch","response","json","ElevationChart","route","onMouseHoverDistanceChange","segment","useAsync","slug","result","data","useMemo","undefined","uniqWith","distance","map","index","Math","round","elevation","altitude","b","className","styles","Container","ResponsiveContainer","width","height","AreaChart","margin","top","right","left","bottom","baseValue","id","x1","y1","x2","y2","offset","stopColor","stopOpacity","CartesianGrid","vertical","XAxis","name","dataKey","type","allowDecimals","tickCount","domain","unit","YAxis","Tooltip","content","props","TooltipContent","onMouseDistance","isAnimationActive","position","y","cursor","stroke","Area","fillOpacity","fill","useEffect","payload","length","label","style","padding","backgroundColor","border","whiteSpace","display","paddingTop","paddingBottom","color","separator","fontWeight","worldConfigs","imageBounds","routeBounds","image","france","innsbruck","london","paris","richmond","watopia","yorkshire","RouteMap","routeSelection","mouseHoverDistance","world","worldConfig","stravaSegmentsInWorld","w","segmentsInWorld","filter","s","sport","stravaSegmentId","Promise","all","stravaSegments","i","stravaData","useState","setMap","zoomControl","setPosition","routeStravaSegment","r","bounds","latlng","reduce","coord","extend","LatLngBounds","invalidateSize","fitBounds","setMaxBounds","minZoom","getBoundsZoom","setMinZoom","pointCoordinates","pointIndex","findIndex","d","MapContainer","whenCreated","maxZoom","ScaleControl","ImageOverlay","url","attribution","Pane","Polyline","positions","pathOptions","weight","LayersControl","Overlay","checked","LayerGroup","Circle","center","radius","fillColor","RouteSelector","selection","onChange","handleChange","e","target","find","value","filteredRoutes","sort","localeCompare","Sidebar","c","Item","selected","App","window","location","hash","setHash","listener","addEventListener","removeEventListener","slice","useHash","includes","setMouseHoverDistance","Wrapper","routeSelected","rs","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.1189ded6.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"Wrapper\":\"App_Wrapper__2FdRQ\",\"routeSelected\":\"App_routeSelected__V3XxY\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Container\":\"ElevationChart_Container__3f2Iq\"};","import { Route, Segment, World } from \"../types\";\nimport routesJSON from \"./routes.json\";\nimport segmentsJSON from \"./segments.json\";\nimport worldsJSON from \"./worlds.json\";\n\nexport const routes: Route[] = routesJSON as any;\nexport const segments: Segment[] = segmentsJSON as any;\nexport const worlds: World[] = worldsJSON as any;\n\n","import { StravaSegment } from \"./types\";\n\nconst segmentCache: { [segmentSlug: string]: Promise<StravaSegment> } = {};\n\nexport async function getStravaSegment(segmentSlug: string): Promise<StravaSegment> {\n  if (!segmentCache[segmentSlug]) {\n    segmentCache[segmentSlug] = fetchStravaSegment(segmentSlug);\n  }\n\n  return await segmentCache[segmentSlug];\n}\n\nasync function fetchStravaSegment(segmentSlug: string) {\n  const response = await fetch(`segments/${segmentSlug}.json`);\n  return await response.json();\n}\n","import uniqWith from \"lodash/uniqWith\";\nimport React, { useEffect, useMemo } from \"react\";\nimport { useAsync } from \"react-async-hook\";\nimport {\n  Area,\n  AreaChart,\n  CartesianGrid,\n  ResponsiveContainer,\n  Tooltip,\n  TooltipProps,\n  XAxis,\n  YAxis,\n} from \"recharts\";\nimport styles from \"./ElevationChart.module.css\";\nimport { getStravaSegment } from \"./StravaSegmentRepository\";\nimport { Route } from \"./types\";\n\ninterface Props {\n  route: Route;\n  onMouseHoverDistanceChange: (distance: number | undefined) => void;\n}\n\nexport function ElevationChart({ route, onMouseHoverDistanceChange }: Props) {\n  const { result: segment } = useAsync(getStravaSegment, [route.slug]);\n\n  const data: any[] | undefined = useMemo(() => {\n    if (segment === undefined) {\n      return;\n    }\n\n    return uniqWith(\n      segment.distance.map((distance, index) => ({\n        distance: Math.round(distance / 10) / 100,\n        elevation: segment.altitude[index],\n      })),\n      (a, b) => a.distance === b.distance\n    );\n  }, [segment]);\n\n  if (data === undefined) {\n    return null;\n  }\n\n  return (\n    <div className={styles.Container}>\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\n        <AreaChart\n          data={data}\n          margin={{\n            top: 5,\n            right: 30,\n            left: 20,\n            bottom: 5,\n          }}\n          // @ts-ignore\n          baseValue=\"dataMin\"\n        >\n          <defs>\n            <linearGradient id=\"colorElevation\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n              <stop offset=\"5%\" stopColor=\"black\" stopOpacity={0.8} />\n              <stop offset=\"95%\" stopColor=\"black\" stopOpacity={0} />\n            </linearGradient>\n          </defs>\n          <CartesianGrid vertical={false} />\n          <XAxis\n            name=\"Distance\"\n            dataKey=\"distance\"\n            type=\"number\"\n            allowDecimals={false}\n            tickCount={10}\n            domain={[0, \"dataMax\"]}\n            unit=\"km\"\n          />\n\n          <YAxis\n            name=\"Elevation\"\n            type=\"number\"\n            allowDecimals={false}\n            tickCount={5}\n            domain={[0, \"auto\"]}\n            unit=\"m\"\n          />\n          <Tooltip\n            content={(props) => (\n              <TooltipContent\n                {...props}\n                onMouseDistance={onMouseHoverDistanceChange}\n              />\n            )}\n            isAnimationActive={false}\n            position={{ y: 10 }}\n            cursor={{ stroke: \"black\" }}\n          />\n          <Area\n            type=\"monotone\"\n            dataKey=\"elevation\"\n            name=\"Elevation\"\n            stroke=\"black\"\n            fillOpacity={1}\n            fill=\"url(#colorElevation)\"\n            unit=\"m\"\n            isAnimationActive={false}\n          />\n        </AreaChart>\n      </ResponsiveContainer>\n    </div>\n  );\n}\n\ninterface TooltipContentProps extends TooltipProps<any, any> {\n  onMouseDistance: (distance: number | undefined) => void;\n}\n\nfunction TooltipContent(props: TooltipContentProps) {\n  useEffect(() => {\n    if (props.payload === undefined || props.payload.length === 0) {\n      props.onMouseDistance(undefined);\n    } else {\n      props.onMouseDistance(props.label * 1_000);\n    }\n  }, [props]);\n\n  if (props.payload === undefined || props.payload.length === 0) {\n    return null;\n  }\n\n  return (\n    <div\n      className=\"recharts-default-tooltip\"\n      style={{\n        margin: 0,\n        padding: 10,\n        backgroundColor: \"#fff\",\n        border: \"1px solid #ccc\",\n        whiteSpace: \"nowrap\",\n      }}\n    >\n      <ul\n        className=\"recharts-tooltip-item-list\"\n        style={{ padding: 0, margin: 0 }}\n      >\n        <li\n          className=\"recharts-tooltip-item\"\n          style={{\n            display: \"block\",\n            paddingTop: 4,\n            paddingBottom: 4,\n            color: \"#000\",\n          }}\n        >\n          <span className=\"recharts-tooltip-item-name\">Distance</span>\n          <span className=\"recharts-tooltip-item-separator\">\n            {props.separator}\n          </span>\n          <span\n            className=\"recharts-tooltip-item-value\"\n            style={{ fontWeight: \"bold\" }}\n          >\n            {Math.round(props.label * 10) / 10}\n          </span>\n          <span\n            className=\"recharts-tooltip-item-unit\"\n            style={{ fontWeight: \"bold\" }}\n          >\n            km\n          </span>\n        </li>\n\n        <li\n          className=\"recharts-tooltip-item\"\n          style={{\n            display: \"block\",\n            paddingTop: 4,\n            paddingBottom: 4,\n            color: \"#000\",\n          }}\n        >\n          <span className=\"recharts-tooltip-item-name\">\n            {props.payload[0].name}\n          </span>\n          <span className=\"recharts-tooltip-item-separator\">\n            {props.separator}\n          </span>\n          <span\n            className=\"recharts-tooltip-item-value\"\n            style={{ fontWeight: \"bold\" }}\n          >\n            {Math.round(\n              props.payload[0].payload[props.payload[0].dataKey as string]\n            )}\n          </span>\n          <span\n            className=\"recharts-tooltip-item-unit\"\n            style={{ fontWeight: \"bold\" }}\n          >\n            {props.payload[0].unit}\n          </span>\n        </li>\n      </ul>\n    </div>\n  );\n}\n","import { LatLngTuple } from \"leaflet\";\nimport critCityMap from \"./maps/crit-city.png\";\nimport franceMap from \"./maps/france.png\";\nimport innsbruckMap from \"./maps/innsbruck.png\";\nimport londonMap from \"./maps/london.png\";\nimport newYorkMap from \"./maps/new-york.png\";\nimport parisMap from \"./maps/paris.png\";\nimport richmondMap from \"./maps/richmond.png\";\nimport watopiaMap from \"./maps/watopia.png\";\nimport yorkshireMap from \"./maps/yorkshire.png\";\nimport { WorldSlug } from \"./types\";\n\nexport type WorldConfig = {\n  imageBounds: [LatLngTuple, LatLngTuple];\n  routeBounds: [LatLngTuple, LatLngTuple];\n  image: string;\n  backgroundColor: string;\n};\n\nexport const worldConfigs: Record<WorldSlug, WorldConfig> = {\n  \"crit-city\": {\n    imageBounds: [\n      [-10.3657, 165.7824],\n      [-10.4038, 165.8207],\n    ],\n    routeBounds: [\n      [53.999691, -1.560305],\n      [53.99099, -1.545435],\n    ],\n    image: critCityMap,\n    backgroundColor: \"#7c9938\",\n  },\n  france: {\n    imageBounds: [\n      [-21.64155, 166.1384],\n      [-21.7564, 166.26125],\n    ],\n    routeBounds: [\n      [-21.652087, 166.148225],\n      [-21.74491, 166.251404],\n    ],\n    image: franceMap,\n    backgroundColor: \"#6f992d\",\n  },\n  innsbruck: {\n    imageBounds: [\n      [47.2947, 11.3501],\n      [47.2055, 11.4822],\n    ],\n    routeBounds: [\n      [47.280902, 11.386414],\n      [47.214544, 11.445934],\n    ],\n    image: innsbruckMap,\n    backgroundColor: \"#7c9938\",\n  },\n  london: {\n    imageBounds: [\n      [51.5362, -0.1776],\n      [51.4601, -0.0555],\n    ],\n    routeBounds: [\n      [51.511272, -0.164224],\n      [51.474343, -0.061869],\n    ],\n    image: londonMap,\n    backgroundColor: \"#6f992d\",\n  },\n  \"new-york\": {\n    imageBounds: [\n      [40.81725, -74.0227],\n      [40.74085, -73.9222],\n    ],\n    routeBounds: [\n      [40.799618, -73.982068],\n      [40.763547, -73.949602],\n    ],\n    image: newYorkMap,\n    backgroundColor: \"#bbbbb7\",\n  },\n  paris: {\n    imageBounds: [\n      [48.9058, 2.2561],\n      [48.82945, 2.3722],\n    ],\n    routeBounds: [\n      [48.874328, 2.294207],\n      [48.860895, 2.331992],\n    ],\n    image: parisMap,\n    backgroundColor: \"#b9b9b9\",\n  },\n  richmond: {\n    imageBounds: [\n      [37.5774, -77.48954],\n      [37.5014, -77.394],\n    ],\n    routeBounds: [\n      [37.558393, -77.467668],\n      [37.520429, -77.415864],\n    ],\n    image: richmondMap,\n    backgroundColor: \"#7c9938\",\n  },\n  watopia: {\n    imageBounds: [\n      [-11.62597, 166.87747],\n      [-11.70255, 167.03255],\n    ],\n    routeBounds: [\n      [-11.634595, 166.88756],\n      [-11.693004, 167.002777],\n    ],\n    image: watopiaMap,\n    backgroundColor: \"#0884e2\",\n  },\n  yorkshire: {\n    imageBounds: [\n      [54.0254, -1.632],\n      [53.9491, -1.5022],\n    ],\n    routeBounds: [\n      [53.999691, -1.592961],\n      [53.974875, -1.539474],\n    ],\n    image: yorkshireMap,\n    backgroundColor: \"#7c9938\",\n  },\n};\n","export default __webpack_public_path__ + \"static/media/crit-city.3bab2d0f.png\";","export default __webpack_public_path__ + \"static/media/france.aded90ff.png\";","export default __webpack_public_path__ + \"static/media/innsbruck.9821ed90.png\";","export default __webpack_public_path__ + \"static/media/london.54ae112e.png\";","export default __webpack_public_path__ + \"static/media/new-york.5bf9b5e8.png\";","export default __webpack_public_path__ + \"static/media/paris.d1eaa520.png\";","export default __webpack_public_path__ + \"static/media/richmond.72df812b.png\";","export default __webpack_public_path__ + \"static/media/watopia.0901a23e.png\";","export default __webpack_public_path__ + \"static/media/yorkshire.b83235cf.png\";","import { LatLngBounds, LatLngExpression, Map } from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { useAsync } from \"react-async-hook\";\nimport {\n  Circle,\n  ImageOverlay,\n  LayerGroup,\n  LayersControl,\n  MapContainer,\n  Pane,\n  Polyline,\n  ScaleControl,\n} from \"react-leaflet\";\nimport { segments } from \"./data\";\nimport { RouteSelection } from \"./RouteSelector\";\nimport { getStravaSegment } from \"./StravaSegmentRepository\";\nimport { Route, WorldSlug } from \"./types\";\nimport { worldConfigs } from \"./worldConfig\";\n\ninterface Props {\n  routeSelection: RouteSelection;\n  mouseHoverDistance: number | undefined;\n}\n\nexport default function RouteMap({\n  routeSelection,\n  mouseHoverDistance,\n}: Props) {\n  const world = routeSelection.world;\n  const worldConfig = worldConfigs[world];\n\n  const { result: stravaSegmentsInWorld } = useAsync(\n    async (w: WorldSlug) => {\n      const segmentsInWorld = segments\n        .filter((s) => s.sport === \"cycling\")\n        .filter((s) => s.world === w)\n        .filter((s) => s.stravaSegmentId !== undefined);\n\n      const stravaSegments = await Promise.all(\n        segmentsInWorld.map((s) => getStravaSegment(s.slug))\n      );\n      return segmentsInWorld.map((s, i) => ({\n        ...s,\n        stravaData: stravaSegments[i],\n      }));\n    },\n    [world]\n  );\n\n  const [map, setMap] = useState<Map | undefined>();\n  useEffect(() => {\n    map?.zoomControl.setPosition(\"topright\");\n  }, [map]);\n\n  const { result: routeStravaSegment } = useAsync(\n    async (r?: Route) => {\n      if (r === undefined) {\n        return;\n      }\n\n      return await getStravaSegment(r.slug);\n    },\n    [routeSelection.route]\n  );\n\n  useEffect(() => {\n    if (!map || !routeStravaSegment) {\n      return;\n    }\n\n    const bounds = routeStravaSegment.latlng.reduce(\n      (bounds, coord) => bounds.extend(coord),\n      new LatLngBounds(\n        routeStravaSegment.latlng[0],\n        routeStravaSegment.latlng[0]\n      )\n    );\n\n    map.invalidateSize();\n    map.fitBounds(bounds);\n  }, [map, routeStravaSegment, worldConfig]);\n\n  useEffect(() => {\n    if (!map || !routeSelection) {\n      return;\n    }\n\n    const world = routeSelection.world;\n    const worldConfig = worldConfigs[world];\n\n    map.invalidateSize();\n    map.setMaxBounds(worldConfig.imageBounds);\n\n    const minZoom = map.getBoundsZoom(worldConfig.imageBounds, false);\n    map.setMinZoom(minZoom);\n\n    if (!routeSelection.route) {\n      map.fitBounds(worldConfig.routeBounds);\n    }\n  }, [map, routeSelection]);\n\n  const pointCoordinates = useMemo<LatLngExpression | undefined>(() => {\n    if (!routeStravaSegment || !mouseHoverDistance) {\n      return;\n    }\n\n    const pointIndex = routeStravaSegment.distance.findIndex(\n      (d) => d > mouseHoverDistance\n    );\n    if (!pointIndex) {\n      return;\n    }\n    return routeStravaSegment.latlng[pointIndex];\n  }, [routeStravaSegment, mouseHoverDistance]);\n\n  return (\n    <MapContainer\n      key={routeSelection.world}\n      whenCreated={(map) => setMap(map)}\n      bounds={worldConfig.imageBounds}\n      style={{ backgroundColor: worldConfig.backgroundColor }}\n      maxZoom={19}\n    >\n      <ScaleControl position=\"bottomright\" />\n      <ImageOverlay\n        url={worldConfig.image}\n        bounds={worldConfig.imageBounds}\n        attribution='&amp;copy <a href=\"https://zwift.com\" rel=\"noreferrer noopener\">Zwift</a>'\n      />\n\n      <Pane name=\"route\">\n        {routeStravaSegment && (\n          <Polyline\n            positions={routeStravaSegment.latlng}\n            pathOptions={{ color: \"#fc6719\", weight: 5 }}\n          />\n        )}\n      </Pane>\n\n      <LayersControl>\n        <LayersControl.Overlay name=\"Show segments\" checked>\n          <LayerGroup>\n            <Pane name=\"segments\">\n              {stravaSegmentsInWorld?.map((s) => (\n                <Polyline\n                  key={s.slug}\n                  positions={s.stravaData.latlng}\n                  pathOptions={{ color: \"green\", weight: 5 }}\n                />\n              ))}\n            </Pane>\n          </LayerGroup>\n        </LayersControl.Overlay>\n      </LayersControl>\n\n      <Pane name=\"mouse-position\">\n        {pointCoordinates && (\n          <Circle\n            center={pointCoordinates}\n            radius={10}\n            pathOptions={{\n              color: \"black\",\n              fillColor: \"black\",\n              fillOpacity: 1,\n            }}\n          />\n        )}\n      </Pane>\n    </MapContainer>\n  );\n}\n","import c from \"classnames\";\nimport { ChangeEvent } from \"react\";\nimport { routes, worlds } from \"./data\";\nimport styles from \"./RouteSelector.module.css\";\nimport { Route, WorldSlug } from \"./types\";\n\nexport interface RouteSelection {\n  world: WorldSlug;\n  route?: Route;\n}\n\ninterface Props {\n  selection: RouteSelection;\n  onChange: (route: RouteSelection) => void;\n}\nexport default function RouteSelector({ selection, onChange }: Props) {\n  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n    if (e.target.checked) {\n      const route = routes.find((r) => r.slug === e.target.value)!;\n      onChange({ world: route.world, route });\n    }\n  };\n\n  const filteredRoutes = routes\n    .filter((route) => route.world === selection.world)\n    .filter((route) => route.sport === \"cycling\")\n    .filter((route) => route.stravaSegmentId !== undefined)\n    .sort((a, b) => a.name.localeCompare(b.name));\n\n  return (\n    <div className={styles.Container}>\n      <div className={styles.Sidebar}>\n        <select\n          value={selection.world}\n          onChange={(e) => onChange({ world: e.target.value as WorldSlug })}\n        >\n          {worlds.map((world) => (\n            <option key={world.slug} value={world.slug}>{world.name}</option>\n          ))}\n        </select>\n\n        {filteredRoutes.map((route) => (\n          <label\n            key={route.slug}\n            className={c(styles.Item, {\n              [styles.selected]: selection.route?.slug === route.slug,\n            })}\n          >\n            <input\n              type=\"radio\"\n              name=\"routes\"\n              value={route.slug}\n              checked={selection.route?.slug === route.slug}\n              onChange={handleChange}\n            />\n            {route.name}\n          </label>\n        ))}\n      </div>\n    </div>\n  );\n}\n","import c from \"classnames\";\nimport React, { useMemo, useState } from \"react\";\nimport styles from \"./App.module.css\";\nimport { routes, worlds } from \"./data\";\nimport { ElevationChart } from \"./ElevationChart\";\nimport { useHash } from \"./hooks/useHash\";\nimport RouteMap from \"./RouteMap\";\nimport RouteSelector, { RouteSelection } from \"./RouteSelector\";\nimport { WorldSlug } from \"./types\";\n\nexport default function App() {\n  const [hash, setHash] = useHash();\n  const routeSelection = useMemo<RouteSelection>(() => {\n    if (worlds.map((world) => world.slug).includes(hash as any)) {\n      return { world: hash as WorldSlug };\n    } else if (routes.find((r) => r.slug === hash)) {\n      const route = routes.find((r) => r.slug === hash)!;\n      return {\n        world: route.world,\n        route,\n      };\n    }\n\n    return { world: \"watopia\" as WorldSlug };\n  }, [hash]);\n\n  const handleRouteSelectionChange = (rs: RouteSelection) => {\n    if (rs.route) {\n      setHash(rs.route.slug);\n    } else {\n      setHash(rs.world);\n    }\n  };\n\n  const [mouseHoverDistance, setMouseHoverDistance] = useState<\n    number | undefined\n  >(undefined);\n\n  return (\n    <div\n      className={c(styles.Wrapper, {\n        [styles.routeSelected]: routeSelection.route !== undefined,\n      })}\n    >\n      <RouteSelector\n        selection={routeSelection}\n        onChange={handleRouteSelectionChange}\n      />\n      <RouteMap\n        routeSelection={routeSelection}\n        mouseHoverDistance={mouseHoverDistance}\n      />\n      {routeSelection.route && (\n        <ElevationChart\n          route={routeSelection.route}\n          onMouseHoverDistanceChange={setMouseHoverDistance}\n        />\n      )}\n    </div>\n  );\n}\n","import { useEffect, useState } from \"react\";\n\nexport function useHash(): [string, (hash: string) => void] {\n  const [hash, setHash] = useState(window.location.hash);\n\n  useEffect(() => {\n    const listener = () => {\n      setHash(window.location.hash);\n    };\n\n    window.addEventListener(\"popstate\", listener);\n    return () => window.removeEventListener(\"popstate\", listener);\n  }, []);\n\n  const updateHash = (hash: string) => {\n    window.location.hash = `#${hash}`;\n  };\n\n  return [hash.slice(1), updateHash];\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"app\")\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Container\":\"RouteSelector_Container__2aeQm\",\"Sidebar\":\"RouteSelector_Sidebar__25tGa\",\"Item\":\"RouteSelector_Item__402nz\",\"selected\":\"RouteSelector_selected__2JMs6\"};"],"sourceRoot":""}