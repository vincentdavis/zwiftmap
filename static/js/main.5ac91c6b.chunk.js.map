{"version":3,"sources":["components/RouteMap/index.module.css","App.module.scss","components/RouteMap/WorldSelect.module.scss","data/index.ts","hooks/useLocationState.ts","hooks/useSettings.ts","services/search.ts","components/SettingsDialog/index.tsx","assets/strava-40x40.png","components/Distance/index.tsx","components/Elevation/index.tsx","services/StravaSegmentRepository.ts","components/ElevationGradient/index.tsx","components/Sidebar/ElevationChart.tsx","services/fetchEvents.ts","components/Sidebar/Details/RouteDetails/RouteEvents.tsx","components/Sidebar/Details/RouteDetails/RouteSegments.tsx","components/Sidebar/Details/RouteDetails/index.tsx","assets/ZwiftInsider-40x40.jpg","assets/WhatsOnZwift-40x40.png","hooks/useLocalStorage.ts","hooks/useStravaToken.ts","services/strava.ts","maps/bologna.png","worldConfig.ts","maps/crit-city.png","maps/france.png","maps/innsbruck.png","maps/london.png","maps/makuri-islands.png","maps/new-york.png","maps/paris.png","maps/richmond.png","maps/watopia.png","maps/yorkshire.png","services/strava-api/index.ts","services/StravaActivityRepository.ts","components/Time/index.tsx","components/Sidebar/Details/StravaActivityDetails/index.tsx","components/Sidebar/Details/WorldDetails.tsx","components/Sidebar/Details/index.tsx","components/ElevationChartPreview/index.tsx","components/Sidebar/SearchResultCardRoute.tsx","hooks/useOnScreen.ts","components/Sidebar/SearchResultCardStravaActivity.tsx","components/Sidebar/SearchResultCardWorld.tsx","components/Sidebar/SearchResultList.tsx","components/Sidebar/index.tsx","components/RouteMap/WorldSelect.tsx","components/RouteMap/index.tsx","App.tsx","hooks/useStravaTokenListener.ts","index.tsx","components/Sidebar/index.module.scss"],"names":["module","exports","routes","routesJSON","segments","segmentsJSON","worlds","worldsJSON","DEFAULT_WORLD","find","w","slug","listeners","useLocationState","useState","getLocationState","state","setState","useEffect","listener","window","addEventListener","removeEventListener","newState","push","splice","indexOf","useCallback","searchParams","URLSearchParams","set","world","route","stravaActivityId","length","map","s","join","query","history","pushState","undefined","toString","forEach","l","location","search","get","filter","r","selectedSegments","split","segment","LOCAL_STORAGE_KEY","loadSettings","rawSettings","localStorage","getItem","settings","JSON","parse","sport","units","useSettings","setSettings","newSettings","setItem","stringify","saveSettings","REGEX_STRAVA_ACTIVITY","searchResults","sort","a","b","name","localeCompare","type","terms","t","toLocaleLowerCase","data","stravaSegmentId","searchResultTypes","title","SettingsDialog","visible","onClose","handleSportChange","e","target","checked","value","handleUnitsChange","Dialog","id","aria-labelledby","onRequestClose","DialogHeader","DialogTitle","DialogContent","Fieldset","legend","Radio","label","onChange","DialogFooter","Button","onClick","formatDigits","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","style","formatNoDigits","Distance","distance","format","Elevation","elevation","cache","getStravaSegmentStream","segmentSlug","stream","cacheKey","fetchStravaSegmentStream","getStravaSegmentStreams","streams","Promise","all","streamData","Object","fromEntries","i","fetch","response","json","ElevationGradient","x1","y1","x2","y2","offset","stopColor","stopOpacity","REQUIRED_STREAMS","ElevationChart","onMouseHoverDistanceChange","useAsync","result","useMemo","uniqWith","index","Math","round","altitude","width","height","ResponsiveContainer","AreaChart","margin","top","right","left","bottom","baseValue","CartesianGrid","vertical","XAxis","dataKey","allowDecimals","tick","unit","domain","hide","YAxis","tickCount","Tooltip","content","props","TooltipContent","onMouseDistance","isAnimationActive","position","y","cursor","stroke","Area","fillOpacity","fill","payload","CullingType","Description","fetchEvents","then","RouteEvents","events","filteredEvents","event","routeId","eventSubgroups","esg","includes","eventStart","SimpleListItem","CircularProgress","small","circleStyle","Text","slice","ListItem","open","rightAddon","EventFontIcon","rightAddonType","secondaryText","DateTimeFormat","hour","minute","weekday","Date","eventTypes","eventType","distanceInMeters","durationInSeconds","laps","threeLines","GROUP_RIDE","GROUP_WORKOUT","RACE","TIME_TRIAL","RouteSegments","locationState","setLocationState","segmentsOnRoute","disabled","VisibilityFontIcon","VisibilityOffFontIcon","SecondaryText","segmentTypes","avgIncline","climb","sprint","RouteDetails","backButtonText","onBackButtonClick","List","themeType","TextIconSpacing","icon","ListFontIcon","clickable","leftAddon","SpaceBarFontIcon","leftAddonType","leadInDistance","LandscapeFontIcon","leadInElevation","experience","StarFontIcon","eventOnly","MapFontIcon","ListSubheader","zwiftInsiderUrl","Avatar","color","src","alt","OpenInNewFontIcon","stravaSegmentUrl","stravaLogo","whatsOnZwiftUrl","useStravaToken","key","getValue","setValueInternal","findIndex","setValue","removeItem","eventListener","useLocalStorage","getStravaAuthUrl","params","worldConfigs","bologna","imageBounds","initialBounds","image","backgroundColor","france","innsbruck","london","paris","richmond","watopia","yorkshire","request","url","token","headers","Authorization","fetchActivity","activityId","fetchActivityStreams","activityCache","getStravaActivity","fetchStravaActivity","esa","bb","start_latlng","Error","athlete","total_elevation_gain","moving_time","average_watts","photos","primary","urls","fetchStravaActivityStreams","athleteId","time","avgWatts","photoUrl","cadence","heartrate","latlng","velocity","velocity_smooth","watts","Time","secondsInput","seconds","minutes","hours","padStart","StravaActivityDetails","stravaToken","href","entries","StravaActivityDetailsWithToken","activity","loading","WorldDetails","Details","ElevationChartPreview","filteredData","lowestElevation","min","d","SearchResultCardRoute","onHoverRoute","showWorldName","RouteInfo","ChartContainer","onMouseEnter","onMouseLeave","ref","useRef","onScreen","isIntersecting","setIntersecting","current","observer","IntersectionObserver","entry","observe","unobserve","useOnScreen","pointerEvents","SearchResultCardStravaActivity","SearchResultCardStravaActivityWithToken","SearchResultCardWorld","sports","SearchResultList","onResultClick","searchResult","Divider","SearchResultCard","Sidebar","bottomSheetOpen","setBottomSheetOpen","containerRef","settingsDialogVisible","setSettingsDialogVisible","term","test","exec","sr","every","some","srt","className","c","styles","Container","BottomSheetOpen","DragHandle","KeyboardArrowDownFontIcon","SearchBox","TextField","placeholder","isRightAddon","rightChildren","buttonType","aria-label","FontIcon","NoGapDivider","Content","BottomMenu","SettingsFontIcon","DragHandleBottom","KeyboardArrowUpFontIcon","options","WorldSelect","Select","listboxStyle","zIndex","newWorldSlug","RouteMap","mouseHoverDistance","previewRoute","worldConfig","stravaSegmentsToShow","fs","stravaSegments","stravaData","setMap","zoomControl","setPosition","routeStravaSegment","stravaActivity","previewRouteStravaSegment","bounds","reduce","coord","extend","LatLngBounds","invalidateSize","fitBounds","setMaxBounds","minZoom","getBoundsZoom","setMinZoom","pointCoordinates","pointIndex","MapContainer","whenCreated","maxZoom","ImageOverlay","attribution","Pane","Polyline","positions","pathOptions","weight","Circle","center","radius","fillColor","App","setStravaToken","updateStravaToken","has","delete","origin","pathname","useStravaTokenListener","setMouseHoverDistance","setPreviewRoute","Wrapper","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.5ac91c6b.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"Container\":\"RouteMap_Container__1kS2N\",\"MapContainer\":\"RouteMap_MapContainer__1oyLk\",\"navigationControl\":\"RouteMap_navigationControl__2RyF3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Wrapper\":\"App_Wrapper__2vPXK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Container\":\"WorldSelect_Container__3BQ6b\"};","import { Route, Segment, World } from \"../types\";\nimport routesJSON from \"./routes.json\";\nimport segmentsJSON from \"./segments.json\";\nimport worldsJSON from \"./worlds.json\";\n\nexport const routes: ReadonlyArray<Route> = routesJSON as any;\nexport const segments: ReadonlyArray<Segment> = segmentsJSON as any;\nexport const worlds: ReadonlyArray<World> = worldsJSON as any;\n","import { useCallback, useEffect, useState } from \"react\";\nimport { routes, worlds, segments } from \"../data\";\nimport { LocationState, Segment } from \"../types\";\n\nconst DEFAULT_WORLD = worlds.find((w) => w.slug === \"watopia\")!;\n\ntype Listener = (state: LocationState) => void;\nconst listeners: Listener[] = [];\n\nexport function useLocationState(): [\n  LocationState,\n  (s: LocationState) => void\n] {\n  const [state, setState] = useState(getLocationState);\n\n  useEffect(() => {\n    const listener = () => setState(getLocationState());\n    window.addEventListener(\"popstate\", listener);\n    return () => window.removeEventListener(\"popstate\", listener);\n  }, []);\n\n  useEffect(() => {\n    const listener: Listener = (newState) => setState(newState);\n    listeners.push(listener);\n\n    return () => {\n      listeners.splice(listeners.indexOf(listener), 1);\n    };\n  }, []);\n\n  const updateLocationState = useCallback((newState: LocationState) => {\n    const searchParams = new URLSearchParams();\n    searchParams.set(\"world\", newState.world.slug);\n    if (newState.route) {\n      searchParams.set(\"route\", newState.route.slug);\n    }\n    if (newState.stravaActivityId) {\n      searchParams.set(\"strava-activity\", newState.stravaActivityId);\n    }\n    if (newState.segments.length > 0) {\n      searchParams.set(\n        \"segments\",\n        newState.segments.map((s) => s.slug).join(\",\")\n      );\n    }\n    if (newState.query.length > 0) {\n      searchParams.set(\"q\", newState.query);\n    }\n\n    window.history.pushState(undefined, \"\", `?${searchParams.toString()}`);\n    setState(newState);\n    listeners.forEach((l) => l(newState));\n  }, []);\n\n  return [state, updateLocationState];\n}\n\nfunction getLocationState(): LocationState {\n  const searchParams = new URLSearchParams(window.location.search);\n\n  const world =\n    worlds.find((w) => w.slug === searchParams.get(\"world\")) ?? DEFAULT_WORLD;\n\n  const route = routes\n    .filter((r) => r.world === world?.slug)\n    .find((r) => r.slug === searchParams.get(\"route\"));\n\n  const selectedSegments = (searchParams.get(\"segments\") ?? \"\")\n    .split(\",\")\n    .map((slug) => segments.find((s) => s.slug === slug))\n    .filter((segment): segment is Segment => !!segment);\n\n  const stravaActivityId = searchParams.get(\"strava-activity\") ?? undefined;\n\n  const query = searchParams.get(\"q\") ?? \"\";\n\n  return {\n    world,\n    route,\n    segments: selectedSegments,\n    stravaActivityId,\n    query,\n  };\n}\n","import { useCallback, useEffect, useState } from \"react\";\nimport { Settings } from \"../types\";\n\nconst LOCAL_STORAGE_KEY = \"settings\";\n\ntype Listener = (settings: Settings) => void;\nconst listeners: Listener[] = [];\n\nfunction loadSettings(): Settings {\n  try {\n    const rawSettings = localStorage.getItem(LOCAL_STORAGE_KEY) ?? \"{}\";\n    const settings: Partial<Settings> = JSON.parse(rawSettings);\n\n    return {\n      sport: settings.sport ?? \"cycling\",\n      units: settings.units ?? \"metric\",\n    };\n  } catch {\n    return {\n      sport: \"cycling\",\n      units: \"metric\",\n    };\n  }\n}\n\nfunction saveSettings(settings: Settings) {\n  localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(settings));\n}\n\nexport function useSettings(): [Settings, (settings: Settings) => void] {\n  const [settings, setSettings] = useState(loadSettings);\n\n  useEffect(() => {\n    const listener: Listener = (newSettings) => setSettings(newSettings);\n    listeners.push(listener);\n\n    return () => {\n      listeners.splice(listeners.indexOf(listener), 1);\n    };\n  }, [settings]);\n\n  const updateSettings = useCallback((newSettings: Settings) => {\n    setSettings(newSettings);\n    saveSettings(newSettings);\n    listeners.forEach((listener) => listener(newSettings));\n  }, []);\n\n  return [settings, updateSettings];\n}\n","import { routes, worlds } from \"../data\";\nimport { Route, Segment, Sport, World } from \"../types\";\n\nconst REGEX_STRAVA_ACTIVITY = /strava\\.com\\/activities\\/(\\d{10})/;\n\nexport type SearchResult =\n  | SearchResultWorld\n  | SearchResultRoute\n  | SearchResultSegment\n  | SearchResultStravaActivity;\n\nexport interface SearchResultWorld {\n  type: \"world\";\n  terms: string[];\n  data: World;\n}\n\nexport interface SearchResultRoute {\n  type: \"route\";\n  terms: string[];\n  data: Route;\n}\n\nexport interface SearchResultSegment {\n  type: \"segment\";\n  terms: string[];\n  data: Segment;\n}\n\nexport interface SearchResultStravaActivity {\n  type: \"strava-activity\";\n  data: {\n    slug: string;\n    activityId: string;\n  };\n}\n\nconst searchResults: (\n  | SearchResultWorld\n  | SearchResultRoute\n  | SearchResultSegment\n)[] = [\n  ...[...worlds]\n    .sort((a, b) => a.name.localeCompare(b.name))\n    .map((world) => ({\n      type: \"world\" as const,\n      terms: [world.name].map((t) => t.toLocaleLowerCase()),\n      data: world,\n    })),\n  ...[...routes]\n    .sort((a, b) => a.name.localeCompare(b.name))\n    .filter((route) => route.stravaSegmentId !== undefined)\n    .map((route) => ({\n      type: \"route\" as const,\n      terms: [worlds.find((w) => w.slug === route.world)!.name, route.name].map(\n        (t) => t.toLocaleLowerCase()\n      ),\n      data: route,\n    })),\n  //   ...segments\n  //     .filter((route) => route.stravaSegmentId !== undefined)\n  //     .map((segment) => ({\n  //     type: \"segment\" as const,\n  //     terms: [\n  //       worlds.find((w) => w.slug === segment.slug)!.name,\n  //       segment.name,\n  //     ].map((t) => t.toLocaleLowerCase()),\n  //     data: segment,\n  //   })),\n];\n\nexport function search(term: string, sport: Sport): SearchResult[] {\n  if (REGEX_STRAVA_ACTIVITY.test(term)) {\n    const [, stravaActivityId] = REGEX_STRAVA_ACTIVITY.exec(term)!;\n    return [\n      {\n        type: \"strava-activity\",\n        data: {\n          activityId: stravaActivityId,\n          slug: `strava-activity-${stravaActivityId}`,\n        },\n      },\n    ];\n  }\n\n  const terms = term\n    .toLocaleLowerCase()\n    .split(\" \")\n    .filter((t) => t.length > 0);\n\n  return searchResults\n    .filter((sr) => {\n      if (sr.type === \"world\" || sr.type === \"segment\") {\n        return true;\n      } else {\n        return sr.data.sports.includes(sport);\n      }\n    })\n\n    .filter((sr) =>\n      terms.every((t) => sr.terms.some((srt) => srt.includes(t)))\n    );\n}\n\nexport const searchResultTypes = {\n  world: {\n    title: \"Worlds\",\n  },\n  route: {\n    title: \"Routes\",\n  },\n  segment: {\n    title: \"Segments\",\n  },\n  \"strava-activity\": {\n    title: \"Strava Activity\",\n  },\n};\n","import { Button } from \"@react-md/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@react-md/dialog\";\nimport { Fieldset, Radio } from \"@react-md/form\";\nimport React, { ChangeEvent } from \"react\";\nimport { useSettings } from \"../../hooks/useSettings\";\nimport { Settings, Sport } from \"../../types\";\n\ninterface Props {\n  visible: boolean;\n  onClose: () => void;\n}\n\nexport function SettingsDialog({ visible, onClose }: Props) {\n  const [settings, setSettings] = useSettings();\n\n  const handleSportChange = (e: ChangeEvent<HTMLInputElement>) => {\n    if (e.target.checked) {\n      setSettings({ ...settings, sport: e.target.value as Sport });\n    }\n  };\n\n  const handleUnitsChange = (e: ChangeEvent<HTMLInputElement>) => {\n    if (e.target.checked) {\n      setSettings({ ...settings, units: e.target.value as Settings[\"units\"] });\n    }\n  };\n\n  return (\n    <Dialog\n      id=\"settings-dialog\"\n      aria-labelledby=\"settings-dialog-title\"\n      visible={visible}\n      onRequestClose={onClose}\n    >\n      <DialogHeader>\n        <DialogTitle id=\"settings-dialog-title\">Settings</DialogTitle>\n      </DialogHeader>\n      <DialogContent>\n        <Fieldset legend=\"Sport\">\n          <Radio\n            id=\"settings-dialog-cycling\"\n            name=\"settings-dialog-sport\"\n            label=\"Cycling\"\n            value=\"cycling\"\n            checked={settings.sport === \"cycling\"}\n            onChange={handleSportChange}\n          />\n          <Radio\n            id=\"settings-dialog-running\"\n            name=\"settings-dialog-sport\"\n            label=\"Running\"\n            value=\"running\"\n            checked={settings.sport === \"running\"}\n            onChange={handleSportChange}\n          />\n        </Fieldset>\n\n        <Fieldset legend=\"Units\">\n          <Radio\n            id=\"settings-dialog-metric\"\n            name=\"settings-dialog-units\"\n            label=\"Metric\"\n            value=\"metric\"\n            checked={settings.units === \"metric\"}\n            onChange={handleUnitsChange}\n          />\n          <Radio\n            id=\"settings-dialog-imperial\"\n            name=\"settings-dialog-units\"\n            label=\"Imperial\"\n            value=\"imperial\"\n            checked={settings.units === \"imperial\"}\n            onChange={handleUnitsChange}\n          />\n        </Fieldset>\n      </DialogContent>\n      <DialogFooter>\n        <Button id=\"dialog-close\" onClick={onClose}>\n          Close\n        </Button>\n      </DialogFooter>\n    </Dialog>\n  );\n}\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACXlBMVEX/awD/agD/aQD/aAD/ZwD/ZQD/ZAD/YgD/YQD/YAD/XwD/XQD/XAD/WgD/WQD/VwD/VgD/VAD/UwD/UQD/WwD/UgD/UAD/XgD/gjj/eCr/TwD/TgD/Zgv/z7T/vJb/XgL/j07/+vf/8Oj/fTT/z7P/////vJj/XAP/TQD/TAD/kVD/+fb/8en/fTf/ZQz/0bb/vZr/WgT/kFD/8uv/fjr/VQD/waD/WQX/SwD/klP/9O3/fz3/ZQ7/0rn/w6T/WAb/SgD/klb//f3//v3/9O//gEL/0rr/y7H/1L//xan/Vgj/SQD/fj3/ilD/9vH/gEX/ZA//07z/WAX/Wwv/zbX/x63/Vgn/WAD/k1r/+/n/f0D/iE//+PX/9/P/gkr/ZBD/1b7/waL/WQr/yrD/ya//VQr/lFr/8+3/fT7/hEn/hE3/ZBH/1L3/vp7/VwX/UgH/Vwn/xqr//fz/yrH/VQz/TAH/SwH/ZBP/kVj/lV7/k17/kl3/bCP/Yxj/jlf/kFr/j1r/nGz/kF//i1j/iVb/iFT/jln/jVn/jVr/h1H/Vg//Wgv/nm7/tpH/tZD/rYX/aCT/SAD/dDb/sIr/so7/s4//j13/TQT/dTT/sYv/sYz/sY3/k2D/UAX/Vg3/nXD/sIz/qoL/ZSP/Vgr/mmr/sIv/rIX/ayj/dzv/jFj/TAP/cS//rof/kl//WxP/qoH/ZCL/Ugj/l2b/q4T/lGH/roj/by//qYD/YyD/Ugf/lmX/ilT/SwL/bCv/qH//YR3/TwX/iVP/aSj/TQX/kV//aSn/pHn/YR7/Tgf/ayv0qRl1AAAAAWJLR0QlwwHJDwAAAAd0SU1FB+UECw4ZCUCePeYAAAJ3SURBVDjLjdTnX9NAGMDxsypim66kabXFgXraiFvRqijR4jz3qgPce6EoOHDj3hFxEEcdVxXBvTdu/yvvujIuH/FetHnx/fyaNs9TAOhpZbPZWrchp21OTrvc3PZ2u8Ph4JxOl9vt9ni9Xl4Q/uF8WecVU7ClHnUC6+yWzs+4QIeOHOuCIaaX16lzFwsXAqb7c3TN79bd6TN9bigJ9S6Q1wPCnr2YXlgCxu/L9S6AsE9ft6kXliRgcIF+/SE5AwaaewQafj/foAIKBw8pNPVSUPudU0EIhw4z9aQI0Dvf8PwUHDFSNPYiBGqOKxoF02d0MW/oRWSge76+MTQ4NkpeSsYFDT1ZBprjisbT2ISJ9HXSZENPRkCbF2cyWDJlKv3m06YH9T2EgDZXM2Ym727W7Dn0fe48g0Mg62LzF9DgQlFcVEouyhZLekdgZk6XLKWhZcVefvkKerVyld4hkJn72GoaXLNW5MXgujJyWbpeJizjEEj3XBs2wmgUbtrMl5cLW7bCigq4bbtUWVmVdgSm5j62Y+eu3dXVe0Rh7779Bw4eqjl8pOboseMnTqIMzOyHp5A+C1H0nzp95uy58wpSLtRerLt0WQdNc++/crVevXY9cuOmGr91W9Egsx937qo4cQ/dr8XqgwaUhRyzH+GHjVhtekSCj58oGmT3Lfz0mYqfv3hpCBLoYvYj8qoR4ziOv36j6CC7b5L09p2KMVbff0A6yO6bJMkfExjXf/qsGKGH2Q/5S5OK1eYqZIBMjzxf9DVhCiLA9ugcfPte16y/QwItemQOlB8/fykMZHrk/P7TgMyQ7VkdwFv1rKDwfy4J6f9kSw79BReDIgKN7zeEAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIxLTA0LTExVDE0OjI0OjUyKzAwOjAwCFzYFAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMS0wNC0xMVQxNDoyNDozMiswMDowML9uaS8AAAAASUVORK5CYII=\"","import { useSettings } from \"../../hooks/useSettings\";\n\nconst formatDigits = new Intl.NumberFormat(\"en-US\", {\n  minimumFractionDigits: 1,\n  maximumFractionDigits: 1,\n  style: \"decimal\",\n});\n\nconst formatNoDigits = new Intl.NumberFormat(\"en-US\", {\n  minimumFractionDigits: 0,\n  maximumFractionDigits: 0,\n  style: \"decimal\",\n});\n\ninterface Props {\n  distance: number;\n}\n\nexport function Distance({ distance }: Props) {\n  const [settings] = useSettings();\n  switch (settings.units) {\n    case \"imperial\": {\n      const value = distance / 1.609;\n      if (value < 0.3) {\n        return <>{formatNoDigits.format(value * 5280)}ft</>;\n      } else {\n        return <>{formatDigits.format(value)}mi</>;\n      }\n    }\n    case \"metric\": {\n      if (distance < 1) {\n        return <>{formatNoDigits.format(distance * 1000)}m</>;\n      } else {\n        return <>{formatDigits.format(distance)}km</>;\n      }\n    }\n  }\n}\n","import { useSettings } from \"../../hooks/useSettings\";\n\nconst formatNoDigits = new Intl.NumberFormat(\"en-US\", {\n  minimumFractionDigits: 0,\n  maximumFractionDigits: 0,\n  style: \"decimal\",\n});\n\ninterface Props {\n  elevation: number;\n}\n\nexport function Elevation({ elevation }: Props) {\n  const [settings] = useSettings();\n  switch (settings.units) {\n    case \"imperial\":\n      return <>{formatNoDigits.format(elevation * 3.28084)}ft</>;\n    case \"metric\":\n      return <>{formatNoDigits.format(elevation)}m</>;\n  }\n}\n","import { StravaSegment } from \"../types\";\n\nconst cache: { [cacheKey: string]: Promise<any> } = {};\n\nexport async function getStravaSegmentStream<\n  Stream extends \"altitude\" | \"distance\" | \"latlng\"\n>(\n  segmentSlug: string,\n  type: \"segments\" | \"routes\",\n  stream: Stream\n): Promise<StravaSegment[Stream]> {\n  const cacheKey = `${type}-${segmentSlug}-${stream}`;\n  if (!cache[cacheKey]) {\n    cache[cacheKey] = fetchStravaSegmentStream(segmentSlug, type, stream);\n  }\n\n  return cache[cacheKey];\n}\n\nexport async function getStravaSegmentStreams<\n  Stream extends \"altitude\" | \"distance\" | \"latlng\"\n>(\n  segmentSlug: string,\n  type: \"segments\" | \"routes\",\n  streams: ReadonlyArray<Stream>\n): Promise<Pick<StravaSegment, Stream>> {\n  const streamData = await Promise.all(\n    streams.map((stream) => getStravaSegmentStream(segmentSlug, type, stream))\n  );\n\n  // @ts-ignore\n  return Object.fromEntries(\n    streams.map((stream, i) => [stream, streamData[i]])\n  );\n}\n\nasync function fetchStravaSegmentStream<\n  Stream extends \"altitude\" | \"distance\" | \"latlng\"\n>(\n  segmentSlug: string,\n  type: \"segments\" | \"routes\",\n  stream: Stream\n): Promise<StravaSegment[Stream]> {\n  const response = await fetch(\n    `${type}/${segmentSlug}/${stream}.json`\n  );\n  return await response.json();\n}\n","export function ElevationGradient() {\n  return (\n    <linearGradient id=\"colorElevation\"  x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n      <stop offset=\"5%\" stopColor=\"black\" stopOpacity={0.8} />\n      <stop offset=\"95%\" stopColor=\"black\" stopOpacity={0} />\n    </linearGradient>\n  );\n}\n","import uniqWith from \"lodash/uniqWith\";\nimport React, { useEffect, useMemo } from \"react\";\nimport { useAsync } from \"react-async-hook\";\nimport {\n  Area,\n  AreaChart,\n  CartesianGrid,\n  ResponsiveContainer,\n  Tooltip,\n  TooltipProps,\n  XAxis,\n  YAxis,\n} from \"recharts\";\nimport { getStravaSegmentStreams } from \"../../services/StravaSegmentRepository\";\nimport { Route, StravaSegment } from \"../../types\";\nimport { ElevationGradient } from \"../ElevationGradient\";\n\ninterface Props {\n  route: Route;\n  onMouseHoverDistanceChange: (distance: number | undefined) => void;\n}\n\nconst REQUIRED_STREAMS = [\"altitude\", \"distance\"] as const;\n\nexport function ElevationChart({ route, onMouseHoverDistanceChange }: Props) {\n  const { result: segment } = useAsync<\n    Pick<StravaSegment, \"altitude\" | \"distance\">\n  >(getStravaSegmentStreams, [route.slug, \"routes\", REQUIRED_STREAMS]);\n\n  const data: any[] | undefined = useMemo(() => {\n    if (segment === undefined) {\n      return;\n    }\n\n    return uniqWith(\n      segment.distance.map((distance, index) => ({\n        distance: Math.round(distance / 10) / 100,\n        elevation: segment.altitude[index],\n      })),\n      (a, b) => a.distance === b.distance\n    );\n  }, [segment]);\n\n  if (data === undefined) {\n    return null;\n  }\n\n  return (\n    <div style={{ width: \"100%\", height: 100 }}>\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\n        <AreaChart\n          data={data}\n          margin={{\n            top: 25,\n            right: 15,\n            left: 15,\n            bottom: 15,\n          }}\n          // @ts-ignore\n          baseValue=\"dataMin\"\n        >\n          <defs>\n            <ElevationGradient />\n          </defs>\n          <CartesianGrid vertical={false} />\n          <XAxis\n            name=\"Distance\"\n            dataKey=\"distance\"\n            type=\"number\"\n            allowDecimals={false}\n            tick={false}\n            unit=\"km\"\n            domain={[0, \"dataMax\"]}\n            hide={true}\n          />\n          <YAxis\n            name=\"Elevation\"\n            type=\"number\"\n            allowDecimals={false}\n            tickCount={5}\n            domain={[\"dataMin\", \"auto\"]}\n            unit=\"m\"\n            hide={true}\n          />\n          <Tooltip\n            content={(props) => (\n              <TooltipContent\n                {...props}\n                onMouseDistance={onMouseHoverDistanceChange}\n              />\n            )}\n            isAnimationActive={false}\n            position={{ y: 10 }}\n            cursor={{ stroke: \"black\" }}\n          />\n          <Area\n            type=\"monotone\"\n            dataKey=\"elevation\"\n            name=\"Elevation\"\n            stroke=\"black\"\n            fillOpacity={1}\n            fill=\"url(#colorElevation)\"\n            unit=\"m\"\n            isAnimationActive={false}\n          />\n        </AreaChart>\n      </ResponsiveContainer>\n    </div>\n  );\n}\n\ninterface TooltipContentProps extends TooltipProps<any, any> {\n  onMouseDistance: (distance: number | undefined) => void;\n}\n\nfunction TooltipContent(props: TooltipContentProps) {\n  useEffect(() => {\n    if (props.payload === undefined || props.payload.length === 0) {\n      props.onMouseDistance(undefined);\n    } else {\n      props.onMouseDistance(props.label * 1_000);\n    }\n  }, [props]);\n\n  return null;\n}\n","let cache: Promise<ZwiftEvent[]>;\n\nexport async function fetchEvents(): Promise<ZwiftEvent[]> {\n  if (!cache) {\n    cache = fetch(\n      \"https://us-or-rly101.zwift.com/api/public/events/upcoming\"\n    ).then((r) => r.json());\n  }\n\n  return await cache;\n}\n\nexport interface ZwiftEvent {\n  id: number;\n  worldId: number;\n  name: string;\n  description: string;\n  shortName: null | string;\n  shortDescription: null | string;\n  imageUrl: string;\n  rulesId: number;\n  mapId: number;\n  routeId: number;\n  routeUrl: null | string;\n  jerseyHash: number | null;\n  bikeHash: number | null;\n  visible: boolean;\n  overrideMapPreferences: boolean;\n  eventStart: string;\n  durationInSeconds: number;\n  distanceInMeters: number;\n  laps: number;\n  privateEvent: boolean;\n  invisibleToNonParticipants: boolean;\n  followeeEntrantCount: number;\n  totalEntrantCount: number;\n  followeeSignedUpCount: number;\n  totalSignedUpCount: number;\n  followeeJoinedCount: number;\n  totalJoinedCount: number;\n  eventSubgroups: EventSubgroup[];\n  eventSeries: EventSeries | null;\n  auxiliaryUrl: null | string;\n  imageS3Name: null;\n  imageS3Bucket: null;\n  sport: Sport;\n  cullingType: CullingType;\n  rulesSet: RulesSet[];\n  recurring: boolean;\n  recurringOffset: number | null;\n  publishRecurring: boolean;\n  parentId: number | null;\n  type: Type;\n  workoutHash: null;\n  customUrl: null | string;\n  restricted: boolean;\n  unlisted: boolean;\n  eventSecret: null | string;\n  accessExpression: null;\n  tags: string[];\n  qualificationRuleIds: null;\n  lateJoinInMinutes: number | null;\n  timeTrialOptions: TimeTrialOptions | null;\n  microserviceName: string | null;\n  microserviceExternalResourceId: null | string;\n  microserviceEventVisibility: string | null;\n  minGameVersion: null;\n  recordable: boolean;\n  imported: boolean;\n  eventTemplateId: null;\n  eventType: ZwiftEventType;\n}\n\nexport enum CullingType {\n  CullingEventOnly = \"CULLING_EVENT_ONLY\",\n  CullingEverybody = \"CULLING_EVERYBODY\",\n  CullingSubgroupOnly = \"CULLING_SUBGROUP_ONLY\",\n}\n\nexport interface EventSeries {\n  id: number;\n  name: string;\n  description: Description | null;\n  imported: boolean;\n}\n\nexport enum Description {\n  TourOfWatopiaRideStage5 = \"Tour of Watopia - Ride Stage 5\",\n  TourOfWatopiaRunStage5 = \"Tour of Watopia - Run Stage 5\",\n}\n\nexport interface EventSubgroup {\n  id: number;\n  name: string;\n  description: string;\n  label: number;\n  subgroupLabel: SubgroupLabel;\n  rulesId: number;\n  mapId: number;\n  routeId: number;\n  routeUrl: null | string;\n  jerseyHash: number | null;\n  bikeHash: number | null;\n  startLocation: number;\n  invitedLeaders: number[];\n  invitedSweepers: number[];\n  paceType: number;\n  fromPaceValue: number;\n  toPaceValue: number;\n  fieldLimit: null;\n  registrationStart: string;\n  registrationEnd: string;\n  lineUpStart: string;\n  lineUpEnd: string;\n  eventSubgroupStart: string;\n  durationInSeconds: number;\n  laps: number;\n  distanceInMeters: number;\n  signedUp: boolean;\n  signupStatus: number;\n  registered: boolean;\n  registrationStatus: number;\n  followeeEntrantCount: number;\n  totalEntrantCount: number;\n  followeeSignedUpCount: number;\n  totalSignedUpCount: number;\n  followeeJoinedCount: number;\n  totalJoinedCount: number;\n  auxiliaryUrl: null | string;\n  rulesSet: RulesSet[];\n  workoutHash: null;\n  customUrl: null | string;\n  overrideMapPreferences: boolean;\n  tags: string[];\n  lateJoinInMinutes: number | null;\n  timeTrialOptions: TimeTrialOptions | null;\n  qualificationRuleIds: null;\n  accessValidationResult: null;\n}\n\nexport type RulesSet =\n  | \"ALLOWS_LATE_JOIN\"\n  | \"DISABLE_CONTROLLED_ROLLOUT\"\n  | \"LADIES_ONLY\"\n  | \"MEN_ONLY\"\n  | \"NO_DRAFTING\"\n  | \"NO_POWERUPS\"\n  | \"NO_TT_BIKES\"\n  | \"SHOW_RACE_RESULTS\";\n\nexport type SubgroupLabel = \"A\" | \"B\" | \"C\" | \"D\" | \"E\";\n\nexport interface TimeTrialOptions {\n  timeGapBetweenRowsMs: number;\n  maxRows: number;\n  maxRidersPerRow: number;\n}\n\nexport type ZwiftEventType = \"GROUP_RIDE\" | \"GROUP_WORKOUT\" | \"RACE\" | \"TIME_TRIAL\";\n\nexport type Sport = \"CYCLING\" | \"RUNNING\";\n\nexport type Type =\n  | \"EVENT_TYPE_GROUP_RIDE\"\n  | \"EVENT_TYPE_GROUP_WORKOUT\"\n  | \"EVENT_TYPE_RACE\"\n  | \"EVENT_TYPE_TIME_TRIAL\";\n","import { ListItem, SimpleListItem } from \"@react-md/list\";\nimport { EventFontIcon } from \"@react-md/material-icons\";\nimport { CircularProgress } from \"@react-md/progress\";\nimport { Text } from \"@react-md/typography\";\nimport round from \"lodash/round\";\nimport React, { useMemo } from \"react\";\nimport { useAsync } from \"react-async-hook\";\nimport { fetchEvents, ZwiftEventType } from \"../../../../services/fetchEvents\";\nimport { Route } from \"../../../../types\";\nimport { Distance } from \"../../../Distance\";\n\ninterface Props {\n  route: Route;\n}\n\nexport function RouteEvents({ route }: Props) {\n  const { result: events } = useAsync(fetchEvents, []);\n  const filteredEvents = useMemo(() => {\n    if (!events) {\n      return;\n    }\n\n    return events\n      .filter((event) => {\n        const eventRouteIds = [\n          event.routeId,\n          ...event.eventSubgroups.map((esg) => esg.routeId),\n        ];\n\n        return eventRouteIds.includes(route.id);\n      })\n      .sort((a, b) => a.eventStart.localeCompare(b.eventStart));\n  }, [events, route]);\n\n  if (filteredEvents === undefined) {\n    return (\n      <SimpleListItem>\n        <CircularProgress\n          id=\"loading-events\"\n          small\n          circleStyle={{ stroke: \"black\" }}\n        />\n      </SimpleListItem>\n    );\n  }\n\n  if (filteredEvents.length === 0) {\n    return (\n      <SimpleListItem>\n        <Text type=\"body-2\">No events on this route today.</Text>\n      </SimpleListItem>\n    );\n  }\n\n  return (\n    <>\n      {filteredEvents.slice(0, 3).map((event) => (\n        <ListItem\n          key={event.id}\n          onClick={() =>\n            window.open(`http://zwift.com/events/view/${event.id}`, \"_blank\")\n          }\n          rightAddon={<EventFontIcon />}\n          rightAddonType=\"icon\"\n          secondaryText={\n            <>\n              {new Intl.DateTimeFormat(\"en-US\", {\n                hour: \"2-digit\",\n                minute: \"2-digit\",\n                weekday: \"short\",\n              }).format(Date.parse(event.eventStart))}\n              <br />\n              {eventTypes[event.eventType] ?? event.eventType} |&nbsp;\n              {event.distanceInMeters !== 0 ? (\n                <Distance distance={event.distanceInMeters / 1_000} />\n              ) : event.durationInSeconds > 0 ? (\n                <>{round(event.durationInSeconds) / 60}min</>\n              ) : (\n                <>{event.laps === 1 ? `1 lap` : `${event.laps} laps`}</>\n              )}\n            </>\n          }\n          threeLines\n        >\n          {event.name}\n        </ListItem>\n      ))}\n      {filteredEvents.length > 3 && (\n        <SimpleListItem>\n          <Text type=\"body-2\">\n            {filteredEvents.length - 3} more{\" \"}\n            {filteredEvents.length === 4 ? \"event\" : \"events\"} happening today\n          </Text>\n        </SimpleListItem>\n      )}\n    </>\n  );\n}\n\nconst eventTypes: { [type in ZwiftEventType]: string } = {\n  GROUP_RIDE: \"Group Ride\",\n  GROUP_WORKOUT: \"Workout\",\n  RACE: \"Race\",\n  TIME_TRIAL: \"Time Trial\",\n};\n","import { ListItem, SimpleListItem } from \"@react-md/list\";\nimport {\n  VisibilityFontIcon,\n  VisibilityOffFontIcon,\n} from \"@react-md/material-icons\";\nimport { Text } from \"@react-md/typography\";\nimport React from \"react\";\nimport { segments } from \"../../../../data\";\nimport { useLocationState } from \"../../../../hooks/useLocationState\";\nimport { Route, Segment, SegmentType } from \"../../../../types\";\nimport { Distance } from \"../../../Distance\";\n\ninterface Props {\n  route: Route;\n}\n\nexport function RouteSegments({ route }: Props) {\n  const [locationState, setLocationState] = useLocationState();\n  const segmentsOnRoute = segments\n    .filter((s) => s.world === route.world)\n    .filter((s) => route.segments.includes(s.slug))\n    .sort((a, b) => a.name.localeCompare(b.name));\n\n  if (segmentsOnRoute.length === 0) {\n    return (\n      <SimpleListItem>\n        <Text type=\"body-2\">No segments on this route.</Text>\n      </SimpleListItem>\n    );\n  }\n\n  return (\n    <>\n      {segmentsOnRoute.map((segment) => (\n        <ListItem\n          key={segment.slug}\n          disabled={segment.stravaSegmentId === undefined}\n          rightAddonType=\"icon\"\n          rightAddon={\n            segment.stravaSegmentId ===\n            undefined ? null : locationState.segments.includes(segment) ? (\n              <VisibilityFontIcon />\n            ) : (\n              <VisibilityOffFontIcon />\n            )\n          }\n          secondaryText={<SecondaryText segment={segment} />}\n          threeLines\n          onClick={() => {\n            if (segment.stravaSegmentId === undefined) {\n              return;\n            }\n\n            if (locationState.segments.includes(segment)) {\n              setLocationState({\n                ...locationState,\n                segments: locationState.segments.filter((s) => s !== segment),\n              });\n            } else {\n              setLocationState({\n                ...locationState,\n                segments: [...locationState.segments, segment],\n              });\n            }\n          }}\n        >\n          {segment.name}\n        </ListItem>\n      ))}\n    </>\n  );\n}\n\ninterface SecondaryTextProps {\n  segment: Segment;\n}\n\nfunction SecondaryText({ segment }: SecondaryTextProps) {\n  return (\n    <>\n      {segmentTypes[segment.type]}\n      <br />\n      <Distance distance={segment.distance} />\n      {segment.avgIncline && (\n        <>\n          {\" \"}\n          |{\" \"}\n          {new Intl.NumberFormat(\"en-US\", {\n            minimumFractionDigits: 1,\n            maximumFractionDigits: 1,\n            style: \"percent\",\n          }).format(segment.avgIncline / 100)}\n        </>\n      )}\n    </>\n  );\n}\n\nconst segmentTypes: { [type in SegmentType]: string } = {\n  climb: \"Climb\",\n  sprint: \"Sprint\",\n  segment: \"Segment\",\n};\n","import { Avatar } from \"@react-md/avatar\";\nimport { Button } from \"@react-md/button\";\nimport { TextIconSpacing } from \"@react-md/icon\";\nimport { List, ListItem, ListSubheader, SimpleListItem } from \"@react-md/list\";\nimport {\n  EventFontIcon,\n  LandscapeFontIcon,\n  ListFontIcon,\n  MapFontIcon,\n  OpenInNewFontIcon,\n  SpaceBarFontIcon,\n  StarFontIcon,\n} from \"@react-md/material-icons\";\nimport { Text } from \"@react-md/typography\";\nimport stravaLogo from \"../../../../assets/strava-40x40.png\";\nimport whatsOnZwiftLogo from \"../../../../assets/WhatsOnZwift-40x40.png\";\nimport zwiftInsiderLogo from \"../../../../assets/ZwiftInsider-40x40.jpg\";\nimport { worlds } from \"../../../../data\";\nimport { Route } from \"../../../../types\";\nimport { Distance } from \"../../../Distance\";\nimport { Elevation } from \"../../../Elevation\";\nimport { ElevationChart } from \"../../ElevationChart\";\nimport { RouteEvents } from \"./RouteEvents\";\nimport { RouteSegments } from \"./RouteSegments\";\n\ninterface Props {\n  route: Route;\n  onMouseHoverDistanceChange: (distance: number | undefined) => void;\n  backButtonText: string;\n  onBackButtonClick: () => void;\n}\n\nexport function RouteDetails({\n  route,\n  onMouseHoverDistanceChange,\n  backButtonText,\n  onBackButtonClick,\n}: Props) {\n  const world = worlds.find((w) => w.slug === route.world)!;\n\n  return (\n    <List>\n      <SimpleListItem>\n        <Button themeType=\"outline\" onClick={onBackButtonClick}>\n          <TextIconSpacing icon={<ListFontIcon />}>\n            {backButtonText}\n          </TextIconSpacing>\n        </Button>\n      </SimpleListItem>\n      <SimpleListItem>\n        <Text type=\"headline-6\" style={{ margin: 0 }}>\n          {route.name}\n        </Text>\n      </SimpleListItem>\n\n      <SimpleListItem\n        clickable={false}\n        leftAddon={<SpaceBarFontIcon />}\n        leftAddonType=\"icon\"\n      >\n        <Distance distance={route.distance} />\n        {route.leadInDistance !== undefined && (\n          <>\n            &nbsp;\n            <small>\n              (+\n              <Distance distance={route.leadInDistance} />)\n            </small>\n          </>\n        )}\n      </SimpleListItem>\n\n      <SimpleListItem\n        clickable={false}\n        leftAddon={<LandscapeFontIcon />}\n        leftAddonType=\"icon\"\n      >\n        <Elevation elevation={route.elevation} />\n        {route.leadInElevation !== undefined && (\n          <>\n            &nbsp;\n            <small>(+<Elevation elevation={route.leadInElevation} />)</small>\n          </>\n        )}\n      </SimpleListItem>\n\n      {route.experience && (\n        <SimpleListItem\n          clickable={false}\n          leftAddon={<StarFontIcon />}\n          leftAddonType=\"icon\"\n        >\n          {route.experience}XP\n        </SimpleListItem>\n      )}\n\n      {route.eventOnly && (\n        <SimpleListItem\n          clickable={false}\n          leftAddon={<EventFontIcon />}\n          leftAddonType=\"icon\"\n        >\n          Event only route\n        </SimpleListItem>\n      )}\n\n      <SimpleListItem clickable={false} leftAddon={<MapFontIcon />}>\n        {world.name}\n      </SimpleListItem>\n\n      <SimpleListItem>\n        <ElevationChart\n          route={route}\n          onMouseHoverDistanceChange={onMouseHoverDistanceChange}\n        />\n      </SimpleListItem>\n\n      <ListSubheader>Upcoming Events</ListSubheader>\n      <RouteEvents route={route} />\n\n      <ListSubheader>Segments</ListSubheader>\n      <RouteSegments route={route} />\n\n      <ListSubheader>Links</ListSubheader>\n      {route.zwiftInsiderUrl && (\n        <ListItem\n          onClick={() => window.open(route.zwiftInsiderUrl, \"_blank\")}\n          leftAddon={\n            <Avatar color=\"#fc6719\">\n              <img src={zwiftInsiderLogo} alt=\"\" />\n            </Avatar>\n          }\n          leftAddonType=\"avatar\"\n          rightAddon={<OpenInNewFontIcon />}\n          rightAddonType=\"icon\"\n        >\n          ZwiftInsider\n        </ListItem>\n      )}\n      {route.stravaSegmentUrl && (\n        <ListItem\n          onClick={() => window.open(route.stravaSegmentUrl, \"_blank\")}\n          leftAddon={\n            <Avatar color=\"#ff6b00\">\n              <img src={stravaLogo} alt=\"\" />\n            </Avatar>\n          }\n          leftAddonType=\"avatar\"\n          rightAddon={<OpenInNewFontIcon />}\n          rightAddonType=\"icon\"\n        >\n          Strava Segment\n        </ListItem>\n      )}\n      {route.whatsOnZwiftUrl && (\n        <ListItem\n          onClick={() => window.open(route.whatsOnZwiftUrl, \"_blank\")}\n          leftAddon={\n            <Avatar color=\"#000000\">\n              <img src={whatsOnZwiftLogo} alt=\"\" />\n            </Avatar>\n          }\n          leftAddonType=\"avatar\"\n          rightAddon={<OpenInNewFontIcon />}\n          rightAddonType=\"icon\"\n        >\n          What's on Zwift\n        </ListItem>\n      )}\n    </List>\n  );\n}\n","export default \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/7QCcUGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAIAcAmcAFFZ6OV92RS1idE11UnlFTTlMOTRpHAIoAGJGQk1EMDEwMDBhOWIwZDAwMDAwMjFlMDAwMGQ4MjIwMDAwZmYyNTAwMDA5YzI4MDAwMDQxMmMwMDAwYTczMTAwMDBiMDNlMDAwMDIwNDEwMDAwNjY0MzAwMDBjMDRjMDAwMP/iC/hJQ0NfUFJPRklMRQABAQAAC+gAAAAAAgAAAG1udHJSR0IgWFlaIAfZAAMAGwAVACQAH2Fjc3AAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAD21gABAAAAANMtAAAAACn4Pd6v8lWueEL65MqDOQ0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEGRlc2MAAAFEAAAAeWJYWVoAAAHAAAAAFGJUUkMAAAHUAAAIDGRtZGQAAAngAAAAiGdYWVoAAApoAAAAFGdUUkMAAAHUAAAIDGx1bWkAAAp8AAAAFG1lYXMAAAqQAAAAJGJrcHQAAAq0AAAAFHJYWVoAAArIAAAAFHJUUkMAAAHUAAAIDHRlY2gAAArcAAAADHZ1ZWQAAAroAAAAh3d0cHQAAAtwAAAAFGNwcnQAAAuEAAAAN2NoYWQAAAu8AAAALGRlc2MAAAAAAAAAH3NSR0IgSUVDNjE5NjYtMi0xIGJsYWNrIHNjYWxlZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABYWVogAAAAAAAAJKAAAA+EAAC2z2N1cnYAAAAAAAAEAAAAAAUACgAPABQAGQAeACMAKAAtADIANwA7AEAARQBKAE8AVABZAF4AYwBoAG0AcgB3AHwAgQCGAIsAkACVAJoAnwCkAKkArgCyALcAvADBAMYAywDQANUA2wDgAOUA6wDwAPYA+wEBAQcBDQETARkBHwElASsBMgE4AT4BRQFMAVIBWQFgAWcBbgF1AXwBgwGLAZIBmgGhAakBsQG5AcEByQHRAdkB4QHpAfIB+gIDAgwCFAIdAiYCLwI4AkECSwJUAl0CZwJxAnoChAKOApgCogKsArYCwQLLAtUC4ALrAvUDAAMLAxYDIQMtAzgDQwNPA1oDZgNyA34DigOWA6IDrgO6A8cD0wPgA+wD+QQGBBMEIAQtBDsESARVBGMEcQR+BIwEmgSoBLYExATTBOEE8AT+BQ0FHAUrBToFSQVYBWcFdwWGBZYFpgW1BcUF1QXlBfYGBgYWBicGNwZIBlkGagZ7BowGnQavBsAG0QbjBvUHBwcZBysHPQdPB2EHdAeGB5kHrAe/B9IH5Qf4CAsIHwgyCEYIWghuCIIIlgiqCL4I0gjnCPsJEAklCToJTwlkCXkJjwmkCboJzwnlCfsKEQonCj0KVApqCoEKmAquCsUK3ArzCwsLIgs5C1ELaQuAC5gLsAvIC+EL+QwSDCoMQwxcDHUMjgynDMAM2QzzDQ0NJg1ADVoNdA2ODakNww3eDfgOEw4uDkkOZA5/DpsOtg7SDu4PCQ8lD0EPXg96D5YPsw/PD+wQCRAmEEMQYRB+EJsQuRDXEPURExExEU8RbRGMEaoRyRHoEgcSJhJFEmQShBKjEsMS4xMDEyMTQxNjE4MTpBPFE+UUBhQnFEkUahSLFK0UzhTwFRIVNBVWFXgVmxW9FeAWAxYmFkkWbBaPFrIW1hb6Fx0XQRdlF4kXrhfSF/cYGxhAGGUYihivGNUY+hkgGUUZaxmRGbcZ3RoEGioaURp3Gp4axRrsGxQbOxtjG4obshvaHAIcKhxSHHscoxzMHPUdHh1HHXAdmR3DHeweFh5AHmoelB6+HukfEx8+H2kflB+/H+ogFSBBIGwgmCDEIPAhHCFIIXUhoSHOIfsiJyJVIoIiryLdIwojOCNmI5QjwiPwJB8kTSR8JKsk2iUJJTglaCWXJccl9yYnJlcmhya3JugnGCdJJ3onqyfcKA0oPyhxKKIo1CkGKTgpaymdKdAqAio1KmgqmyrPKwIrNitpK50r0SwFLDksbiyiLNctDC1BLXYtqy3hLhYuTC6CLrcu7i8kL1ovkS/HL/4wNTBsMKQw2zESMUoxgjG6MfIyKjJjMpsy1DMNM0YzfzO4M/E0KzRlNJ402DUTNU01hzXCNf02NzZyNq426TckN2A3nDfXOBQ4UDiMOMg5BTlCOX85vDn5OjY6dDqyOu87LTtrO6o76DwnPGU8pDzjPSI9YT2hPeA+ID5gPqA+4D8hP2E/oj/iQCNAZECmQOdBKUFqQaxB7kIwQnJCtUL3QzpDfUPARANER0SKRM5FEkVVRZpF3kYiRmdGq0bwRzVHe0fASAVIS0iRSNdJHUljSalJ8Eo3Sn1KxEsMS1NLmkviTCpMcky6TQJNSk2TTdxOJU5uTrdPAE9JT5NP3VAnUHFQu1EGUVBRm1HmUjFSfFLHUxNTX1OqU/ZUQlSPVNtVKFV1VcJWD1ZcVqlW91dEV5JX4FgvWH1Yy1kaWWlZuFoHWlZaplr1W0VblVvlXDVchlzWXSddeF3JXhpebF69Xw9fYV+zYAVgV2CqYPxhT2GiYfViSWKcYvBjQ2OXY+tkQGSUZOllPWWSZedmPWaSZuhnPWeTZ+loP2iWaOxpQ2maafFqSGqfavdrT2una/9sV2yvbQhtYG25bhJua27Ebx5veG/RcCtwhnDgcTpxlXHwcktypnMBc11zuHQUdHB0zHUodYV14XY+dpt2+HdWd7N4EXhueMx5KnmJeed6RnqlewR7Y3vCfCF8gXzhfUF9oX4BfmJ+wn8jf4R/5YBHgKiBCoFrgc2CMIKSgvSDV4O6hB2EgITjhUeFq4YOhnKG14c7h5+IBIhpiM6JM4mZif6KZIrKizCLlov8jGOMyo0xjZiN/45mjs6PNo+ekAaQbpDWkT+RqJIRknqS45NNk7aUIJSKlPSVX5XJljSWn5cKl3WX4JhMmLiZJJmQmfyaaJrVm0Kbr5wcnImc951kndKeQJ6unx2fi5/6oGmg2KFHobaiJqKWowajdqPmpFakx6U4pammGqaLpv2nbqfgqFKoxKk3qamqHKqPqwKrdavprFys0K1ErbiuLa6hrxavi7AAsHWw6rFgsdayS7LCszizrrQltJy1E7WKtgG2ebbwt2i34LhZuNG5SrnCuju6tbsuu6e8IbybvRW9j74KvoS+/796v/XAcMDswWfB48JfwtvDWMPUxFHEzsVLxcjGRsbDx0HHv8g9yLzJOsm5yjjKt8s2y7bMNcy1zTXNtc42zrbPN8+40DnQutE80b7SP9LB00TTxtRJ1MvVTtXR1lXW2Ndc1+DYZNjo2WzZ8dp22vvbgNwF3IrdEN2W3hzeot8p36/gNuC94UThzOJT4tvjY+Pr5HPk/OWE5g3mlucf56noMui86Ubp0Opb6uXrcOv77IbtEe2c7ijutO9A78zwWPDl8XLx//KM8xnzp/Q09ML1UPXe9m32+/eK+Bn4qPk4+cf6V/rn+3f8B/yY/Sn9uv5L/tz/bf//ZGVzYwAAAAAAAAAuSUVDIDYxOTY2LTItMSBEZWZhdWx0IFJHQiBDb2xvdXIgU3BhY2UgLSBzUkdCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAAAAAAFAAAAAAAABtZWFzAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJYWVogAAAAAAAAAxYAAAMzAAACpFhZWiAAAAAAAABvogAAOPUAAAOQc2lnIAAAAABDUlQgZGVzYwAAAAAAAAAtUmVmZXJlbmNlIFZpZXdpbmcgQ29uZGl0aW9uIGluIElFQyA2MTk2Ni0yLTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAAD21gABAAAAANMtdGV4dAAAAABDb3B5cmlnaHQgSW50ZXJuYXRpb25hbCBDb2xvciBDb25zb3J0aXVtLCAyMDA5AABzZjMyAAAAAAABDEQAAAXf///zJgAAB5QAAP2P///7of///aIAAAPbAADAdf/bAEMACQYHCAcGCQgICAoKCQsOFw8ODQ0OHBQVERciHiMjIR4gICUqNS0lJzIoICAuPy8yNzk8PDwkLUJGQTpGNTs8Of/bAEMBCgoKDgwOGw8PGzkmICY5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5Of/AABEIACgAKAMBIgACEQEDEQH/xAAaAAEAAgMBAAAAAAAAAAAAAAAABwQFAgYD/8QALRAAAQQCAAUCAwkAAAAAAAAAAQIDAAQRBQYhEkExE3FRFiIyUlSBkpOxwdH/xAAZAQACAwEAAAAAAAAAAAAAAAAEBQIGAwH/xAAlEQACAQMCBQUAAAAAAAAAAAACAQADESEFIgQSE0FxMTKBkcH/2gAMAwEAAhEDEQA/ALERGR8ZUZfJZ11Cxsraa1ZIU4rnzOAB3JMye34XvausbK1NPNJ+2W85T7g9prwltWNVtC5YOGnUempY59PMEH25TpuJeItcrUv161huw6+joAQchIPcmHUaNAqJET3RZxFfiQ4gQAbjjt957WkfxEQGM4khcI7DVu0K1JtKU2gn60FvJJHlWcSPZInA+rTU1wuLwXrIzn7qOw/uH6dzdXb8xZq3J0NzzfHmdCWWgM+mj9IkZ8UbROy2KgzgVmcpbwMdXxV+f8SRNtVeu0HazNj0FODpK+nJA7gc5FmzpOa689UdKVKaOMp8EYyDCtTIkKFLEB0cAZsm9y9F+yrERE0sMTJUt9s6LAYr21IaT4SUg49siIkhMgdxdpA6YmrGrz3+ad1+NP7af8mJeecfdW88tS3FnKlK8kxEkVQz9zbnAo06eQFLwppERM5pP//Z\"","export default \"data:image/png;base64,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\"","import { useCallback, useEffect, useState } from \"react\";\n\ntype Listener = () => void;\nconst listeners: Listener[] = [];\n\nexport function useLocalStorage(\n  key: string\n): [string | null, (newValue: string | null) => void] {\n  const getValue = useCallback(() => {\n    return localStorage.getItem(key);\n  }, [key]);\n\n  const [value, setValueInternal] = useState<string | null>(getValue);\n\n  useEffect(() => {\n    setValueInternal(getValue());\n  }, [getValue]);\n\n  useEffect(() => {\n    const listener: Listener = () => {\n      setValueInternal(getValue());\n    };\n\n    listeners.push(listener);\n    return () => {\n      listeners.splice(\n        listeners.findIndex((l) => l === listener),\n        1\n      );\n    };\n  }, [getValue]);\n\n  const setValue = useCallback(\n    (value: string | null) => {\n      if (value === null) {\n        localStorage.removeItem(key);\n      } else {\n        localStorage.setItem(key, value);\n      }\n      setValueInternal(value);\n\n      listeners.forEach((listener) => listener());\n    },\n    [key]\n  );\n\n  useEffect(() => {\n    const eventListener = () => {\n      setValueInternal(getValue());\n    };\n    window.addEventListener(\"storage\", eventListener);\n\n    return window.removeEventListener(\"storage\", eventListener);\n  }, [getValue]);\n\n  return [value, setValue];\n}\n","import { useLocalStorage } from \"./useLocalStorage\";\n\nexport function useStravaToken(): [\n  string | null,\n  (token: string | null) => void\n] {\n  return useLocalStorage(\"strava-token\");\n}\n","const LOCAL_STORAGE_KEY = \"strava_token\";\n\nexport function getStravaToken(): string | null {\n  const tokenString = localStorage.getItem(LOCAL_STORAGE_KEY);\n  if (tokenString === null) {\n    return null;\n  }\n\n  return JSON.parse(tokenString);\n}\n\nexport function writeStravaToken(token: string): void {\n  localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(token));\n}\n\nexport function clearStravaToken(): void {\n  localStorage.removeItem(LOCAL_STORAGE_KEY);\n}\n\nexport function getStravaAuthUrl(state: Record<string, string>) {\n  const params = new URLSearchParams();\n  params.set(\"state\", JSON.stringify(state));\n\n  return `${\n    process.env.NODE_ENV === \"production\"\n      ? \"http://zwiftmap.herokuapp.com\"\n      : \"http://localhost:3001\"\n  }/strava/authorize?${params.toString()}`;\n}\n","export default __webpack_public_path__ + \"static/media/bologna.6f13d4d4.png\";","import { LatLngTuple } from \"leaflet\";\nimport bolognaMap from \"./maps/bologna.png\";\nimport critCityMap from \"./maps/crit-city.png\";\nimport franceMap from \"./maps/france.png\";\nimport innsbruckMap from \"./maps/innsbruck.png\";\nimport londonMap from \"./maps/london.png\";\nimport makuriIslandsMap from \"./maps/makuri-islands.png\";\nimport newYorkMap from \"./maps/new-york.png\";\nimport parisMap from \"./maps/paris.png\";\nimport richmondMap from \"./maps/richmond.png\";\nimport watopiaMap from \"./maps/watopia.png\";\nimport yorkshireMap from \"./maps/yorkshire.png\";\nimport { WorldSlug } from \"./types\";\n\nexport type WorldConfig = {\n  imageBounds: [LatLngTuple, LatLngTuple];\n  initialBounds: [LatLngTuple, LatLngTuple];\n  image: string;\n  backgroundColor: string;\n};\n\nexport const worldConfigs: Record<WorldSlug, WorldConfig> = {\n  bologna: {\n    imageBounds: [\n      [44.5308037, 11.26261748],\n      [44.45463821, 11.36991729102076],\n    ],\n    initialBounds: [\n      [44.501423, 11.294653],\n      [44.478222, 11.341099],\n    ],\n    image: bolognaMap,\n    backgroundColor: \"#b9b9b8\",\n  },\n  \"crit-city\": {\n    imageBounds: [\n      [-10.3657, 165.7824],\n      [-10.4038, 165.8207],\n    ],\n    initialBounds: [\n      [-10.382352, 165.798758],\n      [-10.386016, 165.803496],\n    ],\n    image: critCityMap,\n    backgroundColor: \"#7c9938\",\n  },\n  france: {\n    imageBounds: [\n      [-21.64155, 166.1384],\n      [-21.7564, 166.26125],\n    ],\n    initialBounds: [\n      [-21.697812, 166.148225],\n      [-21.744906, 166.202642],\n    ],\n    image: franceMap,\n    backgroundColor: \"#6f992d\",\n  },\n  innsbruck: {\n    imageBounds: [\n      [47.2947, 11.3501],\n      [47.2055, 11.4822],\n    ],\n    initialBounds: [\n      [47.280902, 11.386414],\n      [47.214544, 11.445934],\n    ],\n    image: innsbruckMap,\n    backgroundColor: \"#7c9938\",\n  },\n  london: {\n    imageBounds: [\n      [51.5362, -0.1776],\n      [51.4601, -0.0555],\n    ],\n    initialBounds: [\n      [51.511261, -0.134875],\n      [51.489256, -0.072996],\n    ],\n    image: londonMap,\n    backgroundColor: \"#6f992d\",\n  },\n  \"makuri-islands\": {\n    imageBounds: [\n      [-10.73746, 165.80468],\n      [-10.81405, 165.88222],\n    ],\n    initialBounds: [\n      [-10.743702, 165.830083],\n      [-10.775156, 165.859212],\n    ],\n    image: makuriIslandsMap,\n    backgroundColor: \"#7c9938\",\n  },\n  \"new-york\": {\n    imageBounds: [\n      [40.81725, -74.0227],\n      [40.74085, -73.9222],\n    ],\n    initialBounds: [\n      [40.799618, -73.982068],\n      [40.763547, -73.949602],\n    ],\n    image: newYorkMap,\n    backgroundColor: \"#bbbbb7\",\n  },\n  paris: {\n    imageBounds: [\n      [48.9058, 2.2561],\n      [48.82945, 2.3722],\n    ],\n    initialBounds: [\n      [48.874328, 2.294207],\n      [48.860895, 2.331992],\n    ],\n    image: parisMap,\n    backgroundColor: \"#b9b9b9\",\n  },\n  richmond: {\n    imageBounds: [\n      [37.5774, -77.48954],\n      [37.5014, -77.394],\n    ],\n    initialBounds: [\n      [37.558393, -77.467668],\n      [37.520429, -77.415864],\n    ],\n    image: richmondMap,\n    backgroundColor: \"#7c9938\",\n  },\n  watopia: {\n    imageBounds: [\n      [-11.62597, 166.87747],\n      [-11.70255, 167.03255],\n    ],\n    initialBounds: [\n      [-11.635444, 166.93555],\n      [-11.673613, 166.972511],\n    ],\n    image: watopiaMap,\n    backgroundColor: \"#0884e2\",\n  },\n  yorkshire: {\n    imageBounds: [\n      [54.0254, -1.632],\n      [53.9491, -1.5022],\n    ],\n    initialBounds: [\n      [53.999691, -1.592961],\n      [53.974875, -1.539474],\n    ],\n    image: yorkshireMap,\n    backgroundColor: \"#7c9938\",\n  },\n};\n","export default __webpack_public_path__ + \"static/media/crit-city.3bab2d0f.png\";","export default __webpack_public_path__ + \"static/media/france.aded90ff.png\";","export default __webpack_public_path__ + \"static/media/innsbruck.9821ed90.png\";","export default __webpack_public_path__ + \"static/media/london.54ae112e.png\";","export default __webpack_public_path__ + \"static/media/makuri-islands.5fe6bee4.png\";","export default __webpack_public_path__ + \"static/media/new-york.5bf9b5e8.png\";","export default __webpack_public_path__ + \"static/media/paris.d1eaa520.png\";","export default __webpack_public_path__ + \"static/media/richmond.72df812b.png\";","export default __webpack_public_path__ + \"static/media/watopia.0901a23e.png\";","export default __webpack_public_path__ + \"static/media/yorkshire.b83235cf.png\";","import { Activity, Streams } from \"./types\";\n\nexport async function request<T = any>(url: string, token: string): Promise<T> {\n  const response = await fetch(url, {\n    headers: {\n      Authorization: `Bearer ${token}`,\n    },\n  });\n  return await response.json();\n}\n\nexport async function fetchActivity(\n  activityId: string,\n  token: string\n): Promise<Activity> {\n  return await request<Activity>(\n    `https://www.strava.com/api/v3/activities/${activityId}`,\n    token\n  );\n}\n\nexport async function fetchActivityStreams(\n  activityId: string,\n  token: string\n): Promise<Streams> {\n  return await request<Streams>(\n    `https://www.strava.com/api/v3/activities/${activityId}/streams?keys=distance,latlng,time,altitude,wattage,speed,velocity_smooth,watts,cadence,heartrate&key_by_type=true`,\n    token\n  );\n}\n","import { worlds } from \"../data\";\nimport { World } from \"../types\";\nimport { worldConfigs } from \"../worldConfig\";\nimport { fetchActivity, fetchActivityStreams } from \"./strava-api\";\n\nconst activityCache: { [activityId: string]: Promise<StravaActivity> } = {};\n\nexport async function getStravaActivity(\n  token: string,\n  activityId: string\n): Promise<StravaActivity> {\n  if (!activityCache[activityId]) {\n    activityCache[activityId] = fetchStravaActivity(token, activityId);\n  }\n\n  return activityCache[activityId];\n}\n\nasync function fetchStravaActivity(\n  token: string,\n  activityId: string\n): Promise<StravaActivity> {\n  const esa = await fetchActivity(activityId, token);\n\n  const world = worlds.find((world) => {\n    const worldConfig = worldConfigs[world.slug];\n    const bb = worldConfig.imageBounds;\n    return (\n      bb[0][0] >= esa.start_latlng[0] &&\n      esa.start_latlng[0] >= bb[1][0] &&\n      bb[0][1] <= esa.start_latlng[1] &&\n      esa.start_latlng[1] <= bb[1][1]\n    );\n  });\n\n  if (!world) {\n    throw new Error(\"Activity was not recorded in Zwift\");\n  }\n\n  return {\n    id: esa.id.toString(),\n    name: esa.name,\n    athleteId: esa.athlete.id.toString(),\n    distance: esa.distance / 1_000,\n    elevation: esa.total_elevation_gain,\n    time: esa.moving_time,\n    world: world,\n    avgWatts: esa.average_watts,\n    photoUrl: esa.photos.primary?.urls[\"100\"],\n    streams: await fetchStravaActivityStreams(token, activityId),\n  };\n}\n\nasync function fetchStravaActivityStreams(\n  token: string,\n  activityId: string\n): Promise<StravaActivityStreams> {\n  const streams = await fetchActivityStreams(activityId, token);\n\n  return {\n    altitude: streams.altitude.data,\n    cadence: streams.cadence.data,\n    distance: streams.distance.data,\n    heartrate: streams.heartrate.data,\n    latlng: streams.latlng.data,\n    time: streams.time.data,\n    velocity: streams.velocity_smooth.data,\n    watts: streams.watts.data,\n  };\n}\n\nexport interface StravaActivity {\n  id: string;\n  athleteId: string;\n  name: string;\n  distance: number;\n  time: number;\n  elevation: number;\n  world: World;\n  avgWatts?: number;\n  photoUrl?: string;\n  streams: StravaActivityStreams;\n}\n\nexport interface StravaActivityStreams {\n  altitude: number[];\n  cadence: number[];\n  distance: number[];\n  heartrate: number[];\n  latlng: [number, number][];\n  time: number[];\n  velocity: number[];\n  watts: number[];\n}\n","interface Props {\n  seconds: number;\n}\n\nexport function Time({ seconds: secondsInput }: Props) {\n  const seconds = secondsInput % 60;\n  const minutes = ((secondsInput - seconds) / 60) % 60;\n  const hours = ((secondsInput - seconds) / 60 - minutes) / 60;\n\n  if (hours === 0) {\n    if (minutes === 0) {\n      return <>{seconds}s</>;\n    } else {\n      return (\n        <>\n          {minutes}:{seconds.toString().padStart(2, \"0\")}min\n        </>\n      );\n    }\n  } else {\n    return (\n      <>\n        {hours}:{minutes.toString().padStart(2, \"0\")}:\n        {seconds.toString().padStart(2, \"0\")}h\n      </>\n    );\n  }\n}\n","import { Avatar } from \"@react-md/avatar\";\nimport { Button } from \"@react-md/button\";\nimport { TextIconSpacing } from \"@react-md/icon\";\nimport { List, ListItem, ListSubheader, SimpleListItem } from \"@react-md/list\";\nimport {\n  LandscapeFontIcon,\n  ListFontIcon,\n  MapFontIcon,\n  OpenInNewFontIcon,\n  SpaceBarFontIcon,\n} from \"@react-md/material-icons\";\nimport { CircularProgress } from \"@react-md/progress\";\nimport { Text } from \"@react-md/typography\";\nimport React from \"react\";\nimport { useAsync } from \"react-async-hook\";\nimport stravaLogo from \"../../../../assets/strava-40x40.png\";\nimport { useStravaToken } from \"../../../../hooks/useStravaToken\";\nimport { getStravaAuthUrl } from \"../../../../services/strava\";\nimport { getStravaActivity } from \"../../../../services/StravaActivityRepository\";\nimport { Distance } from \"../../../Distance\";\nimport { Elevation } from \"../../../Elevation\";\nimport { Time } from \"../../../Time\";\n\ninterface Props {\n  activityId: string;\n\n  backButtonText: string;\n  onBackButtonClick: () => void;\n}\n\nexport function StravaActivityDetails({\n  activityId,\n  backButtonText,\n  onBackButtonClick,\n}: Props) {\n  const [stravaToken] = useStravaToken();\n\n  if (stravaToken === null) {\n    return (\n      <List>\n        <ListItem\n          leftAddon={\n            <Avatar color=\"#ff6b00\">\n              <img src={stravaLogo} alt=\"\" />\n            </Avatar>\n          }\n          leftAddonType=\"avatar\"\n          rightAddon={<OpenInNewFontIcon />}\n          rightAddonType=\"icon\"\n          secondaryText=\"to view Strava activity\"\n          onClick={() =>\n            (window.location.href = getStravaAuthUrl(\n              Object.fromEntries(\n                new URLSearchParams(window.location.search).entries()\n              )\n            ))\n          }\n        >\n          Authorize Strava App\n        </ListItem>\n      </List>\n    );\n  }\n\n  return (\n    <StravaActivityDetailsWithToken\n      activityId={activityId}\n      token={stravaToken}\n      backButtonText={backButtonText}\n      onBackButtonClick={onBackButtonClick}\n    />\n  );\n}\n\nfunction StravaActivityDetailsWithToken({\n  activityId,\n  token,\n  backButtonText,\n  onBackButtonClick,\n}: Props & { token: string }) {\n  const { result: activity, loading } = useAsync(getStravaActivity, [\n    token,\n    activityId,\n  ]);\n\n  if (!activity) {\n    if (loading) {\n      return (\n        <CircularProgress\n          id={`strava-activity-${activityId}`}\n          circleStyle={{ stroke: \"black\" }}\n        />\n      );\n    } else {\n      return (\n        <List>\n          <SimpleListItem\n            secondaryText=\"Make sure you can access the activity and it was recorded in Zwift.\"\n            threeLines\n          >\n            An error occurred\n          </SimpleListItem>\n        </List>\n      );\n    }\n  }\n\n  return (\n    <List>\n      <SimpleListItem>\n        <Button themeType=\"outline\" onClick={onBackButtonClick}>\n          <TextIconSpacing icon={<ListFontIcon />}>\n            {backButtonText}\n          </TextIconSpacing>\n        </Button>\n      </SimpleListItem>\n\n      <SimpleListItem>\n        <Text type=\"headline-6\" style={{ margin: 0 }}>\n          {activity.name}\n        </Text>\n      </SimpleListItem>\n\n      <SimpleListItem\n        clickable={false}\n        leftAddon={<SpaceBarFontIcon />}\n        leftAddonType=\"icon\"\n      >\n        <Time seconds={activity.time} />\n      </SimpleListItem>\n      <SimpleListItem\n        clickable={false}\n        leftAddon={<SpaceBarFontIcon />}\n        leftAddonType=\"icon\"\n      >\n        <Distance distance={activity.distance} />\n      </SimpleListItem>\n      <SimpleListItem\n        clickable={false}\n        leftAddon={<LandscapeFontIcon />}\n        leftAddonType=\"icon\"\n      >\n        <Elevation elevation={activity.elevation} />\n      </SimpleListItem>\n      <SimpleListItem clickable={false} leftAddon={<MapFontIcon />}>\n        {activity.world.name}\n      </SimpleListItem>\n\n      <ListSubheader>Links</ListSubheader>\n      <ListItem\n        onClick={() =>\n          window.open(\n            `https://www.strava.com/activities/${activity.id}`,\n            \"_blank\"\n          )\n        }\n        leftAddon={\n          <Avatar color=\"#000000\">\n            <img src={stravaLogo} alt=\"\" />\n          </Avatar>\n        }\n        leftAddonType=\"avatar\"\n        rightAddon={<OpenInNewFontIcon />}\n        rightAddonType=\"icon\"\n      >\n        Activity on Strava\n      </ListItem>\n    </List>\n  );\n}\n","import { World } from \"../../../types\";\n\ninterface Props {\n  world: World;\n}\n\nexport function WorldDetails({ world }: Props) {\n    return null;\n}\n","import React from \"react\";\nimport { useLocationState } from \"../../../hooks/useLocationState\";\nimport { RouteDetails } from \"./RouteDetails\";\nimport { StravaActivityDetails } from \"./StravaActivityDetails\";\nimport { WorldDetails } from \"./WorldDetails\";\n\ninterface Props {\n  onMouseHoverDistanceChange: (distance: number | undefined) => void;\n  backButtonText: string;\n  onBackButtonClick: () => void;\n}\n\nexport function Details({\n  onMouseHoverDistanceChange,\n  backButtonText,\n  onBackButtonClick,\n}: Props) {\n  const [locationState] = useLocationState();\n\n  if (locationState.route) {\n    return (\n      <RouteDetails\n        route={locationState.route}\n        onMouseHoverDistanceChange={onMouseHoverDistanceChange}\n        backButtonText={backButtonText}\n        onBackButtonClick={onBackButtonClick}\n      />\n    );\n  } else if (locationState.stravaActivityId) {\n    return (\n      <StravaActivityDetails\n        activityId={locationState.stravaActivityId}\n        backButtonText={backButtonText}\n        onBackButtonClick={onBackButtonClick}\n      />\n    );\n  } else {\n    return <WorldDetails world={locationState.world} />;\n  }\n}\n","import { CircularProgress } from \"@react-md/progress\";\nimport uniqWith from \"lodash/uniqWith\";\nimport React, { useMemo } from \"react\";\nimport { useAsync } from \"react-async-hook\";\nimport { Area, AreaChart, XAxis, YAxis } from \"recharts\";\nimport { getStravaSegmentStreams } from \"../../services/StravaSegmentRepository\";\nimport { Route, StravaSegment } from \"../../types\";\nimport { ElevationGradient } from \"../ElevationGradient\";\n\ninterface Props {\n  route: Route;\n}\n\nconst REQUIRED_STREAMS = [\"altitude\", \"distance\"];\n\nexport function ElevationChartPreview({ route }: Props) {\n  const { result: segment } = useAsync<\n    Pick<StravaSegment, \"altitude\" | \"distance\">\n  >(getStravaSegmentStreams, [route.slug, 'routes', REQUIRED_STREAMS]);\n\n  const data: any[] | undefined = useMemo(() => {\n    if (segment === undefined) {\n      return;\n    }\n\n    const filteredData = uniqWith(\n      segment.distance.map((distance, index) => ({\n        distance: Math.round(distance / 100) / 10,\n        elevation: segment.altitude[index],\n      })),\n      (a, b) => a.distance === b.distance\n    );\n\n    // remove negative elevation\n    const lowestElevation = Math.min(...filteredData.map((d) => d.elevation));\n    return filteredData.map((d) => ({\n      ...d,\n      elevation: d.elevation - lowestElevation,\n    }));\n  }, [segment]);\n\n  if (!data) {\n    return (\n      <CircularProgress\n        id={`elevation-preview-${route.slug}`}\n        small\n        circleStyle={{ stroke: \"black\" }}\n      />\n    );\n  }\n\n  return (\n    <AreaChart\n      height={50}\n      width={100}\n      data={data}\n      // @ts-ignore\n      baseValue=\"dataMin\"\n    >\n      <defs>\n        <ElevationGradient />\n      </defs>\n\n      <XAxis\n        dataKey=\"distance\"\n        type=\"number\"\n        domain={[0, \"dataMax\"]}\n        unit=\"km\"\n        hide={true}\n      />\n\n      <YAxis\n        dataKey=\"elevation\"\n        type=\"number\"\n        allowDecimals={false}\n        domain={[0, 750]}\n        unit=\"m\"\n        hide={true}\n      />\n\n      <Area\n        type=\"monotone\"\n        dataKey=\"elevation\"\n        name=\"Elevation\"\n        stroke=\"black\"\n        fillOpacity={1}\n        fill=\"url(#colorElevation)\"\n        unit=\"m\"\n        isAnimationActive={false}\n      />\n    </AreaChart>\n  );\n}\n","import { ListItem } from \"@react-md/list\";\nimport React, { useRef } from \"react\";\nimport { worlds } from \"../../data\";\nimport { useOnScreen } from \"../../hooks/useOnScreen\";\nimport { Route } from \"../../types\";\nimport { Distance } from \"../Distance\";\nimport { Elevation } from \"../Elevation\";\nimport { ElevationChartPreview } from \"../ElevationChartPreview\";\n\nexport interface Props {\n  route: Route;\n  onClick: () => void;\n  onHoverRoute: (route?: string) => void;\n  showWorldName: boolean;\n}\n\nexport function SearchResultCardRoute({\n  route,\n  onClick,\n  onHoverRoute,\n  showWorldName,\n}: Props) {\n  return (\n    <ListItem\n      secondaryText={<RouteInfo route={route} showWorldName={showWorldName} />}\n      threeLines={showWorldName}\n      onClick={onClick}\n      rightAddonType=\"large-media\"\n      rightAddon={<ChartContainer route={route} />}\n      onMouseEnter={() => onHoverRoute(route.slug)}\n      onMouseLeave={() => onHoverRoute(undefined)}\n    >\n      {route.name}\n    </ListItem>\n  );\n}\n\ninterface RouteInfoProps {\n  route: Route;\n  showWorldName: boolean;\n}\n\nfunction RouteInfo({ route, showWorldName }: RouteInfoProps) {\n  return (\n    <>\n      {showWorldName && (\n        <>\n          {worlds.find((w) => w.slug === route.world)!.name}\n          <br />\n        </>\n      )}\n      <Distance distance={route.distance} /> |{\" \"}\n      <Elevation elevation={route.elevation} />\n    </>\n  );\n}\n\ninterface ChartProps {\n  route: Route;\n}\n\nfunction ChartContainer({ route }: ChartProps) {\n  const ref = useRef<HTMLDivElement | null>(null);\n\n  const onScreen = useOnScreen(ref);\n\n  return (\n    <div ref={ref} style={{ width: \"100%\", pointerEvents: \"none\" }}>\n      {onScreen ? <ElevationChartPreview route={route} /> : null}\n    </div>\n  );\n}\n","import { MutableRefObject, useEffect, useState } from \"react\";\n\n/**\n * @see https://usehooks.com/useOnScreen/\n */\nexport function useOnScreen(ref: MutableRefObject<HTMLElement | null>) {\n  const [isIntersecting, setIntersecting] = useState(false);\n  useEffect(() => {\n    const current = ref.current;\n\n    const observer = new IntersectionObserver(([entry]) => {\n      setIntersecting(entry.isIntersecting);\n    });\n    if (current) {\n      observer.observe(current);\n    }\n    return () => {\n      if (current) {\n        observer.unobserve(current);\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  return isIntersecting;\n}\n","import { Avatar } from \"@react-md/avatar\";\nimport { ListItem, SimpleListItem } from \"@react-md/list\";\nimport { OpenInNewFontIcon } from \"@react-md/material-icons\";\nimport { CircularProgress } from \"@react-md/progress\";\nimport React from \"react\";\nimport { useAsync } from \"react-async-hook\";\nimport stravaLogo from \"../../assets/strava-40x40.png\";\nimport { useLocationState } from \"../../hooks/useLocationState\";\nimport { useStravaToken } from \"../../hooks/useStravaToken\";\nimport { getStravaAuthUrl } from \"../../services/strava\";\nimport { getStravaActivity } from \"../../services/StravaActivityRepository\";\nimport { Distance } from \"../Distance\";\nimport { Elevation } from \"../Elevation\";\nimport { Time } from \"../Time\";\n\nexport interface Props {\n  activity: { activityId: string; slug: string };\n  onHoverRoute: (route?: string) => void;\n}\n\nexport function SearchResultCardStravaActivity({\n  activity,\n  onHoverRoute,\n}: Props) {\n  const [stravaToken] = useStravaToken();\n\n  if (stravaToken === null) {\n    return (\n      <ListItem\n        leftAddon={\n          <Avatar color=\"#ff6b00\">\n            <img src={stravaLogo} alt=\"\" />\n          </Avatar>\n        }\n        leftAddonType=\"avatar\"\n        rightAddon={<OpenInNewFontIcon />}\n        rightAddonType=\"icon\"\n        secondaryText=\"to view Strava activity\"\n        onClick={() =>\n          (window.location.href = getStravaAuthUrl(\n            Object.fromEntries(\n              new URLSearchParams(window.location.search).entries()\n            )\n          ))\n        }\n      >\n        Authorize Strava App\n      </ListItem>\n    );\n  }\n\n  return (\n    <SearchResultCardStravaActivityWithToken\n      activity={activity}\n      onHoverRoute={onHoverRoute}\n      token={stravaToken}\n    />\n  );\n}\n\nfunction SearchResultCardStravaActivityWithToken({\n  activity: { activityId },\n  onHoverRoute,\n  token,\n}: Props & { token: string }) {\n  const { result: activity, loading } = useAsync(getStravaActivity, [\n    token,\n    activityId,\n  ]);\n  const [, setLocationState] = useLocationState();\n\n  if (!activity) {\n    if (loading) {\n      return (\n        <CircularProgress\n          id={`strava-activity-${activityId}`}\n          circleStyle={{ stroke: \"black\" }}\n        />\n      );\n    } else {\n      return (\n        <SimpleListItem\n          secondaryText=\"Make sure you can access the activity and it was recorded in Zwift.\"\n          threeLines\n        >\n          An error occurred\n        </SimpleListItem>\n      );\n    }\n  }\n\n  const handleClick = () => {\n    setLocationState({\n      world: activity.world,\n      stravaActivityId: activity.id,\n      segments: [],\n      query: \"\",\n    });\n  };\n\n  return (\n    <ListItem\n      onClick={handleClick}\n      secondaryText={\n        <>\n          <Distance distance={activity.distance} /> |{\" \"}\n          <Elevation elevation={activity.elevation} />\n          <br />\n          {activity.avgWatts && <>{Math.round(activity.avgWatts)}W | </>}\n          <Time seconds={activity.time} />\n        </>\n      }\n      threeLines\n      rightAddonType={activity.photoUrl ? \"large-media\" : undefined}\n      rightAddon={\n        activity.photoUrl ? (\n          <img src={activity.photoUrl} alt=\"\" width=\"100\" />\n        ) : undefined\n      }\n    >\n      {activity.name}\n    </ListItem>\n  );\n}\n","import { ListItem } from \"@react-md/list\";\nimport { routes, segments } from \"../../data\";\nimport { useSettings } from \"../../hooks/useSettings\";\nimport { World } from \"../../types\";\n\nexport interface Props {\n  world: World;\n  onClick: () => void;\n}\n\nexport function SearchResultCardWorld({ world, onClick }: Props) {\n  const [settings] = useSettings();\n  const secondaryText = `${\n    routes\n      .filter((r) => r.sports.includes(settings.sport))\n      .filter((r) => r.world === world.slug).length\n  } routes | ${segments.filter((s) => s.world === world.slug).length} segments`;\n\n  return (\n    <ListItem secondaryText={secondaryText} onClick={onClick}>\n      {world.name}\n    </ListItem>\n  );\n}\n","import { Divider } from \"@react-md/divider\";\nimport { ListSubheader, SimpleListItem } from \"@react-md/list\";\nimport React, { Fragment } from \"react\";\nimport { SearchResult, searchResultTypes } from \"../../services/search\";\nimport { SearchResultCardRoute } from \"./SearchResultCardRoute\";\nimport { SearchResultCardStravaActivity } from \"./SearchResultCardStravaActivity\";\nimport { SearchResultCardWorld } from \"./SearchResultCardWorld\";\n\ninterface Props {\n  searchResults: ReadonlyArray<SearchResult>;\n  onResultClick: (searchResult: SearchResult) => void;\n  onHoverRoute: (route?: string) => void;\n}\n\nexport function SearchResultList({\n  searchResults,\n  onResultClick,\n  onHoverRoute,\n}: Props) {\n  if (searchResults.length === 0) {\n    return <SimpleListItem>No worlds or routes found</SimpleListItem>;\n  }\n\n  return (\n    <>\n      {searchResults.map((searchResult, i) => (\n        <Fragment key={searchResult.data.slug}>\n          {searchResults[i - 1]?.type !== searchResult.type && (\n            <>\n              {searchResults[i - 1] && <Divider />}\n              <ListSubheader>\n                {searchResultTypes[searchResult.type].title}\n              </ListSubheader>\n            </>\n          )}\n          <SearchResultCard\n            searchResult={searchResult}\n            onClick={() => onResultClick(searchResult)}\n            onHoverRoute={onHoverRoute}\n          />\n        </Fragment>\n      ))}\n    </>\n  );\n}\n\ninterface SearchResultCardProps {\n  searchResult: SearchResult;\n  onClick: () => void;\n  onHoverRoute: (route?: string) => void;\n}\n\nfunction SearchResultCard({\n  searchResult,\n  onClick,\n  onHoverRoute,\n}: SearchResultCardProps) {\n  switch (searchResult.type) {\n    case \"world\":\n      return (\n        <SearchResultCardWorld world={searchResult.data} onClick={onClick} />\n      );\n    case \"route\":\n      return (\n        <SearchResultCardRoute\n          route={searchResult.data}\n          onClick={onClick}\n          onHoverRoute={onHoverRoute}\n          showWorldName={true}\n        />\n      );\n    case \"strava-activity\":\n      return (\n        <SearchResultCardStravaActivity\n          activity={searchResult.data}\n          onHoverRoute={onHoverRoute}\n        />\n      );\n    default:\n      return null;\n  }\n}\n","import { Button } from \"@react-md/button\";\nimport { Divider } from \"@react-md/divider\";\nimport { TextField } from \"@react-md/form\";\nimport { FontIcon } from \"@react-md/icon\";\nimport { List, ListItem, SimpleListItem } from \"@react-md/list\";\nimport {\n  KeyboardArrowDownFontIcon,\n  KeyboardArrowUpFontIcon,\n  SettingsFontIcon,\n} from \"@react-md/material-icons\";\nimport c from \"classnames\";\nimport React, { useRef, useState } from \"react\";\nimport { routes, worlds } from \"../../data\";\nimport { useLocationState } from \"../../hooks/useLocationState\";\nimport { useSettings } from \"../../hooks/useSettings\";\nimport { search, SearchResult } from \"../../services/search\";\nimport { SettingsDialog } from \"../SettingsDialog\";\nimport { Details } from \"./Details\";\nimport styles from \"./index.module.scss\";\nimport { SearchResultCardRoute } from \"./SearchResultCardRoute\";\nimport { SearchResultList } from \"./SearchResultList\";\n\ninterface Props {\n  onMouseHoverDistanceChange: (distance: number | undefined) => void;\n  onHoverRoute: (previewRoute: string | undefined) => void;\n}\n\nexport function Sidebar({ onMouseHoverDistanceChange, onHoverRoute }: Props) {\n  const [bottomSheetOpen, setBottomSheetOpen] = useState(false);\n  const [locationState, setLocationState] = useLocationState();\n  const [settings] = useSettings();\n  const containerRef = useRef<HTMLDivElement | null>(null);\n\n  const [settingsDialogVisible, setSettingsDialogVisible] = useState(false);\n\n  const searchResults = search(locationState.query, settings.sport);\n\n  const handleSearchResultClick = (searchResult: SearchResult) => {\n    switch (searchResult.type) {\n      case \"world\":\n        setLocationState({\n          world: searchResult.data,\n          segments: [],\n          query: \"\",\n        });\n        break;\n      case \"route\":\n        setLocationState({\n          world: worlds.find((w) => w.slug === searchResult.data.world)!,\n          route: searchResult.data,\n          segments: [],\n          query: locationState.query,\n        });\n        break;\n    }\n  };\n\n  return (\n    <>\n      <div\n        className={c(styles.Container, {\n          [styles.BottomSheetOpen]: bottomSheetOpen,\n        })}\n        ref={containerRef}\n      >\n        <button\n          className={styles.DragHandle}\n          onClick={() => setBottomSheetOpen(false)}\n        >\n          <KeyboardArrowDownFontIcon />\n        </button>\n        <List className={styles.SearchBox}>\n          <SimpleListItem>\n            <TextField\n              id=\"search-input\"\n              style={{ width: \"100%\" }}\n              placeholder=\"Search for worlds and routes\"\n              value={locationState.query}\n              onChange={(e) => {\n                setLocationState({\n                  world: locationState.world,\n                  segments: [],\n                  query: e.target.value,\n                });\n              }}\n              isRightAddon={false}\n              rightChildren={\n                locationState.query !== \"\" && (\n                  <Button\n                    buttonType=\"icon\"\n                    style={{ right: 0, position: \"absolute\" }}\n                    onClick={() => {\n                      setLocationState({ ...locationState, query: \"\" });\n                    }}\n                    aria-label=\"Clear search field\"\n                  >\n                    <FontIcon>clear</FontIcon>\n                  </Button>\n                )\n              }\n            />\n          </SimpleListItem>\n          <Divider className={styles.NoGapDivider} />\n        </List>\n        <div className={styles.Content}>\n          {locationState.route || locationState.stravaActivityId ? (\n            <Details\n              onMouseHoverDistanceChange={onMouseHoverDistanceChange}\n              backButtonText={\n                locationState.query === \"\"\n                  ? \"Back to route list\"\n                  : \"Back to search results\"\n              }\n              onBackButtonClick={() => {\n                setLocationState({\n                  world: locationState.world,\n                  segments: [],\n                  query: locationState.query,\n                });\n              }}\n            />\n          ) : (\n            <List>\n              {locationState.query === \"\" ? (\n                <>\n                  {routes\n                    .filter((route) => route.world === locationState.world.slug)\n                    .filter((route) => route.sports.includes(settings.sport))\n                    .filter((route) => route.stravaSegmentId !== undefined)\n                    .sort((a, b) => a.name.localeCompare(b.name))\n                    .map((route) => (\n                      <SearchResultCardRoute\n                        route={route}\n                        key={route.slug}\n                        onClick={() => {\n                          onHoverRoute(undefined);\n                          setLocationState({\n                            world: worlds.find((w) => w.slug === route.world)!,\n                            route,\n                            segments: [],\n                            query: locationState.query,\n                          });\n                        }}\n                        onHoverRoute={onHoverRoute}\n                        showWorldName={false}\n                      />\n                    ))}\n                </>\n              ) : (\n                <SearchResultList\n                  searchResults={searchResults}\n                  onResultClick={handleSearchResultClick}\n                  onHoverRoute={onHoverRoute}\n                />\n              )}\n            </List>\n          )}\n        </div>\n        <List className={styles.BottomMenu}>\n          <Divider className={styles.NoGapDivider} />\n          <ListItem\n            onClick={() => {\n              setBottomSheetOpen(false);\n              setSettingsDialogVisible(true);\n            }}\n            leftAddon={<SettingsFontIcon />}\n            leftAddonType=\"icon\"\n          >\n            Settings\n          </ListItem>\n        </List>\n      </div>\n\n      <button\n        className={c(styles.DragHandle, styles.DragHandleBottom, {\n          [styles.BottomSheetOpen]: bottomSheetOpen,\n        })}\n        onClick={() => setBottomSheetOpen(true)}\n      >\n        <KeyboardArrowUpFontIcon />\n      </button>\n\n      <SettingsDialog\n        visible={settingsDialogVisible}\n        onClose={() => setSettingsDialogVisible(false)}\n      />\n    </>\n  );\n}\n","import { Select } from \"@react-md/form\";\nimport React from \"react\";\nimport { worlds } from \"../../data\";\nimport { useLocationState } from \"../../hooks/useLocationState\";\nimport styles from \"./WorldSelect.module.scss\";\n\nconst options = [...worlds]\n  .sort((a, b) => a.name.localeCompare(b.name))\n  .map((world) => ({\n    label: world.name,\n    value: world.slug,\n  }));\n\nexport function WorldSelect() {\n  const [locationState, setLocationState] = useLocationState();\n\n  return (\n    <div className={styles.Container}>\n      <Select\n        id=\"world-select\"\n        options={options}\n        value={locationState.world.slug}\n        listboxStyle={{ zIndex: 3000 }}\n        onChange={(newWorldSlug) =>\n          setLocationState({\n            ...locationState,\n            world: worlds.find((w) => w.slug === newWorldSlug)!,\n            route: undefined,\n            segments: [],\n          })\n        }\n      />\n    </div>\n  );\n}\n","import { LatLngBounds, LatLngExpression, Map } from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { useAsync } from \"react-async-hook\";\nimport {\n  Circle,\n  ImageOverlay,\n  MapContainer,\n  Pane,\n  Polyline,\n} from \"react-leaflet\";\nimport { useLocationState } from \"../../hooks/useLocationState\";\nimport { useStravaToken } from \"../../hooks/useStravaToken\";\nimport { getStravaActivity } from \"../../services/StravaActivityRepository\";\nimport {\n  getStravaSegmentStream,\n  getStravaSegmentStreams,\n} from \"../../services/StravaSegmentRepository\";\nimport { Route, Segment } from \"../../types\";\nimport { worldConfigs } from \"../../worldConfig\";\nimport styles from \"./index.module.css\";\nimport { WorldSelect } from \"./WorldSelect\";\n\ninterface Props {\n  mouseHoverDistance: number | undefined;\n  previewRoute?: string;\n}\n\nexport default function RouteMap({ mouseHoverDistance, previewRoute }: Props) {\n  const [locationState] = useLocationState();\n  const world = locationState.world;\n  const worldConfig = worldConfigs[world.slug];\n\n  const { result: stravaSegmentsToShow } = useAsync(\n    async (fs: Segment[]) => {\n      const stravaSegments = await Promise.all(\n        fs.map((s) => getStravaSegmentStream(s.slug, \"segments\", \"latlng\"))\n      );\n      return fs.map((s, i) => ({\n        ...s,\n        stravaData: stravaSegments[i],\n      }));\n    },\n    [locationState.segments]\n  );\n\n  const [map, setMap] = useState<Map | undefined>();\n  useEffect(() => {\n    map?.zoomControl.setPosition(\"topright\");\n  }, [map]);\n\n  const { result: routeStravaSegment } = useAsync(\n    async (r?: Route) => {\n      if (r === undefined) {\n        return;\n      }\n\n      return await getStravaSegmentStreams(r.slug, \"routes\", [\n        \"distance\",\n        \"latlng\",\n      ]);\n    },\n    [locationState.route]\n  );\n\n  const [stravaToken] = useStravaToken();\n  const { result: stravaActivity } = useAsync(\n    async (token: string | null, activityId: string | undefined) => {\n      if (token === null || activityId === undefined) {\n        return;\n      }\n      return await getStravaActivity(token, activityId);\n    },\n    [stravaToken, locationState.stravaActivityId]\n  );\n\n  const { result: previewRouteStravaSegment } = useAsync(\n    async (r: string | undefined) => {\n      if (r === undefined) {\n        return;\n      }\n\n      return await getStravaSegmentStreams(r, \"routes\", [\"latlng\"]);\n    },\n    [previewRoute]\n  );\n\n  useEffect(() => {\n    if (!map || !routeStravaSegment) {\n      return;\n    }\n\n    const bounds = routeStravaSegment.latlng.reduce(\n      (bounds, coord) => bounds.extend(coord),\n      new LatLngBounds(\n        routeStravaSegment.latlng[0],\n        routeStravaSegment.latlng[0]\n      )\n    );\n\n    map.invalidateSize();\n    map.fitBounds(bounds);\n  }, [map, routeStravaSegment, worldConfig]);\n\n  useEffect(() => {\n    if (!map || !locationState) {\n      return;\n    }\n\n    const worldConfig = worldConfigs[locationState.world.slug];\n\n    map.invalidateSize();\n    map.setMaxBounds(worldConfig.imageBounds);\n\n    const minZoom = map.getBoundsZoom(worldConfig.imageBounds, false);\n    map.setMinZoom(minZoom);\n\n    if (!locationState.route) {\n      map.fitBounds(worldConfig.initialBounds);\n    }\n  }, [map, locationState]);\n\n  const pointCoordinates = useMemo<LatLngExpression | undefined>(() => {\n    if (!routeStravaSegment || !mouseHoverDistance) {\n      return;\n    }\n\n    const pointIndex = routeStravaSegment.distance.findIndex(\n      (d) => d > mouseHoverDistance\n    );\n    if (!pointIndex) {\n      return;\n    }\n    return routeStravaSegment.latlng[pointIndex];\n  }, [routeStravaSegment, mouseHoverDistance]);\n\n  return (\n    <div className={styles.Container}>\n      <WorldSelect />\n      <MapContainer\n        key={locationState.world.slug}\n        whenCreated={(map) => setMap(map)}\n        bounds={worldConfig.imageBounds}\n        style={{ backgroundColor: worldConfig.backgroundColor }}\n        maxZoom={19}\n        className={styles.MapContainer}\n      >\n        <ImageOverlay\n          url={worldConfig.image}\n          bounds={worldConfig.imageBounds}\n          attribution='&amp;copy <a href=\"https://zwift.com\" rel=\"noreferrer noopener\">Zwift</a>'\n        />\n\n        {previewRouteStravaSegment && (\n          <Pane name=\"preview-route\">\n            <Polyline\n              positions={previewRouteStravaSegment.latlng}\n              pathOptions={{ color: \"#D3D3D3\", weight: 5 }}\n            />\n          </Pane>\n        )}\n\n        {routeStravaSegment && (\n          <Pane name=\"route\">\n            <Polyline\n              positions={routeStravaSegment.latlng}\n              pathOptions={{ color: \"#fc6719\", weight: 5 }}\n            />\n          </Pane>\n        )}\n\n        {stravaActivity && (\n          <Pane name=\"strava-activity\">\n            <Polyline\n              positions={stravaActivity.streams.latlng}\n              pathOptions={{ color: \"#fc6719\", weight: 5 }}\n            />\n          </Pane>\n        )}\n\n        {stravaSegmentsToShow && (\n          <Pane name=\"segments\">\n            {stravaSegmentsToShow?.map((s) => (\n              <Polyline\n                key={s.slug}\n                positions={s.stravaData}\n                pathOptions={{ color: \"#64ac39\", weight: 8 }}\n              />\n            ))}\n          </Pane>\n        )}\n\n        {pointCoordinates && (\n          <Pane name=\"mouse-position\">\n            <Circle\n              center={pointCoordinates}\n              radius={10}\n              pathOptions={{\n                color: \"black\",\n                fillColor: \"black\",\n                fillOpacity: 1,\n              }}\n            />\n          </Pane>\n        )}\n      </MapContainer>\n    </div>\n  );\n}\n","import React, { useState } from \"react\";\nimport styles from \"./App.module.scss\";\nimport { Sidebar } from \"./components/Sidebar\";\nimport RouteMap from \"./components/RouteMap\";\nimport { useStravaTokenListener } from \"./hooks/useStravaTokenListener\";\n\nexport default function App() {\n  useStravaTokenListener();\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const [mouseHoverDistance, setMouseHoverDistance] =\n    useState<number | undefined>(undefined);\n\n  const [previewRoute, setPreviewRoute] = useState<string | undefined>();\n\n  return (\n    <div className={styles.Wrapper}>\n      <Sidebar\n        onMouseHoverDistanceChange={setMouseHoverDistance}\n        onHoverRoute={setPreviewRoute}\n      />\n      <RouteMap\n        mouseHoverDistance={mouseHoverDistance}\n        previewRoute={previewRoute}\n      />\n    </div>\n  );\n}\n","import { useCallback, useEffect } from \"react\";\nimport { useStravaToken } from \"./useStravaToken\";\n\nexport function useStravaTokenListener(): void {\n  const [, setStravaToken] = useStravaToken();\n\n  const updateStravaToken = useCallback(() => {\n    const params = new URLSearchParams(window.location.search);\n\n    if (params.has(\"strava-access-token\")) {\n      setStravaToken(params.get(\"strava-access-token\")!);\n\n      params.delete(\"strava-access-token\");\n      window.history.pushState(\n        undefined,\n        \"\",\n        `${window.location.origin}${\n          window.location.pathname\n        }?${params.toString()}`\n      );\n    }\n  }, [setStravaToken]);\n\n  useEffect(() => {\n    updateStravaToken();\n  }, [updateStravaToken]);\n\n  useEffect(() => {\n    window.addEventListener(\"popstate\", updateStravaToken);\n    return () => window.removeEventListener(\"popstate\", updateStravaToken);\n  }, [updateStravaToken]);\n}\n","import \"./index.scss\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"app\")\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Container\":\"Sidebar_Container__3o0kK\",\"BottomSheetOpen\":\"Sidebar_BottomSheetOpen__22Bgs\",\"SearchBox\":\"Sidebar_SearchBox__3wlGX\",\"Content\":\"Sidebar_Content__15Hau\",\"BottomMenu\":\"Sidebar_BottomMenu__2Obmz\",\"NoGapDivider\":\"Sidebar_NoGapDivider__20DmD\",\"DragHandle\":\"Sidebar_DragHandle__l0Son\",\"DragHandleBottom\":\"Sidebar_DragHandleBottom__1sHmD\"};"],"sourceRoot":""}