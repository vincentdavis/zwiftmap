(this["webpackJsonpzwiftmap-frontend"]=this["webpackJsonpzwiftmap-frontend"]||[]).push([[0],{175:function(e,t,n){e.exports={Container:"RouteMap_Container__1kS2N",MapContainer:"RouteMap_MapContainer__1oyLk",navigationControl:"RouteMap_navigationControl__2RyF3"}},230:function(e,t,n){e.exports={Wrapper:"App_Wrapper__2vPXK"}},233:function(e,t,n){e.exports={Container:"WorldSelect_Container__3BQ6b"}},253:function(e,t,n){e.exports={Dialog:"InfoDialog_Dialog__3j2NL"}},430:function(e,t,n){},431:function(e,t,n){"use strict";n.r(t);var r=n(482),a=n(255),i=n(0),c=n.n(i),o=n(39),s=n.n(o),A=n(5),u=n(230),l=n.n(u),d=n(10),j=n.n(d),b=n(13),f=n(20),p=n(40),g=(n(276),n(31)),h=n(448),O=n(493),v=n(488),m=n(449),x=n(494),w=n(133),y="strava-auth",k=Object(w.a)();function C(e,t){null===t?localStorage.removeItem(e):localStorage.setItem(e,t),k.emit(e,t)}function D(e){return localStorage.getItem(e)}function B(){var e=Object(i.useState)((function(){return null!==D(y)})),t=Object(A.a)(e,2),n=t[0],r=t[1];return Object(i.useEffect)((function(){!function(e,t){var n=function(e){return t(e)};k.on(e,n)}(y,(function(e){return r(null!==e)}))}),[]),n}window.addEventListener("storage",(function(e){e.key&&k.emit(e.key,e.newValue)}));var S=n(25),I=S.c.find((function(e){return"watopia"===e.slug}));function M(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location,n=t.search,r=t.pathname,a=new URLSearchParams(n),i=E({searchParams:a,pathname:r}),c=null!==(e=a.get("q"))&&void 0!==e?e:"";if(a.has("route")){var o,s=S.a.filter((function(e){return e.world===(null===i||void 0===i?void 0:i.slug)})).find((function(e){return e.slug===a.get("route")})),A=(null!==(o=a.get("segments"))&&void 0!==o?o:"").split(",").map((function(e){return S.b.find((function(t){return t.slug===e}))})).filter((function(e){return!!e}));return s?{world:i,query:c,type:"route",route:s,segments:A}:{world:i,query:c,type:"default"}}return a.has("strava-activities")?{world:i,query:c,type:"strava-activities"}:a.has("strava-activity")?{world:i,query:c,type:"strava-activity",stravaActivityId:a.get("strava-activity")}:{world:i,query:c,type:"default"}}function E(e){var t,n=e.searchParams,r=e.pathname.split("/").slice(1),a=S.c.find((function(e){return e.slug===r[0]})),i=S.c.find((function(e){return e.slug===n.get("world")}));return null!==(t=null!==a&&void 0!==a?a:i)&&void 0!==t?t:I}var T=[];function F(){var e=Object(i.useState)(M),t=Object(A.a)(e,2),n=t[0],r=t[1];Object(i.useEffect)((function(){var e=function(){return r(M())};return window.addEventListener("popstate",e),function(){return window.removeEventListener("popstate",e)}}),[]),Object(i.useEffect)((function(){var e=function(e){return r(e)};return T.push(e),function(){T.splice(T.indexOf(e),1)}}),[]);var a=Object(i.useCallback)((function(e){var t=function(e){var t="/".concat(e.world.slug),n=new URLSearchParams;switch(e.type){case"default":break;case"route":n.set("route",e.route.slug),e.segments.length>0&&n.set("segments",e.segments.map((function(e){return e.slug})).join(","));break;case"strava-activities":n.set("strava-activities","");break;case"strava-activity":n.set("strava-activity",e.stravaActivityId)}e.query.length>0&&n.set("q",e.query);var r=n.toString();return""===r?t:"".concat(t,"?").concat(r)}(e);window.history.pushState(void 0,"",t),r(e),T.forEach((function(t){return t(e)}))}),[]);return[n,a]}var Q={bologna:{imageBounds:[[44.5308037,11.26261748],[44.45463821,11.36991729102076]],initialBounds:[[44.501423,11.294653],[44.478222,11.341099]],image:n.p+"static/media/bologna.6f13d4d4.png",backgroundColor:"#b9b9b8"},"crit-city":{imageBounds:[[-10.3657,165.7824],[-10.4038,165.8207]],initialBounds:[[-10.382352,165.798758],[-10.386016,165.803496]],image:n.p+"static/media/crit-city.3bab2d0f.png",backgroundColor:"#7c9938"},france:{imageBounds:[[-21.64155,166.1384],[-21.7564,166.26125]],initialBounds:[[-21.697812,166.148225],[-21.744906,166.202642]],image:n.p+"static/media/france.aded90ff.png",backgroundColor:"#6f992d"},innsbruck:{imageBounds:[[47.2947,11.3501],[47.2055,11.4822]],initialBounds:[[47.280902,11.386414],[47.214544,11.445934]],image:n.p+"static/media/innsbruck.9821ed90.png",backgroundColor:"#7c9938"},london:{imageBounds:[[51.5362,-.1776],[51.4601,-.0555]],initialBounds:[[51.511261,-.134875],[51.489256,-.072996]],image:n.p+"static/media/london.54ae112e.png",backgroundColor:"#6f992d"},"makuri-islands":{imageBounds:[[-10.73746,165.80468],[-10.81405,165.88222]],initialBounds:[[-10.743702,165.830083],[-10.775156,165.859212]],image:n.p+"static/media/makuri-islands.5fe6bee4.png",backgroundColor:"#7c9938"},"new-york":{imageBounds:[[40.81725,-74.0227],[40.74085,-73.9222]],initialBounds:[[40.799618,-73.982068],[40.763547,-73.949602]],image:n.p+"static/media/new-york.5bf9b5e8.png",backgroundColor:"#bbbbb7"},paris:{imageBounds:[[48.9058,2.2561],[48.82945,2.3722]],initialBounds:[[48.874328,2.294207],[48.860895,2.331992]],image:n.p+"static/media/paris.d1eaa520.png",backgroundColor:"#b9b9b9"},richmond:{imageBounds:[[37.5774,-77.48954],[37.5014,-77.394]],initialBounds:[[37.558393,-77.467668],[37.520429,-77.415864]],image:n.p+"static/media/richmond.72df812b.png",backgroundColor:"#7c9938"},watopia:{imageBounds:[[-11.62597,166.87747],[-11.70255,167.03255]],initialBounds:[[-11.635444,166.93555],[-11.673613,166.972511]],image:n.p+"static/media/watopia.0901a23e.png",backgroundColor:"#0884e2"},yorkshire:{imageBounds:[[54.0254,-1.632],[53.9491,-1.5022]],initialBounds:[[53.999691,-1.592961],[53.974875,-1.539474]],image:n.p+"static/media/yorkshire.b83235cf.png",backgroundColor:"#7c9938"}};function R(e){if(null!==e.start_latlng)return S.c.find((function(t){var n=Q[t.slug].imageBounds;return n[0][0]>=e.start_latlng[0]&&e.start_latlng[0]>=n[1][0]&&n[0][1]<=e.start_latlng[1]&&e.start_latlng[1]<=n[1][1]}))}var U=n(32),H=n(46),L=n.n(H);function N(){var e=D(y);return null===e?null:JSON.parse(e)}function W(e){C(y,JSON.stringify(e))}function z(){return P.apply(this,arguments)}function P(){return(P=Object(f.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=N()){e.next=3;break}return e.abrupt("return");case 3:return C(y,null),e.prev=4,e.next=7,L.a.post("https://www.strava.com/oauth/deauthorize",void 0,{params:{access_token:t.access_token}});case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:case"end":return e.stop()}}),e,null,[[4,9]])})))).apply(this,arguments)}function G(){window.location.href=function(e){var t=new URLSearchParams;return t.set("state",JSON.stringify(e)),"".concat("https://api.zwiftmap.com","/strava/authorize?").concat(t.toString())}(Object.fromEntries(new URLSearchParams(window.location.search).entries()))}function J(e){return Y.apply(this,arguments)}function Y(){return(Y=Object(f.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat("https://api.zwiftmap.com","/strava/refresh"),e.next=3,L.a.post(n,{refresh_token:t});case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Z=n(231),V=n(232);function X(e){return JSON.stringify({url:e.url,params:e.params})}function q(){var e=new $,t=function(){var t=Object(f.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=X(n),"get"!==n.method){t.next=11;break}if(!e.hasResponse(r)){t.next=10;break}return n.headers=Object(b.a)(Object(b.a)({},n.headers),{},{cached:"true"}),t.next=6,e.getResponse(r);case 6:throw n.data=t.sent,n;case 10:e.prepareResponse(r);case 11:return t.abrupt("return",n);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return{request:t,response:[function(t){var n;return"get"===(null===(n=t.config.method)||void 0===n?void 0:n.toLocaleLowerCase())&&e.storeResponse(X(t.config),t.data),t},function(e){return"true"===e.headers.cached?Promise.resolve(e):Promise.reject(e)}]}}var K,_,$=function(){function e(){Object(Z.a)(this,e),this.store={},this.emitter=Object(w.a)()}return Object(V.a)(e,[{key:"prepareResponse",value:function(e){var t=this;this.store[e]=new Promise((function(n){t.emitter.on(e,(function r(a){t.emitter.off(e,r),n(a)}))}))}},{key:"storeResponse",value:function(e,t){this.emitter.emit(e,t)}},{key:"hasResponse",value:function(e){return void 0!==this.store[e]}},{key:"getResponse",value:function(e){return this.hasResponse(e)?this.store[e]:Promise.reject()}}]),e}(),ee=n(69),te=n.n(ee),ne=q(),re=L.a.create({baseURL:"https://www.strava.com/api/v3"});function ae(e){return ie.apply(this,arguments)}function ie(){return(ie=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.get("/activities/".concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e){return oe.apply(this,arguments)}function oe(){return(oe=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.get("/activities/".concat(t,"/streams"),{params:{keys:["distance","latlng","time","altitude","wattage","velocity_smooth","watts","cadence","heartrate"].join(","),key_by_type:!0}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e){return Ae.apply(this,arguments)}function Ae(){return(Ae=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.get("/segments/".concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(){return le.apply(this,arguments)}function le(){return le=Object(f.a)(j.a.mark((function e(){var t,n,r=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},e.next=3,re.get("/athlete/activities",{params:t});case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)}))),le.apply(this,arguments)}function de(e){return je.apply(this,arguments)}function je(){return(je=Object(f.a)(j.a.mark((function e(t){var n,r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae(t);case 2:if(r=e.sent,a=R(r)){e.next=6;break}throw new Error("Activity was not recorded in Zwift");case 6:return e.t0=r.id.toString(),e.t1=r.name,e.t2=r.athlete.id.toString(),e.t3=r.distance/1e3,e.t4=r.total_elevation_gain,e.t5=r.moving_time,e.t6=a,e.t7=r.average_watts,e.t8=null===(n=r.photos.primary)||void 0===n?void 0:n.urls[100],e.next=17,be(t);case 17:return e.t9=e.sent,e.abrupt("return",{id:e.t0,name:e.t1,athleteId:e.t2,distance:e.t3,elevation:e.t4,time:e.t5,world:e.t6,avgWatts:e.t7,photoUrl:e.t8,streams:e.t9});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e){return fe.apply(this,arguments)}function fe(){return(fe=Object(f.a)(j.a.mark((function e(t){var n,r,a,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(t);case 2:return i=e.sent,e.abrupt("return",{altitude:i.altitude.data,cadence:null===(n=i.cadence)||void 0===n?void 0:n.data,distance:i.distance.data,heartrate:null===(r=i.heartrate)||void 0===r?void 0:r.data,latlng:i.latlng.data,time:i.time.data,velocity:i.velocity_smooth.data,watts:null===(a=i.watts)||void 0===a?void 0:a.data});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}re.interceptors.request.use(ne.request),(K=re.interceptors.response).use.apply(K,Object(U.a)(ne.response)),re.interceptors.request.use(function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=N())){e.next=16;break}if(!(n.expires_at<Math.round(Date.now()/1e3))){e.next=15;break}return e.prev=3,e.next=6,J(n.refresh_token);case 6:W(n=e.sent),e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(3),e.next=14,z();case 14:return e.abrupt("return",t);case 15:t.headers=Object(b.a)(Object(b.a)({},t.headers),{},{Authorization:"".concat(n.token_type," ").concat(n.access_token)});case 16:return e.abrupt("return",t);case 17:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}()),re.interceptors.response.use(te.a,function(){var e=Object(f.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z();case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var pe=q(),ge=L.a.create();function he(e,t,n){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(f.a)(j.a.mark((function e(t,n,r){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge.get("".concat(n,"/").concat(t,"/").concat(r,".json"));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ve(e,t,n){return me.apply(this,arguments)}function me(){return(me=Object(f.a)(j.a.mark((function e(t,n,r){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(r.map((function(e){return he(t,n,e)})));case 2:return a=e.sent,e.abrupt("return",Object.fromEntries(r.map((function(e,t){return[e,a[t]]}))));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}ge.interceptors.request.use(pe.request),(_=ge.interceptors.response).use.apply(_,Object(U.a)(pe.response));var xe=n(175),we=n.n(xe),ye=n(487),ke=n(233),Ce=n.n(ke),De=n(1),Be=Object(U.a)(S.c).sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return{label:e.name,value:e.slug}}));function Se(){var e=F(),t=Object(A.a)(e,2),n=t[0],r=t[1];return Object(De.jsx)("div",{className:Ce.a.Container,children:Object(De.jsx)(ye.a,{id:"world-select",options:Be,value:n.world.slug,listboxStyle:{zIndex:3e3},onChange:function(e){r({world:S.c.find((function(t){return t.slug===e})),query:"",type:"default"})}})})}function Ie(e){var t=e.mouseHoverDistance,n=e.previewRoute,r=F(),a=Object(A.a)(r,1)[0],c=a.world,o=Q[c.slug],s=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("route"===t.type){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,Promise.all(t.segments.map((function(e){return he(e.slug,"segments","latlng")})));case 4:return n=e.sent,e.abrupt("return",t.segments.map((function(e,t){return Object(b.a)(Object(b.a)({},e),{},{stravaData:n[t]})})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[a]),u=s.result,l=Object(i.useState)(),d=Object(A.a)(l,2),w=d[0],y=d[1];Object(i.useEffect)((function(){null===w||void 0===w||w.zoomControl.setPosition("topright")}),[w]);var k=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("route"===t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,ve(n.slug,"routes",["distance","latlng"]);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[a.type,a.route]),C=k.result,D=B(),S=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&"strava-activity"===n.type){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,de(n.stravaActivityId);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[D,a]),I=S.result,M=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,ve(t,"routes",["latlng"]);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n]),E=M.result;Object(i.useEffect)((function(){if(w&&C){var e=C.latlng.reduce((function(e,t){return e.extend(t)}),new p.LatLngBounds(C.latlng[0],C.latlng[0]));w.invalidateSize(),w.fitBounds(e)}}),[w,C,o]),Object(i.useEffect)((function(){if(w){var e=Q[a.world.slug];w.invalidateSize(),w.setMaxBounds(e.imageBounds);var t=w.getBoundsZoom(e.imageBounds,!1);w.setMinZoom(t),"route"!==a.type&&w.fitBounds(e.initialBounds)}}),[w,a.world,a.type]);var T=Object(i.useMemo)((function(){if(C&&t){var e=C.distance.findIndex((function(e){return e>1e3*t}));if(e)return C.latlng[e]}}),[C,t]);return Object(De.jsxs)("div",{className:we.a.Container,children:[Object(De.jsx)(Se,{}),Object(De.jsxs)(h.a,{whenCreated:function(e){return y(e)},bounds:o.imageBounds,style:{backgroundColor:o.backgroundColor},maxZoom:19,className:we.a.MapContainer,children:[Object(De.jsx)(O.a,{url:o.image,bounds:o.imageBounds,attribution:'&copy <a href="https://zwift.com" rel="noreferrer noopener">Zwift</a>'}),E&&Object(De.jsx)(v.a,{name:"preview-route",style:{zIndex:506},children:Object(De.jsx)(m.a,{positions:E.latlng,pathOptions:{color:"#D3D3D3",weight:5}})}),C&&Object(De.jsx)(v.a,{name:"route",style:{zIndex:504},children:Object(De.jsx)(m.a,{positions:C.latlng,pathOptions:{color:"#fc6719",weight:5}})}),I&&Object(De.jsx)(v.a,{name:"strava-activity",style:{zIndex:504},children:Object(De.jsx)(m.a,{positions:I.streams.latlng,pathOptions:{color:"#fc6719",weight:5}})}),u&&Object(De.jsx)(v.a,{name:"segments",style:{zIndex:505},children:null===u||void 0===u?void 0:u.map((function(e){return Object(De.jsx)(m.a,{positions:e.stravaData,pathOptions:{color:"#64ac39",weight:8}},e.slug)}))}),T&&Object(De.jsx)(v.a,{name:"mouse-position",style:{zIndex:507},children:Object(De.jsx)(x.a,{center:T,radius:15,pathOptions:{color:"black",fillColor:"black",fillOpacity:1}})})]},a.world.slug)]})}var Me=n(108),Ee=n(479),Te=n(447),Fe=n(234),Qe=n(480),Re=n(481),Ue=n(4),He=n.n(Ue),Le=n(468),Ne=n(490),We=n(445),ze=n(467),Pe=n(434),Ge=n(462),Je=n(463),Ye=n(464),Ze=n(465),Ve=n(457),Xe=n(466),qe=n(461),Ke=n(456),_e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACXlBMVEX/awD/agD/aQD/aAD/ZwD/ZQD/ZAD/YgD/YQD/YAD/XwD/XQD/XAD/WgD/WQD/VwD/VgD/VAD/UwD/UQD/WwD/UgD/UAD/XgD/gjj/eCr/TwD/TgD/Zgv/z7T/vJb/XgL/j07/+vf/8Oj/fTT/z7P/////vJj/XAP/TQD/TAD/kVD/+fb/8en/fTf/ZQz/0bb/vZr/WgT/kFD/8uv/fjr/VQD/waD/WQX/SwD/klP/9O3/fz3/ZQ7/0rn/w6T/WAb/SgD/klb//f3//v3/9O//gEL/0rr/y7H/1L//xan/Vgj/SQD/fj3/ilD/9vH/gEX/ZA//07z/WAX/Wwv/zbX/x63/Vgn/WAD/k1r/+/n/f0D/iE//+PX/9/P/gkr/ZBD/1b7/waL/WQr/yrD/ya//VQr/lFr/8+3/fT7/hEn/hE3/ZBH/1L3/vp7/VwX/UgH/Vwn/xqr//fz/yrH/VQz/TAH/SwH/ZBP/kVj/lV7/k17/kl3/bCP/Yxj/jlf/kFr/j1r/nGz/kF//i1j/iVb/iFT/jln/jVn/jVr/h1H/Vg//Wgv/nm7/tpH/tZD/rYX/aCT/SAD/dDb/sIr/so7/s4//j13/TQT/dTT/sYv/sYz/sY3/k2D/UAX/Vg3/nXD/sIz/qoL/ZSP/Vgr/mmr/sIv/rIX/ayj/dzv/jFj/TAP/cS//rof/kl//WxP/qoH/ZCL/Ugj/l2b/q4T/lGH/roj/by//qYD/YyD/Ugf/lmX/ilT/SwL/bCv/qH//YR3/TwX/iVP/aSj/TQX/kV//aSn/pHn/YR7/Tgf/ayv0qRl1AAAAAWJLR0QlwwHJDwAAAAd0SU1FB+UECw4ZCUCePeYAAAJ3SURBVDjLjdTnX9NAGMDxsypim66kabXFgXraiFvRqijR4jz3qgPce6EoOHDj3hFxEEcdVxXBvTdu/yvvujIuH/FetHnx/fyaNs9TAOhpZbPZWrchp21OTrvc3PZ2u8Ph4JxOl9vt9ni9Xl4Q/uF8WecVU7ClHnUC6+yWzs+4QIeOHOuCIaaX16lzFwsXAqb7c3TN79bd6TN9bigJ9S6Q1wPCnr2YXlgCxu/L9S6AsE9ft6kXliRgcIF+/SE5AwaaewQafj/foAIKBw8pNPVSUPudU0EIhw4z9aQI0Dvf8PwUHDFSNPYiBGqOKxoF02d0MW/oRWSge76+MTQ4NkpeSsYFDT1ZBprjisbT2ISJ9HXSZENPRkCbF2cyWDJlKv3m06YH9T2EgDZXM2Ym727W7Dn0fe48g0Mg62LzF9DgQlFcVEouyhZLekdgZk6XLKWhZcVefvkKerVyld4hkJn72GoaXLNW5MXgujJyWbpeJizjEEj3XBs2wmgUbtrMl5cLW7bCigq4bbtUWVmVdgSm5j62Y+eu3dXVe0Rh7779Bw4eqjl8pOboseMnTqIMzOyHp5A+C1H0nzp95uy58wpSLtRerLt0WQdNc++/crVevXY9cuOmGr91W9Egsx937qo4cQ/dr8XqgwaUhRyzH+GHjVhtekSCj58oGmT3Lfz0mYqfv3hpCBLoYvYj8qoR4ziOv36j6CC7b5L09p2KMVbff0A6yO6bJMkfExjXf/qsGKGH2Q/5S5OK1eYqZIBMjzxf9DVhCiLA9ugcfPte16y/QwItemQOlB8/fykMZHrk/P7TgMyQ7VkdwFv1rKDwfy4J6f9kSw79BReDIgKN7zeEAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIxLTA0LTExVDE0OjI0OjUyKzAwOjAwCFzYFAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMS0wNC0xMVQxNDoyNDozMiswMDowML9uaS8AAAAASUVORK5CYII=",$e="settings",et=[];function tt(){try{var e,t,n,r=null!==(e=localStorage.getItem($e))&&void 0!==e?e:"{}",a=JSON.parse(r);return{sport:null!==(t=a.sport)&&void 0!==t?t:"cycling",units:null!==(n=a.units)&&void 0!==n?n:"metric"}}catch(i){return{sport:"cycling",units:"metric"}}}function nt(){var e=Object(i.useState)(tt),t=Object(A.a)(e,2),n=t[0],r=t[1];Object(i.useEffect)((function(){var e=function(e){return r(e)};return et.push(e),function(){et.splice(et.indexOf(e),1)}}),[n]);var a=Object(i.useCallback)((function(e){r(e),function(e){localStorage.setItem($e,JSON.stringify(e))}(e),et.forEach((function(t){return t(e)}))}),[]);return[n,a]}var rt=new Intl.NumberFormat("en-US",{minimumFractionDigits:1,maximumFractionDigits:1,style:"decimal"}),at=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0,style:"decimal"});function it(e){var t=e.distance,n=nt();switch(Object(A.a)(n,1)[0].units){case"imperial":var r=t/1.609;return r<.3?Object(De.jsxs)(De.Fragment,{children:[at.format(5280*r),"ft"]}):Object(De.jsxs)(De.Fragment,{children:[rt.format(r),"mi"]});case"metric":return t<1?Object(De.jsxs)(De.Fragment,{children:[at.format(1e3*t),"m"]}):Object(De.jsxs)(De.Fragment,{children:[rt.format(t),"km"]})}}var ct=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0,style:"decimal"});function ot(e){var t=e.elevation,n=nt();switch(Object(A.a)(n,1)[0].units){case"imperial":return Object(De.jsxs)(De.Fragment,{children:[ct.format(3.28084*t),"ft"]});case"metric":return Object(De.jsxs)(De.Fragment,{children:[ct.format(t),"m"]})}}var st=n(140),At=n.n(st),ut=n(450),lt=n(451),dt=n(455),jt=n(249),bt=n(250),ft=n(118),pt=n(259);function gt(){return Object(De.jsxs)("linearGradient",{id:"colorElevation",x1:"0",y1:"0",x2:"0",y2:"1",children:[Object(De.jsx)("stop",{offset:"5%",stopColor:"black",stopOpacity:.8}),Object(De.jsx)("stop",{offset:"95%",stopColor:"black",stopOpacity:0})]})}var ht=["altitude","distance"];function Ot(e){var t=e.route,n=e.onMouseHoverDistanceChange,r=Object(g.a)(ve,[t.slug,"routes",ht]).result,a=Object(i.useState)(void 0),c=Object(A.a)(a,2),o=c[0],s=c[1],u=function(e){n(null===e||void 0===e?void 0:e.distance),s(e)},l=Object(i.useMemo)((function(){if(void 0!==r)return At()(r.distance.map((function(e,t){return{distance:Math.round(e/10)/100,elevation:r.altitude[t]}})),(function(e,t){return e.distance===t.distance}))}),[r]);return void 0===l?null:Object(De.jsxs)("div",{style:{width:"100%",height:100,marginBottom:"1em"},children:[Object(De.jsx)(ut.a,{width:"100%",height:"100%",children:Object(De.jsxs)(lt.a,{data:l,margin:{top:25,right:15,left:15,bottom:15},baseValue:"dataMin",children:[Object(De.jsx)("defs",{children:Object(De.jsx)(gt,{})}),Object(De.jsx)(dt.a,{vertical:!1}),Object(De.jsx)(jt.a,{name:"Distance",dataKey:"distance",type:"number",allowDecimals:!1,tick:!1,unit:"km",domain:[0,"dataMax"],hide:!0}),Object(De.jsx)(bt.a,{name:"Elevation",type:"number",allowDecimals:!1,tickCount:5,domain:["dataMin","auto"],unit:"m",hide:!0}),Object(De.jsx)(ft.a,{content:function(e){return Object(De.jsx)(vt,Object(b.a)(Object(b.a)({},e),{},{onMouseMove:u}))},isAnimationActive:!1,position:{y:10},cursor:{stroke:"black"}}),Object(De.jsx)(pt.a,{type:"monotone",dataKey:"elevation",name:"Elevation",stroke:"black",fillOpacity:1,fill:"url(#colorElevation)",unit:"m",isAnimationActive:!1})]})}),Object(De.jsxs)("div",{style:{display:"flex",gap:"1em"},children:[Object(De.jsxs)(Ke.a,{type:"body-2",style:{whiteSpace:"nowrap"},children:["Distance:"," ",(null===o||void 0===o?void 0:o.distance)?Object(De.jsx)(it,{distance:o.distance}):"- km"]}),Object(De.jsxs)(Ke.a,{type:"body-2",style:{whiteSpace:"nowrap"},children:["Altitude:"," ",(null===o||void 0===o?void 0:o.altitude)?Object(De.jsx)(ot,{elevation:o.altitude}):"- m"]})]})]})}function vt(e){return Object(i.useEffect)((function(){void 0===e.payload||0===e.payload.length?e.onMouseMove(void 0):e.onMouseMove({distance:e.payload[0].payload.distance,altitude:e.payload[0].payload.elevation})}),[e]),null}var mt,xt,wt,yt=n(496),kt=n(251),Ct=n.n(kt);function Dt(){return Bt.apply(this,arguments)}function Bt(){return(Bt=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return mt||(mt=L.a.get("https://us-or-rly101.zwift.com/api/public/events/upcoming").then((function(e){return e.data}))),e.next=3,mt;case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function St(e){var t=e.route,n=Object(g.a)(Dt,[]).result,r=Object(i.useMemo)((function(){if(n)return n.filter((function(e){var n=[e.routeId].concat(Object(U.a)(e.eventSubgroups.map((function(e){return e.routeId}))));return t.id&&n.includes(t.id)})).sort((function(e,t){return e.eventStart.localeCompare(t.eventStart)}))}),[n,t]);return void 0===r?Object(De.jsx)(Fe.a,{children:Object(De.jsx)(yt.a,{id:"loading-events",small:!0,circleStyle:{stroke:"black"}})}):0===r.length?Object(De.jsx)(Fe.a,{children:Object(De.jsx)(Ke.a,{type:"body-2",children:"No events on this route today."})}):Object(De.jsxs)(De.Fragment,{children:[r.slice(0,3).map((function(e){var t;return Object(De.jsx)(Pe.a,{onClick:function(){return window.open("http://zwift.com/events/view/".concat(e.id),"_blank")},rightAddon:Object(De.jsx)(Ve.a,{}),rightAddonType:"icon",secondaryText:Object(De.jsxs)(De.Fragment,{children:[new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",weekday:"short"}).format(Date.parse(e.eventStart)),Object(De.jsx)("br",{}),null!==(t=It[e.eventType])&&void 0!==t?t:e.eventType," |\xa0",0!==e.distanceInMeters?Object(De.jsx)(it,{distance:e.distanceInMeters/1e3}):e.durationInSeconds>0?Object(De.jsxs)(De.Fragment,{children:[Ct()(e.durationInSeconds)/60,"min"]}):Object(De.jsx)(De.Fragment,{children:1===e.laps?"1 lap":"".concat(e.laps," laps")})]}),threeLines:!0,children:e.name},e.id)})),r.length>3&&Object(De.jsx)(Fe.a,{children:Object(De.jsxs)(Ke.a,{type:"body-2",children:[r.length-3," more"," ",4===r.length?"event":"events"," happening today"]})})]})}!function(e){e.CullingEventOnly="CULLING_EVENT_ONLY",e.CullingEverybody="CULLING_EVERYBODY",e.CullingSubgroupOnly="CULLING_SUBGROUP_ONLY"}(xt||(xt={})),function(e){e.TourOfWatopiaRideStage5="Tour of Watopia - Ride Stage 5",e.TourOfWatopiaRunStage5="Tour of Watopia - Run Stage 5"}(wt||(wt={}));var It={GROUP_RIDE:"Group Ride",GROUP_WORKOUT:"Workout",RACE:"Race",TIME_TRIAL:"Time Trial"},Mt=n(458),Et=n(459);function Tt(e){var t=e.seconds,n=t%60,r=(t-n)/60%60,a=((t-n)/60-r)/60;return 0===a?0===r?Object(De.jsxs)(De.Fragment,{children:[n,"s"]}):Object(De.jsxs)(De.Fragment,{children:[r,":",n.toString().padStart(2,"0"),"min"]}):Object(De.jsxs)(De.Fragment,{children:[a,":",r.toString().padStart(2,"0"),":",n.toString().padStart(2,"0"),"h"]})}function Ft(e){var t=e.route,n=F(),r=Object(A.a)(n,2),a=r[0],i=r[1],c=S.b.filter((function(e){return e.world===t.world})).filter((function(e){return t.segments.includes(e.slug)})).sort((function(e,t){return e.name.localeCompare(t.name)}));if(0===c.length)return Object(De.jsx)(Fe.a,{children:Object(De.jsx)(Ke.a,{type:"body-2",children:"No segments on this route."})});var o=a.segments;return Object(De.jsx)(De.Fragment,{children:c.map((function(e){return Object(De.jsx)(Pe.a,{disabled:void 0===e.stravaSegmentId,rightAddonType:"icon",rightAddon:void 0===e.stravaSegmentId?null:o.includes(e)?Object(De.jsx)(Mt.a,{}):Object(De.jsx)(Et.a,{}),secondaryText:Object(De.jsx)(Qt,{segment:e}),threeLines:!0,onClick:function(){void 0!==e.stravaSegmentId&&(o.includes(e)?i(Object(b.a)(Object(b.a)({},a),{},{type:"route",route:a.route,segments:o.filter((function(t){return t!==e}))})):i(Object(b.a)(Object(b.a)({},a),{},{type:"route",route:a.route,segments:[].concat(Object(U.a)(o),[e])})))},children:e.name},e.slug)}))})}function Qt(e){var t,n=e.segment,r=B(),a=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t&&n){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,se(t.toString());case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[n.stravaSegmentId,r]),i=a.result,c=(null!==(t=null===i||void 0===i?void 0:i.athlete_segment_stats.effort_count)&&void 0!==t?t:0)>0?null===i||void 0===i?void 0:i.athlete_segment_stats.pr_elapsed_time:null;return Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)(it,{distance:n.distance}),n.avgIncline&&Object(De.jsxs)(De.Fragment,{children:[" ","|"," ",new Intl.NumberFormat("en-US",{minimumFractionDigits:1,maximumFractionDigits:1,style:"percent"}).format(n.avgIncline/100)]}),Object(De.jsx)("br",{}),c?Object(De.jsxs)(De.Fragment,{children:["PB: ",Object(De.jsx)(Tt,{seconds:c})]}):Rt[n.type]]})}var Rt={climb:"Climb",sprint:"Sprint",segment:"Segment"},Ut=n(460);function Ht(e){var t=e.route,n=B(),r=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&void 0!==n){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,se(n.toString());case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[n,t.stravaSegmentId]),a=r.result,i=r.loading,c=r.error;if(i)return Object(De.jsx)(Fe.a,{leftAddon:Object(De.jsx)(Ut.a,{}),leftAddonType:"icon",rightAddon:Object(De.jsx)(qe.a,{}),rightAddonType:"icon",children:Object(De.jsx)(yt.a,{id:"strava-route-pb-".concat(t.id),circleStyle:{stroke:"black"},small:!0})});if(c||null===a||void 0===a)return null;return Object(De.jsx)(Pe.a,{leftAddon:Object(De.jsx)(Ut.a,{}),leftAddonType:"icon",rightAddon:Object(De.jsx)(qe.a,{}),rightAddonType:"icon",onClick:function(){window.open("https://www.strava.com/segments/".concat(a.id),"_blank")},children:0===a.athlete_segment_stats.effort_count?Object(De.jsx)(De.Fragment,{children:"No time set"}):Object(De.jsx)(Tt,{seconds:a.athlete_segment_stats.pr_elapsed_time})})}function Lt(e){var t=e.route,n=e.onMouseHoverDistanceChange,r=e.backButtonText,a=e.onBackButtonClick,i=S.c.find((function(e){return e.slug===t.world}));return Object(De.jsxs)(Te.a,{children:[Object(De.jsx)(Fe.a,{children:Object(De.jsx)(Ne.a,{themeType:"outline",onClick:a,children:Object(De.jsx)(We.a,{icon:Object(De.jsx)(Ge.a,{}),children:r})})}),Object(De.jsx)(Fe.a,{children:Object(De.jsx)(Ke.a,{type:"headline-6",style:{margin:0},children:t.name})}),Object(De.jsxs)(Fe.a,{clickable:!1,leftAddon:Object(De.jsx)(Je.a,{}),leftAddonType:"icon",children:[Object(De.jsx)(it,{distance:t.distance}),void 0!==t.leadInDistance&&Object(De.jsxs)(De.Fragment,{children:["\xa0",Object(De.jsxs)("small",{children:["(+",Object(De.jsx)(it,{distance:t.leadInDistance}),")"]})]})]}),Object(De.jsxs)(Fe.a,{clickable:!1,leftAddon:Object(De.jsx)(Ye.a,{}),leftAddonType:"icon",children:[Object(De.jsx)(ot,{elevation:t.elevation}),void 0!==t.leadInElevation&&Object(De.jsxs)(De.Fragment,{children:["\xa0",Object(De.jsxs)("small",{children:["(+",Object(De.jsx)(ot,{elevation:t.leadInElevation}),")"]})]})]}),t.experience&&Object(De.jsxs)(Fe.a,{clickable:!1,leftAddon:Object(De.jsx)(Ze.a,{}),leftAddonType:"icon",children:[t.experience,"XP"]}),t.eventOnly&&Object(De.jsx)(Fe.a,{clickable:!1,leftAddon:Object(De.jsx)(Ve.a,{}),leftAddonType:"icon",children:"Event only route"}),Object(De.jsx)(Fe.a,{clickable:!1,leftAddon:Object(De.jsx)(Xe.a,{}),children:i.name}),Object(De.jsx)(Ht,{route:t}),Object(De.jsx)(Fe.a,{children:Object(De.jsx)(Ot,{route:t,onMouseHoverDistanceChange:n})}),Object(De.jsx)(ze.a,{children:"Upcoming Events"}),Object(De.jsx)(St,{route:t}),Object(De.jsx)(ze.a,{children:"Segments"}),Object(De.jsx)(Ft,{route:t}),Object(De.jsx)(ze.a,{children:"Links"}),t.zwiftInsiderUrl&&Object(De.jsx)(Pe.a,{onClick:function(){return window.open(t.zwiftInsiderUrl,"_blank")},leftAddon:Object(De.jsx)(Le.a,{color:"#fc6719",children:Object(De.jsx)("img",{src:"data:image/jpeg;base64,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",alt:""})}),leftAddonType:"avatar",rightAddon:Object(De.jsx)(qe.a,{}),rightAddonType:"icon",children:"ZwiftInsider"}),t.stravaSegmentUrl&&Object(De.jsx)(Pe.a,{onClick:function(){return window.open(t.stravaSegmentUrl,"_blank")},leftAddon:Object(De.jsx)(Le.a,{color:"#ff6b00",children:Object(De.jsx)("img",{src:_e,alt:""})}),leftAddonType:"avatar",rightAddon:Object(De.jsx)(qe.a,{}),rightAddonType:"icon",children:"Strava Segment"}),t.whatsOnZwiftUrl&&Object(De.jsx)(Pe.a,{onClick:function(){return window.open(t.whatsOnZwiftUrl,"_blank")},leftAddon:Object(De.jsx)(Le.a,{color:"#000000",children:Object(De.jsx)("img",{src:"data:image/png;base64,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",alt:""})}),leftAddonType:"avatar",rightAddon:Object(De.jsx)(qe.a,{}),rightAddonType:"icon",children:"What's on Zwift"})]})}function Nt(e){var t=e.activityId;return B()?Object(De.jsx)(Wt,{activityId:t}):Object(De.jsx)(Te.a,{children:Object(De.jsx)(Pe.a,{leftAddon:Object(De.jsx)(Le.a,{color:"#ff6b00",children:Object(De.jsx)("img",{src:_e,alt:""})}),leftAddonType:"avatar",rightAddon:Object(De.jsx)(qe.a,{}),rightAddonType:"icon",secondaryText:"\u2026to view Strava activity",onClick:G,children:"Authorize Strava App\u2026"})})}function Wt(e){var t=e.activityId,n=F(),r=Object(A.a)(n,2),a=r[0],i=r[1],c=Object(g.a)(de,[t]),o=c.result,s=c.loading;return o?Object(De.jsxs)(Te.a,{children:[Object(De.jsx)(Fe.a,{children:Object(De.jsx)(Ne.a,{themeType:"outline",onClick:function(){i({world:a.world,query:a.query,type:"strava-activities"})},children:Object(De.jsx)(We.a,{icon:Object(De.jsx)(Ge.a,{}),children:"Strava activities"})})}),Object(De.jsx)(Fe.a,{children:Object(De.jsx)(Ke.a,{type:"headline-6",style:{margin:0},children:o.name})}),Object(De.jsx)(Fe.a,{clickable:!1,leftAddon:Object(De.jsx)(Ut.a,{}),leftAddonType:"icon",children:Object(De.jsx)(Tt,{seconds:o.time})}),Object(De.jsx)(Fe.a,{clickable:!1,leftAddon:Object(De.jsx)(Je.a,{}),leftAddonType:"icon",children:Object(De.jsx)(it,{distance:o.distance})}),Object(De.jsx)(Fe.a,{clickable:!1,leftAddon:Object(De.jsx)(Ye.a,{}),leftAddonType:"icon",children:Object(De.jsx)(ot,{elevation:o.elevation})}),Object(De.jsx)(Fe.a,{clickable:!1,leftAddon:Object(De.jsx)(Xe.a,{}),children:o.world.name}),Object(De.jsx)(ze.a,{children:"Links"}),Object(De.jsx)(Pe.a,{onClick:function(){return window.open("https://www.strava.com/activities/".concat(o.id),"_blank")},leftAddon:Object(De.jsx)(Le.a,{color:"#000000",children:Object(De.jsx)("img",{src:_e,alt:""})}),leftAddonType:"avatar",rightAddon:Object(De.jsx)(qe.a,{}),rightAddonType:"icon",children:"Activity on Strava"})]}):s?Object(De.jsx)(yt.a,{id:"strava-activity-".concat(t),circleStyle:{stroke:"black"}}):Object(De.jsx)(Te.a,{children:Object(De.jsx)(Fe.a,{secondaryText:"Make sure you can access the activity and it was recorded in Zwift.",threeLines:!0,children:"An error occurred"})})}function zt(e){e.world;return null}function Pt(e){var t=e.onMouseHoverDistanceChange,n=e.backButtonText,r=e.onBackButtonClick,a=F(),i=Object(A.a)(a,1)[0];return"route"===i.type?Object(De.jsx)(Lt,{route:i.route,onMouseHoverDistanceChange:t,backButtonText:n,onBackButtonClick:r}):"strava-activity"===i.type?Object(De.jsx)(Nt,{activityId:i.stravaActivityId}):Object(De.jsx)(zt,{world:i.world})}var Gt=n(49),Jt=n.n(Gt),Yt=n(474),Zt=n(475),Vt=n(477),Xt=n(478),qt=n(486),Kt=n(476),_t=n(433),$t=n(444),en=n(252);var tn=n(484),nn=n(469),rn=n(470),an=n(471),cn=n(472),on=n(253),sn=n.n(on);function An(e){var t=e.visible,n=e.onClose;return Object(De.jsxs)(tn.a,{id:"info-dialog","aria-labelledby":"info-dialog-title",visible:t,onRequestClose:n,className:sn.a.Dialog,children:[Object(De.jsx)(nn.a,{style:{paddingBottom:0},children:Object(De.jsx)(rn.a,{id:"info-dialog-title",children:"Zwift Map"})}),Object(De.jsxs)(an.a,{children:[Object(De.jsx)(Ke.a,{children:"ZwiftMap is a fan project created by Andi P\xe4tzold."}),Object(De.jsxs)(Ke.a,{children:["All code is open source and available on"," ",Object(De.jsx)("a",{href:"https://github.com/andipaetzold/zwiftmap",rel:"noreferrer noopener",target:"_blank",children:"GitHub"}),"."]}),Object(De.jsxs)(Ke.a,{children:["Route and Segment Information is collected and combined from:"," "]}),Object(De.jsxs)("ul",{children:[Object(De.jsx)("li",{children:Object(De.jsx)("a",{href:"https://strava.com",rel:"noreferrer noopener",target:"_blank",children:"Strava"})}),Object(De.jsx)("li",{children:Object(De.jsx)("a",{href:"https://whatsonzwift.com",rel:"noreferrer noopener",target:"_blank",children:"What's on Zwift"})}),Object(De.jsx)("li",{children:Object(De.jsx)("a",{href:"https://zwift.com",rel:"noreferrer noopener",target:"_blank",children:"Zwift"})}),Object(De.jsx)("li",{children:Object(De.jsx)("a",{href:"https://zwifthub.com",rel:"noreferrer noopener",target:"_blank",children:"ZwiftHub"})}),Object(De.jsx)("li",{children:Object(De.jsx)("a",{href:"https://zwiftpower.com",rel:"noreferrer noopener",target:"_blank",children:"Zwift Power"})})]}),Object(De.jsxs)(Ke.a,{children:["World maps were created by",Object(De.jsx)("a",{href:"https://zwift.com",rel:"noreferrer noopener",target:"_blank",children:"Zwift"}),"."]}),Object(De.jsx)(Ke.a,{children:"ZwiftMap does not collect, analyze or store any sensitive information. The app only uses data required for the operation and monitoring."}),Object(De.jsx)(Ke.a,{type:"headline-6",style:{margin:0},children:"Contact"}),Object(De.jsxs)(Ke.a,{children:["Andi P\xe4tzold",Object(De.jsx)("br",{}),Object(De.jsx)("a",{href:"mainto:info@zwiftmap.com",rel:"noreferrer noopener",target:"_blank",children:"info@zwiftmap.com"}),Object(De.jsx)("br",{}),"Support this project via"," ",Object(De.jsx)("a",{href:"https://paypal.com/donate?hosted_button_id=PWQGBVL8H88QW",rel:"noreferrer noopener",target:"_blank",children:"PayPal"})]})]}),Object(De.jsx)(cn.a,{children:Object(De.jsx)(Ne.a,{id:"dialog-close",onClick:n,children:"Close"})})]})}var un=n(473),ln=n(489);function dn(e){var t=e.visible,n=e.onClose,r=nt(),a=Object(A.a)(r,2),i=a[0],c=a[1],o=function(e){e.target.checked&&c(Object(b.a)(Object(b.a)({},i),{},{sport:e.target.value}))},s=function(e){e.target.checked&&c(Object(b.a)(Object(b.a)({},i),{},{units:e.target.value}))};return Object(De.jsxs)(tn.a,{id:"settings-dialog","aria-labelledby":"settings-dialog-title",visible:t,onRequestClose:n,children:[Object(De.jsx)(nn.a,{style:{paddingBottom:0},children:Object(De.jsx)(rn.a,{id:"settings-dialog-title",children:"Settings"})}),Object(De.jsxs)(an.a,{children:[Object(De.jsxs)(un.a,{legend:"Sport",children:[Object(De.jsx)(ln.a,{id:"settings-dialog-cycling",name:"settings-dialog-sport",label:"Cycling",value:"cycling",checked:"cycling"===i.sport,onChange:o}),Object(De.jsx)(ln.a,{id:"settings-dialog-running",name:"settings-dialog-sport",label:"Running",value:"running",checked:"running"===i.sport,onChange:o})]}),Object(De.jsxs)(un.a,{legend:"Units",children:[Object(De.jsx)(ln.a,{id:"settings-dialog-metric",name:"settings-dialog-units",label:"Metric",value:"metric",checked:"metric"===i.units,onChange:s}),Object(De.jsx)(ln.a,{id:"settings-dialog-imperial",name:"settings-dialog-units",label:"Imperial",value:"imperial",checked:"imperial"===i.units,onChange:s})]})]}),Object(De.jsx)(cn.a,{children:Object(De.jsx)(Ne.a,{id:"dialog-close",onClick:n,children:"Close"})})]})}function jn(e){var t=e.onBottomSheetClose,n=Object(i.useRef)(null),r=Object(i.useState)(!1),a=Object(A.a)(r,2),c=a[0],o=a[1],s=Object(_t.a)(!1),u=Object(A.a)(s,3),l=u[0],d=u[1],j=u[2],b=Object(_t.a)(!1),f=Object(A.a)(b,3),p=f[0],g=f[1],h=f[2],O=Object(en.useMediaQuery)({query:"(max-width: 750px)"}),v=B();return Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)(Pe.a,{onClick:function(e){e.stopPropagation(),o(!c)},rightAddon:O?Object(De.jsx)(Yt.a,{}):Object(De.jsx)(Zt.a,{}),rightAddonType:"icon",id:"sidebar-menu",ref:n,children:"Menu"}),Object(De.jsx)(qt.a,{id:"sidebar-menu",controlId:"sidebar-menu",visible:c,onRequestClose:function(){return o(!1)},"aria-labelledby":"sidebar-menu",anchor:$t.b,portal:!0,children:Object(De.jsxs)(Te.a,{children:[Object(De.jsx)(Kt.a,{onClick:function(){g(),t()},leftAddon:Object(De.jsx)(Vt.a,{}),leftAddonType:"icon",children:"Info"}),Object(De.jsx)(Kt.a,{onClick:function(){d(),t()},leftAddon:Object(De.jsx)(Xt.a,{}),leftAddonType:"icon",children:"Settings"}),Object(De.jsx)(Ee.a,{}),v?Object(De.jsx)(Kt.a,{onClick:function(){z()},children:"Logout from Strava"}):Object(De.jsx)(Kt.a,{onClick:G,children:"Login to Strava"})]})}),Object(De.jsx)(dn,{visible:l,onClose:j}),Object(De.jsx)(An,{visible:p,onClose:h})]})}var bn=["altitude","distance"];function fn(e){var t=e.route,n=Object(g.a)(ve,[t.slug,"routes",bn]).result,r=Object(i.useMemo)((function(){if(void 0!==n){var e=At()(n.distance.map((function(e,t){return{distance:Math.round(e/100)/10,elevation:n.altitude[t]}})),(function(e,t){return e.distance===t.distance})),t=Math.min.apply(Math,Object(U.a)(e.map((function(e){return e.elevation}))));return e.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{elevation:e.elevation-t})}))}}),[n]);return r?Object(De.jsxs)(lt.a,{height:50,width:100,data:r,baseValue:"dataMin",children:[Object(De.jsx)("defs",{children:Object(De.jsx)(gt,{})}),Object(De.jsx)(jt.a,{dataKey:"distance",type:"number",domain:[0,"dataMax"],unit:"km",hide:!0}),Object(De.jsx)(bt.a,{dataKey:"elevation",type:"number",allowDecimals:!1,domain:[0,750],unit:"m",hide:!0}),Object(De.jsx)(pt.a,{type:"monotone",dataKey:"elevation",name:"Elevation",stroke:"black",fillOpacity:1,fill:"url(#colorElevation)",unit:"m",isAnimationActive:!1})]}):Object(De.jsx)(yt.a,{id:"elevation-preview-".concat(t.slug),small:!0,circleStyle:{stroke:"black"}})}function pn(e){var t=e.route,n=e.onHoverRoute,r=e.showWorldName,a=F(),i=Object(A.a)(a,2),c=i[0],o=i[1];return Object(De.jsx)(Pe.a,{secondaryText:Object(De.jsx)(gn,{route:t,showWorldName:r}),threeLines:r,onClick:function(){o({world:S.c.find((function(e){return e.slug===t.world})),route:t,segments:[],query:c.query,type:"route"}),n(void 0)},rightAddonType:"large-media",rightAddon:Object(De.jsx)(hn,{route:t}),onMouseEnter:function(){return n(t.slug)},onMouseLeave:function(){return n(void 0)},children:t.name})}function gn(e){var t=e.route,n=e.showWorldName;return Object(De.jsxs)(De.Fragment,{children:[n&&Object(De.jsxs)(De.Fragment,{children:[S.c.find((function(e){return e.slug===t.world})).name,Object(De.jsx)("br",{})]}),Object(De.jsx)(it,{distance:t.distance})," |"," ",Object(De.jsx)(ot,{elevation:t.elevation})]})}function hn(e){var t=e.route,n=Object(i.useRef)(null),r=function(e){var t=Object(i.useState)(!1),n=Object(A.a)(t,2),r=n[0],a=n[1];return Object(i.useEffect)((function(){var t=e.current,n=new IntersectionObserver((function(e){var t=Object(A.a)(e,1)[0];a(t.isIntersecting)}));return t&&n.observe(t),function(){t&&n.unobserve(t)}}),[]),r}(n);return Object(De.jsx)("div",{ref:n,style:{width:"100%",pointerEvents:"none"},children:r?Object(De.jsx)(fn,{route:t}):null})}function On(e){var t=e.onHoverRoute,n=nt(),r=Object(A.a)(n,1)[0],a=F(),i=Object(A.a)(a,2),c=i[0],o=i[1],s=B();return Object(De.jsxs)(De.Fragment,{children:[s&&Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)(Pe.a,{secondaryText:"Last 30 days",onClick:function(){o({world:c.world,query:"",type:"strava-activities"})},children:"Recent Strava Activities"}),Object(De.jsx)(Ee.a,{})]}),S.a.filter((function(e){return e.world===c.world.slug})).filter((function(e){return e.sports.includes(r.sport)})).filter((function(e){return void 0!==e.stravaSegmentId})).sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return Object(De.jsx)(pn,{route:e,onHoverRoute:t,showWorldName:!1},e.slug)}))]})}var vn=n(497),mn=n(22);function xn(){var e=F(),t=Object(A.a)(e,2),n=t[0],r=t[1];return Object(De.jsx)(vn.a,{id:"search-input",style:{width:"100%"},placeholder:"Search for worlds and routes\u2026",value:n.query,onChange:function(e){r({world:n.world,type:"default",query:e.target.value})},isRightAddon:!1,rightChildren:""!==n.query&&Object(De.jsx)(Ne.a,{buttonType:"icon",style:{right:0,position:"absolute"},onClick:function(){r(Object(b.a)(Object(b.a)({},n),{},{query:""}))},"aria-label":"Clear search field",children:Object(De.jsx)(mn.a,{children:"clear"})})})}var wn=/strava\.com\/activities\/(\d{10})/,yn=[].concat(Object(U.a)(Object(U.a)(S.c).sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return{type:"world",terms:[e.name].map((function(e){return e.toLocaleLowerCase()})),data:e}}))),Object(U.a)(Object(U.a)(S.a).sort((function(e,t){return e.name.localeCompare(t.name)})).filter((function(e){return void 0!==e.stravaSegmentId})).map((function(e){return{type:"route",terms:[S.c.find((function(t){return t.slug===e.world})).name,e.name].map((function(e){return e.toLocaleLowerCase()})),data:e}}))));var kn={world:{title:"Worlds"},route:{title:"Routes"},segment:{title:"Segments"},"strava-activity":{title:"Strava Activity"}};function Cn(e){var t=e.activity,n=e.onHoverRoute;return B()?Object(De.jsx)(Dn,{activity:t,onHoverRoute:n}):Object(De.jsx)(Pe.a,{leftAddon:Object(De.jsx)(Le.a,{color:"#ff6b00",children:Object(De.jsx)("img",{src:_e,alt:""})}),leftAddonType:"avatar",rightAddon:Object(De.jsx)(qe.a,{}),rightAddonType:"icon",secondaryText:"\u2026to view Strava activity",onClick:G,children:"Authorize Strava App\u2026"})}function Dn(e){var t=e.activity.activityId,n=(e.onHoverRoute,Object(g.a)(de,[t])),r=n.result,a=n.loading,i=F(),c=Object(A.a)(i,2)[1];if(!r)return a?Object(De.jsx)(yt.a,{id:"strava-activity-".concat(t),circleStyle:{stroke:"black"}}):Object(De.jsx)(Fe.a,{secondaryText:"Make sure you can access the activity and it was recorded in Zwift.",threeLines:!0,children:"An error occurred"});return Object(De.jsx)(Pe.a,{onClick:function(){c({world:r.world,stravaActivityId:r.id,query:"",type:"strava-activity"})},secondaryText:Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)(it,{distance:r.distance})," |"," ",Object(De.jsx)(ot,{elevation:r.elevation}),Object(De.jsx)("br",{}),r.avgWatts&&Object(De.jsxs)(De.Fragment,{children:[Math.round(r.avgWatts),"W | "]}),Object(De.jsx)(Tt,{seconds:r.time})]}),threeLines:!0,rightAddonType:r.photoUrl?"large-media":void 0,rightAddon:r.photoUrl?Object(De.jsx)("img",{src:r.photoUrl,alt:"",width:"100"}):void 0,children:r.name})}function Bn(e){var t=e.world,n=F(),r=Object(A.a)(n,2)[1],a=nt(),i=Object(A.a)(a,1)[0],c="".concat(S.a.filter((function(e){return e.sports.includes(i.sport)})).filter((function(e){return e.world===t.slug})).length," routes | ").concat(S.b.filter((function(e){return e.world===t.slug})).length," segments");return Object(De.jsx)(Pe.a,{secondaryText:c,onClick:function(){r({world:t,query:"",type:"default"})},children:t.name})}function Sn(e){var t=e.onHoverRoute,n=F(),r=Object(A.a)(n,1)[0],a=nt(),c=Object(A.a)(a,1)[0],o=function(e,t){if(wn.test(e)){var n=wn.exec(e),r=Object(A.a)(n,2)[1];return[{type:"strava-activity",data:{activityId:r,slug:"strava-activity-".concat(r)}}]}var a=e.toLocaleLowerCase().split(" ").filter((function(e){return e.length>0}));return yn.filter((function(e){return"world"===e.type||"segment"===e.type||e.data.sports.includes(t)})).filter((function(e){return a.every((function(t){return e.terms.some((function(e){return e.includes(t)}))}))}))}(r.query,c.sport);return 0===o.length?Object(De.jsx)(Fe.a,{children:"No worlds or routes found"}):Object(De.jsx)(De.Fragment,{children:o.map((function(e,n){var r;return Object(De.jsxs)(i.Fragment,{children:[(null===(r=o[n-1])||void 0===r?void 0:r.type)!==e.type&&Object(De.jsxs)(De.Fragment,{children:[o[n-1]&&Object(De.jsx)(Ee.a,{}),Object(De.jsx)(ze.a,{children:kn[e.type].title})]}),Object(De.jsx)(In,{searchResult:e,onHoverRoute:t})]},e.data.slug)}))})}function In(e){var t=e.searchResult,n=e.onHoverRoute;switch(t.type){case"world":return Object(De.jsx)(Bn,{world:t.data});case"route":return Object(De.jsx)(pn,{route:t.data,onHoverRoute:n,showWorldName:!0});case"strava-activity":return Object(De.jsx)(Cn,{activity:t.data,onHoverRoute:n});default:return null}}var Mn=(new Date).getTime()/1e3;function En(){var e=F(),t=Object(A.a)(e,2),n=t[0],r=t[1],a=Object(g.a)(Object(f.a)(j.a.mark((function e(){var t,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=1,r=[];case 3:return e.next=5,ue({after:Mn-2592e3,per_page:30,page:n});case 5:r=e.sent,t.push.apply(t,Object(U.a)(r)),++n;case 8:if(30===r.length){e.next=3;break}case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e)}))),[]).result;return Object(De.jsxs)(Te.a,{children:[Object(De.jsx)(Fe.a,{children:Object(De.jsx)(Ne.a,{themeType:"outline",onClick:function(){r({world:n.world,query:"",type:"default"})},children:Object(De.jsx)(We.a,{icon:Object(De.jsx)(Ge.a,{}),children:"Route List"})})}),Object(De.jsx)(ze.a,{children:"Recent Strava Activities"}),void 0===a&&Object(De.jsx)(Fe.a,{children:Object(De.jsx)(yt.a,{id:"strava-activities",circleStyle:{stroke:"black"}})}),void 0!==a&&Object(U.a)(a).sort((function(e,t){return-e.start_date.localeCompare(t.start_date)})).map((function(e){return{world:R(e),activity:e}})).filter((function(e){return void 0!==e.world})).map((function(e){var t=e.world,n=e.activity;return Object(De.jsx)(Pe.a,{onClick:function(){r({world:t,query:"",type:"strava-activity",stravaActivityId:n.id.toString()})},secondaryText:Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)(it,{distance:n.distance/1e3})," |"," ",Object(De.jsx)(ot,{elevation:n.total_elevation_gain}),Object(De.jsx)("br",{}),n.average_watts&&Object(De.jsxs)(De.Fragment,{children:[Math.round(n.average_watts),"W | "]}),Object(De.jsx)(Tt,{seconds:n.moving_time})]}),threeLines:!0,children:n.name},n.id)}))]})}function Tn(e){var t=e.onMouseHoverDistanceChange,n=e.onHoverRoute,r=Object(i.useState)(!1),a=Object(A.a)(r,2),c=a[0],o=a[1],s=F(),u=Object(A.a)(s,2),l=u[0],d=u[1],j=Object(i.useRef)(null);return Object(De.jsxs)(De.Fragment,{children:[Object(De.jsxs)("div",{className:He()(Jt.a.Container,Object(Me.a)({},Jt.a.BottomSheetOpen,c)),ref:j,children:[Object(De.jsx)("button",{className:Jt.a.DragHandle,onClick:function(){return o(!1)},children:Object(De.jsx)(Qe.a,{})}),Object(De.jsxs)(Te.a,{className:Jt.a.SearchBox,children:[Object(De.jsx)(Fe.a,{children:Object(De.jsx)(xn,{})}),Object(De.jsx)(Ee.a,{className:Jt.a.NoGapDivider})]}),Object(De.jsx)("div",{className:Jt.a.Content,children:"route"===l.type||"strava-activity"===l.type?Object(De.jsx)(Pt,{onMouseHoverDistanceChange:t,backButtonText:""===l.query?"Route List":"Search Results",onBackButtonClick:function(){d({world:l.world,query:l.query,type:"default"})}}):"strava-activities"===l.type?Object(De.jsx)(En,{}):Object(De.jsx)(Te.a,{children:""===l.query?Object(De.jsx)(On,{onHoverRoute:n}):Object(De.jsx)(Sn,{onHoverRoute:n})})}),Object(De.jsxs)(Te.a,{className:Jt.a.BottomMenu,children:[Object(De.jsx)(Ee.a,{className:Jt.a.NoGapDivider}),Object(De.jsx)(jn,{onBottomSheetClose:function(){return o(!1)}})]})]}),Object(De.jsx)("button",{className:He()(Jt.a.DragHandle,Jt.a.DragHandleBottom,Object(Me.a)({},Jt.a.BottomSheetOpen,c)),onClick:function(){return o(!0)},children:Object(De.jsx)(Re.a,{})})]})}function Fn(){Object(i.useEffect)((function(){try{L.a.get("".concat("https://api.zwiftmap.com","/ping"))}catch(e){}}),[]),function(){var e=Object(i.useCallback)((function(){var e=new URLSearchParams(window.location.search);e.has("strava-auth")&&(W(JSON.parse(e.get("strava-auth"))),e.delete("strava-auth"),window.history.replaceState(void 0,"","".concat(window.location.origin).concat(window.location.pathname,"?").concat(e.toString())))}),[]);Object(i.useEffect)((function(){e()}),[e]),Object(i.useEffect)((function(){return window.addEventListener("popstate",e),function(){return window.removeEventListener("popstate",e)}}),[e])}();var e=Object(i.useState)(void 0),t=Object(A.a)(e,2),n=t[0],r=t[1],a=Object(i.useState)(),c=Object(A.a)(a,2),o=c[0],s=c[1];return Object(De.jsxs)("div",{className:l.a.Wrapper,children:[Object(De.jsx)(Tn,{onMouseHoverDistanceChange:r,onHoverRoute:s}),Object(De.jsx)(Ie,{mouseHoverDistance:n,previewRoute:o})]})}var Qn;n(430);r.a({enabled:(null!==(Qn="https://8fd04f9fdc64444391867b0088cf64f9@o260685.ingest.sentry.io/5791747")?Qn:"").length>0,dsn:"https://8fd04f9fdc64444391867b0088cf64f9@o260685.ingest.sentry.io/5791747",integrations:[new a.a.BrowserTracing],tracesSampleRate:1}),s.a.render(Object(De.jsx)(c.a.StrictMode,{children:Object(De.jsx)(Fn,{})}),document.getElementById("app"))},49:function(e,t,n){e.exports={Container:"Sidebar_Container__3o0kK",BottomSheetOpen:"Sidebar_BottomSheetOpen__22Bgs",SearchBox:"Sidebar_SearchBox__3wlGX",Content:"Sidebar_Content__15Hau",BottomMenu:"Sidebar_BottomMenu__2Obmz",NoGapDivider:"Sidebar_NoGapDivider__20DmD",DragHandle:"Sidebar_DragHandle__l0Son",DragHandleBottom:"Sidebar_DragHandleBottom__1sHmD"}}},[[431,1,2]]]);
//# sourceMappingURL=main.5a202192.chunk.js.map