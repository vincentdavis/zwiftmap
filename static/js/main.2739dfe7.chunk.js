(this["webpackJsonpzwiftmap-frontend"]=this["webpackJsonpzwiftmap-frontend"]||[]).push([[0],{174:function(e,t,n){e.exports={Container:"RouteMap_Container__1kS2N",MapContainer:"RouteMap_MapContainer__1oyLk",navigationControl:"RouteMap_navigationControl__2RyF3"}},229:function(e,t,n){e.exports={Wrapper:"App_Wrapper__2vPXK"}},230:function(e,t,n){e.exports={Container:"WorldSelect_Container__3BQ6b"}},250:function(e,t,n){e.exports={Dialog:"InfoDialog_Dialog__3j2NL"}},428:function(e,t,n){},429:function(e,t,n){"use strict";n.r(t);var r=n(479),a=n(252),i=n(0),c=n.n(i),o=n(39),s=n.n(o),A=n(5),u=n(229),l=n.n(u),d=n(10),j=n.n(d),b=n(14),f=n(20),p=n(40),g=(n(273),n(32)),O=n(445),h=n(490),v=n(485),m=n(446),x=n(491),w=n(132),y="strava-auth",k=Object(w.a)();function C(e,t){null===t?localStorage.removeItem(e):localStorage.setItem(e,t),k.emit(e,t)}function D(e){return localStorage.getItem(e)}function B(){var e=Object(i.useState)((function(){return null!==D(y)})),t=Object(A.a)(e,2),n=t[0],r=t[1];return Object(i.useEffect)((function(){!function(e,t){var n=function(e){return t(e)};k.on(e,n)}(y,(function(e){return r(null!==e)}))}),[]),n}window.addEventListener("storage",(function(e){e.key&&k.emit(e.key,e.newValue)}));var S=n(25),I=S.c.find((function(e){return"watopia"===e.slug})),M=[];function E(){var e=Object(i.useState)(T),t=Object(A.a)(e,2),n=t[0],r=t[1];return Object(i.useEffect)((function(){var e=function(){return r(T())};return window.addEventListener("popstate",e),function(){return window.removeEventListener("popstate",e)}}),[]),Object(i.useEffect)((function(){var e=function(e){return r(e)};return M.push(e),function(){M.splice(M.indexOf(e),1)}}),[]),[n,Object(i.useCallback)((function(e){var t=new URLSearchParams;switch(t.set("world",e.world.slug),e.query.length>0&&t.set("q",e.query),e.type){case"default":break;case"route":t.set("route",e.route.slug),e.segments.length>0&&t.set("segments",e.segments.map((function(e){return e.slug})).join(","));break;case"strava-activities":t.set("strava-activities","");break;case"strava-activity":t.set("strava-activity",e.stravaActivityId)}window.history.pushState(void 0,"","?".concat(t.toString())),r(e),M.forEach((function(t){return t(e)}))}),[])]}function T(){var e,t,n=new URLSearchParams(window.location.search),r=null!==(e=S.c.find((function(e){return e.slug===n.get("world")})))&&void 0!==e?e:I,a=null!==(t=n.get("q"))&&void 0!==t?t:"";if(n.has("route")){var i,c=S.a.filter((function(e){return e.world===(null===r||void 0===r?void 0:r.slug)})).find((function(e){return e.slug===n.get("route")})),o=(null!==(i=n.get("segments"))&&void 0!==i?i:"").split(",").map((function(e){return S.b.find((function(t){return t.slug===e}))})).filter((function(e){return!!e}));return c?{world:r,query:a,type:"route",route:c,segments:o}:{world:r,query:a,type:"default"}}return n.has("strava-activities")?{world:r,query:a,type:"strava-activities"}:n.has("strava-activity")?{world:r,query:a,type:"strava-activity",stravaActivityId:n.get("strava-activity")}:{world:r,query:a,type:"default"}}var F={bologna:{imageBounds:[[44.5308037,11.26261748],[44.45463821,11.36991729102076]],initialBounds:[[44.501423,11.294653],[44.478222,11.341099]],image:n.p+"static/media/bologna.6f13d4d4.png",backgroundColor:"#b9b9b8"},"crit-city":{imageBounds:[[-10.3657,165.7824],[-10.4038,165.8207]],initialBounds:[[-10.382352,165.798758],[-10.386016,165.803496]],image:n.p+"static/media/crit-city.3bab2d0f.png",backgroundColor:"#7c9938"},france:{imageBounds:[[-21.64155,166.1384],[-21.7564,166.26125]],initialBounds:[[-21.697812,166.148225],[-21.744906,166.202642]],image:n.p+"static/media/france.aded90ff.png",backgroundColor:"#6f992d"},innsbruck:{imageBounds:[[47.2947,11.3501],[47.2055,11.4822]],initialBounds:[[47.280902,11.386414],[47.214544,11.445934]],image:n.p+"static/media/innsbruck.9821ed90.png",backgroundColor:"#7c9938"},london:{imageBounds:[[51.5362,-.1776],[51.4601,-.0555]],initialBounds:[[51.511261,-.134875],[51.489256,-.072996]],image:n.p+"static/media/london.54ae112e.png",backgroundColor:"#6f992d"},"makuri-islands":{imageBounds:[[-10.73746,165.80468],[-10.81405,165.88222]],initialBounds:[[-10.743702,165.830083],[-10.775156,165.859212]],image:n.p+"static/media/makuri-islands.5fe6bee4.png",backgroundColor:"#7c9938"},"new-york":{imageBounds:[[40.81725,-74.0227],[40.74085,-73.9222]],initialBounds:[[40.799618,-73.982068],[40.763547,-73.949602]],image:n.p+"static/media/new-york.5bf9b5e8.png",backgroundColor:"#bbbbb7"},paris:{imageBounds:[[48.9058,2.2561],[48.82945,2.3722]],initialBounds:[[48.874328,2.294207],[48.860895,2.331992]],image:n.p+"static/media/paris.d1eaa520.png",backgroundColor:"#b9b9b9"},richmond:{imageBounds:[[37.5774,-77.48954],[37.5014,-77.394]],initialBounds:[[37.558393,-77.467668],[37.520429,-77.415864]],image:n.p+"static/media/richmond.72df812b.png",backgroundColor:"#7c9938"},watopia:{imageBounds:[[-11.62597,166.87747],[-11.70255,167.03255]],initialBounds:[[-11.635444,166.93555],[-11.673613,166.972511]],image:n.p+"static/media/watopia.0901a23e.png",backgroundColor:"#0884e2"},yorkshire:{imageBounds:[[54.0254,-1.632],[53.9491,-1.5022]],initialBounds:[[53.999691,-1.592961],[53.974875,-1.539474]],image:n.p+"static/media/yorkshire.b83235cf.png",backgroundColor:"#7c9938"}};function Q(e){if(null!==e.start_latlng)return S.c.find((function(t){var n=F[t.slug].imageBounds;return n[0][0]>=e.start_latlng[0]&&e.start_latlng[0]>=n[1][0]&&n[0][1]<=e.start_latlng[1]&&e.start_latlng[1]<=n[1][1]}))}var R=n(33),U=n(45),H=n.n(U);function L(){var e=D(y);return null===e?null:JSON.parse(e)}function N(e){C(y,JSON.stringify(e))}function W(){return z.apply(this,arguments)}function z(){return(z=Object(f.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=L()){e.next=3;break}return e.abrupt("return");case 3:return C(y,null),e.prev=4,e.next=7,H.a.post("https://www.strava.com/oauth/deauthorize",void 0,{params:{access_token:t.access_token}});case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:case"end":return e.stop()}}),e,null,[[4,9]])})))).apply(this,arguments)}function P(){window.location.href=function(e){var t=new URLSearchParams;return t.set("state",JSON.stringify(e)),"".concat("https://api.zwiftmap.com","/strava/authorize?").concat(t.toString())}(Object.fromEntries(new URLSearchParams(window.location.search).entries()))}function G(e){return J.apply(this,arguments)}function J(){return(J=Object(f.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat("https://api.zwiftmap.com","/strava/refresh"),e.next=3,H.a.post(n,{refresh_token:t});case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Y=n(108),Z=n(109);function V(e){return JSON.stringify({url:e.url,params:e.params})}function X(){var e=new _,t=function(){var t=Object(f.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=V(n),"get"!==n.method){t.next=11;break}if(!e.hasResponse(r)){t.next=10;break}return n.headers.cached=!0,t.next=6,e.getResponse(r);case 6:throw n.data=t.sent,n;case 10:e.prepareResponse(r);case 11:return t.abrupt("return",n);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return{request:t,response:[function(t){var n;return"get"===(null===(n=t.config.method)||void 0===n?void 0:n.toLocaleLowerCase())&&e.storeResponse(V(t.config),t.data),t},function(e){return!0===e.headers.cached?Promise.resolve(e):Promise.reject(e)}]}}var q,K,_=function(){function e(){Object(Y.a)(this,e),this.store={},this.emitter=Object(w.a)()}return Object(Z.a)(e,[{key:"prepareResponse",value:function(e){var t=this;this.store[e]=new Promise((function(n){t.emitter.on(e,(function r(a){t.emitter.off(e,r),n(a)}))}))}},{key:"storeResponse",value:function(e,t){this.emitter.emit(e,t)}},{key:"hasResponse",value:function(e){return void 0!==this.store[e]}},{key:"getResponse",value:function(e){return this.hasResponse(e)?this.store[e]:Promise.reject()}}]),e}(),$=n(69),ee=n.n($),te=X(),ne=H.a.create({baseURL:"https://www.strava.com/api/v3"});function re(e){return ae.apply(this,arguments)}function ae(){return(ae=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne.get("/activities/".concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(e){return ce.apply(this,arguments)}function ce(){return(ce=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne.get("/activities/".concat(t,"/streams"),{params:{keys:["distance","latlng","time","altitude","wattage","velocity_smooth","watts","cadence","heartrate"].join(","),key_by_type:!0}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(e){return se.apply(this,arguments)}function se(){return(se=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne.get("/segments/".concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ae(){return ue.apply(this,arguments)}function ue(){return ue=Object(f.a)(j.a.mark((function e(){var t,n,r=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},e.next=3,ne.get("/athlete/activities",{params:t});case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)}))),ue.apply(this,arguments)}function le(e){return de.apply(this,arguments)}function de(){return(de=Object(f.a)(j.a.mark((function e(t){var n,r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re(t);case 2:if(r=e.sent,a=Q(r)){e.next=6;break}throw new Error("Activity was not recorded in Zwift");case 6:return e.t0=r.id.toString(),e.t1=r.name,e.t2=r.athlete.id.toString(),e.t3=r.distance/1e3,e.t4=r.total_elevation_gain,e.t5=r.moving_time,e.t6=a,e.t7=r.average_watts,e.t8=null===(n=r.photos.primary)||void 0===n?void 0:n.urls[100],e.next=17,je(t);case 17:return e.t9=e.sent,e.abrupt("return",{id:e.t0,name:e.t1,athleteId:e.t2,distance:e.t3,elevation:e.t4,time:e.t5,world:e.t6,avgWatts:e.t7,photoUrl:e.t8,streams:e.t9});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function je(e){return be.apply(this,arguments)}function be(){return(be=Object(f.a)(j.a.mark((function e(t){var n,r,a,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie(t);case 2:return i=e.sent,e.abrupt("return",{altitude:i.altitude.data,cadence:null===(n=i.cadence)||void 0===n?void 0:n.data,distance:i.distance.data,heartrate:null===(r=i.heartrate)||void 0===r?void 0:r.data,latlng:i.latlng.data,time:i.time.data,velocity:i.velocity_smooth.data,watts:null===(a=i.watts)||void 0===a?void 0:a.data});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}ne.interceptors.request.use(te.request),(q=ne.interceptors.response).use.apply(q,Object(R.a)(te.response)),ne.interceptors.request.use(function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=L())){e.next=16;break}if(!(n.expires_at<Math.round(Date.now()/1e3))){e.next=15;break}return e.prev=3,e.next=6,G(n.refresh_token);case 6:N(n=e.sent),e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(3),e.next=14,W();case 14:return e.abrupt("return",t);case 15:t.headers=Object(b.a)(Object(b.a)({},t.headers),{},{Authorization:"".concat(n.token_type," ").concat(n.access_token)});case 16:return e.abrupt("return",t);case 17:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}()),ne.interceptors.response.use(ee.a,function(){var e=Object(f.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W();case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var fe=X(),pe=H.a.create();function ge(e,t,n){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(f.a)(j.a.mark((function e(t,n,r){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe.get("".concat(n,"/").concat(t,"/").concat(r,".json"));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(e,t,n){return ve.apply(this,arguments)}function ve(){return(ve=Object(f.a)(j.a.mark((function e(t,n,r){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(r.map((function(e){return ge(t,n,e)})));case 2:return a=e.sent,e.abrupt("return",Object.fromEntries(r.map((function(e,t){return[e,a[t]]}))));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}pe.interceptors.request.use(fe.request),(K=pe.interceptors.response).use.apply(K,Object(R.a)(fe.response));var me=n(174),xe=n.n(me),we=n(484),ye=n(230),ke=n.n(ye),Ce=n(1),De=Object(R.a)(S.c).sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return{label:e.name,value:e.slug}}));function Be(){var e=E(),t=Object(A.a)(e,2),n=t[0],r=t[1];return Object(Ce.jsx)("div",{className:ke.a.Container,children:Object(Ce.jsx)(we.a,{id:"world-select",options:De,value:n.world.slug,listboxStyle:{zIndex:3e3},onChange:function(e){r({world:S.c.find((function(t){return t.slug===e})),query:"",type:"default"})}})})}function Se(e){var t=e.mouseHoverDistance,n=e.previewRoute,r=E(),a=Object(A.a)(r,1)[0],c=a.world,o=F[c.slug],s=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("route"===t.type){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,Promise.all(t.segments.map((function(e){return ge(e.slug,"segments","latlng")})));case 4:return n=e.sent,e.abrupt("return",t.segments.map((function(e,t){return Object(b.a)(Object(b.a)({},e),{},{stravaData:n[t]})})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[a]),u=s.result,l=Object(i.useState)(),d=Object(A.a)(l,2),w=d[0],y=d[1];Object(i.useEffect)((function(){null===w||void 0===w||w.zoomControl.setPosition("topright")}),[w]);var k=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("route"===t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,he(n.slug,"routes",["distance","latlng"]);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[a.type,a.route]),C=k.result,D=B(),S=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&"strava-activity"===n.type){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,le(n.stravaActivityId);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[D,a]),I=S.result,M=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,he(t,"routes",["latlng"]);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n]),T=M.result;Object(i.useEffect)((function(){if(w&&C){var e=C.latlng.reduce((function(e,t){return e.extend(t)}),new p.LatLngBounds(C.latlng[0],C.latlng[0]));w.invalidateSize(),w.fitBounds(e)}}),[w,C,o]),Object(i.useEffect)((function(){if(w){var e=F[a.world.slug];w.invalidateSize(),w.setMaxBounds(e.imageBounds);var t=w.getBoundsZoom(e.imageBounds,!1);w.setMinZoom(t),"route"!==a.type&&w.fitBounds(e.initialBounds)}}),[w,a.world,a.type]);var Q=Object(i.useMemo)((function(){if(C&&t){var e=C.distance.findIndex((function(e){return e>1e3*t}));if(e)return C.latlng[e]}}),[C,t]);return Object(Ce.jsxs)("div",{className:xe.a.Container,children:[Object(Ce.jsx)(Be,{}),Object(Ce.jsxs)(O.a,{whenCreated:function(e){return y(e)},bounds:o.imageBounds,style:{backgroundColor:o.backgroundColor},maxZoom:19,className:xe.a.MapContainer,children:[Object(Ce.jsx)(h.a,{url:o.image,bounds:o.imageBounds,attribution:'&copy <a href="https://zwift.com" rel="noreferrer noopener">Zwift</a>'}),T&&Object(Ce.jsx)(v.a,{name:"preview-route",style:{zIndex:506},children:Object(Ce.jsx)(m.a,{positions:T.latlng,pathOptions:{color:"#D3D3D3",weight:5}})}),C&&Object(Ce.jsx)(v.a,{name:"route",style:{zIndex:504},children:Object(Ce.jsx)(m.a,{positions:C.latlng,pathOptions:{color:"#fc6719",weight:5}})}),I&&Object(Ce.jsx)(v.a,{name:"strava-activity",style:{zIndex:504},children:Object(Ce.jsx)(m.a,{positions:I.streams.latlng,pathOptions:{color:"#fc6719",weight:5}})}),u&&Object(Ce.jsx)(v.a,{name:"segments",style:{zIndex:505},children:null===u||void 0===u?void 0:u.map((function(e){return Object(Ce.jsx)(m.a,{positions:e.stravaData,pathOptions:{color:"#64ac39",weight:8}},e.slug)}))}),Q&&Object(Ce.jsx)(v.a,{name:"mouse-position",style:{zIndex:507},children:Object(Ce.jsx)(x.a,{center:Q,radius:15,pathOptions:{color:"black",fillColor:"black",fillOpacity:1}})})]},a.world.slug)]})}var Ie=n(107),Me=n(476),Ee=n(444),Te=n(231),Fe=n(477),Qe=n(478),Re=n(4),Ue=n.n(Re),He=n(465),Le=n(487),Ne=n(442),We=n(464),ze=n(431),Pe=n(459),Ge=n(460),Je=n(461),Ye=n(462),Ze=n(454),Ve=n(463),Xe=n(458),qe=n(453),Ke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACXlBMVEX/awD/agD/aQD/aAD/ZwD/ZQD/ZAD/YgD/YQD/YAD/XwD/XQD/XAD/WgD/WQD/VwD/VgD/VAD/UwD/UQD/WwD/UgD/UAD/XgD/gjj/eCr/TwD/TgD/Zgv/z7T/vJb/XgL/j07/+vf/8Oj/fTT/z7P/////vJj/XAP/TQD/TAD/kVD/+fb/8en/fTf/ZQz/0bb/vZr/WgT/kFD/8uv/fjr/VQD/waD/WQX/SwD/klP/9O3/fz3/ZQ7/0rn/w6T/WAb/SgD/klb//f3//v3/9O//gEL/0rr/y7H/1L//xan/Vgj/SQD/fj3/ilD/9vH/gEX/ZA//07z/WAX/Wwv/zbX/x63/Vgn/WAD/k1r/+/n/f0D/iE//+PX/9/P/gkr/ZBD/1b7/waL/WQr/yrD/ya//VQr/lFr/8+3/fT7/hEn/hE3/ZBH/1L3/vp7/VwX/UgH/Vwn/xqr//fz/yrH/VQz/TAH/SwH/ZBP/kVj/lV7/k17/kl3/bCP/Yxj/jlf/kFr/j1r/nGz/kF//i1j/iVb/iFT/jln/jVn/jVr/h1H/Vg//Wgv/nm7/tpH/tZD/rYX/aCT/SAD/dDb/sIr/so7/s4//j13/TQT/dTT/sYv/sYz/sY3/k2D/UAX/Vg3/nXD/sIz/qoL/ZSP/Vgr/mmr/sIv/rIX/ayj/dzv/jFj/TAP/cS//rof/kl//WxP/qoH/ZCL/Ugj/l2b/q4T/lGH/roj/by//qYD/YyD/Ugf/lmX/ilT/SwL/bCv/qH//YR3/TwX/iVP/aSj/TQX/kV//aSn/pHn/YR7/Tgf/ayv0qRl1AAAAAWJLR0QlwwHJDwAAAAd0SU1FB+UECw4ZCUCePeYAAAJ3SURBVDjLjdTnX9NAGMDxsypim66kabXFgXraiFvRqijR4jz3qgPce6EoOHDj3hFxEEcdVxXBvTdu/yvvujIuH/FetHnx/fyaNs9TAOhpZbPZWrchp21OTrvc3PZ2u8Ph4JxOl9vt9ni9Xl4Q/uF8WecVU7ClHnUC6+yWzs+4QIeOHOuCIaaX16lzFwsXAqb7c3TN79bd6TN9bigJ9S6Q1wPCnr2YXlgCxu/L9S6AsE9ft6kXliRgcIF+/SE5AwaaewQafj/foAIKBw8pNPVSUPudU0EIhw4z9aQI0Dvf8PwUHDFSNPYiBGqOKxoF02d0MW/oRWSge76+MTQ4NkpeSsYFDT1ZBprjisbT2ISJ9HXSZENPRkCbF2cyWDJlKv3m06YH9T2EgDZXM2Ym727W7Dn0fe48g0Mg62LzF9DgQlFcVEouyhZLekdgZk6XLKWhZcVefvkKerVyld4hkJn72GoaXLNW5MXgujJyWbpeJizjEEj3XBs2wmgUbtrMl5cLW7bCigq4bbtUWVmVdgSm5j62Y+eu3dXVe0Rh7779Bw4eqjl8pOboseMnTqIMzOyHp5A+C1H0nzp95uy58wpSLtRerLt0WQdNc++/crVevXY9cuOmGr91W9Egsx937qo4cQ/dr8XqgwaUhRyzH+GHjVhtekSCj58oGmT3Lfz0mYqfv3hpCBLoYvYj8qoR4ziOv36j6CC7b5L09p2KMVbff0A6yO6bJMkfExjXf/qsGKGH2Q/5S5OK1eYqZIBMjzxf9DVhCiLA9ugcfPte16y/QwItemQOlB8/fykMZHrk/P7TgMyQ7VkdwFv1rKDwfy4J6f9kSw79BReDIgKN7zeEAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIxLTA0LTExVDE0OjI0OjUyKzAwOjAwCFzYFAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMS0wNC0xMVQxNDoyNDozMiswMDowML9uaS8AAAAASUVORK5CYII=",_e="settings",$e=[];function et(){try{var e,t,n,r=null!==(e=localStorage.getItem(_e))&&void 0!==e?e:"{}",a=JSON.parse(r);return{sport:null!==(t=a.sport)&&void 0!==t?t:"cycling",units:null!==(n=a.units)&&void 0!==n?n:"metric"}}catch(i){return{sport:"cycling",units:"metric"}}}function tt(){var e=Object(i.useState)(et),t=Object(A.a)(e,2),n=t[0],r=t[1];Object(i.useEffect)((function(){var e=function(e){return r(e)};return $e.push(e),function(){$e.splice($e.indexOf(e),1)}}),[n]);var a=Object(i.useCallback)((function(e){r(e),function(e){localStorage.setItem(_e,JSON.stringify(e))}(e),$e.forEach((function(t){return t(e)}))}),[]);return[n,a]}var nt=new Intl.NumberFormat("en-US",{minimumFractionDigits:1,maximumFractionDigits:1,style:"decimal"}),rt=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0,style:"decimal"});function at(e){var t=e.distance,n=tt();switch(Object(A.a)(n,1)[0].units){case"imperial":var r=t/1.609;return r<.3?Object(Ce.jsxs)(Ce.Fragment,{children:[rt.format(5280*r),"ft"]}):Object(Ce.jsxs)(Ce.Fragment,{children:[nt.format(r),"mi"]});case"metric":return t<1?Object(Ce.jsxs)(Ce.Fragment,{children:[rt.format(1e3*t),"m"]}):Object(Ce.jsxs)(Ce.Fragment,{children:[nt.format(t),"km"]})}}var it=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0,style:"decimal"});function ct(e){var t=e.elevation,n=tt();switch(Object(A.a)(n,1)[0].units){case"imperial":return Object(Ce.jsxs)(Ce.Fragment,{children:[it.format(3.28084*t),"ft"]});case"metric":return Object(Ce.jsxs)(Ce.Fragment,{children:[it.format(t),"m"]})}}var ot=n(139),st=n.n(ot),At=n(447),ut=n(448),lt=n(452),dt=n(246),jt=n(247),bt=n(119),ft=n(256);function pt(){return Object(Ce.jsxs)("linearGradient",{id:"colorElevation",x1:"0",y1:"0",x2:"0",y2:"1",children:[Object(Ce.jsx)("stop",{offset:"5%",stopColor:"black",stopOpacity:.8}),Object(Ce.jsx)("stop",{offset:"95%",stopColor:"black",stopOpacity:0})]})}var gt=["altitude","distance"];function Ot(e){var t=e.route,n=e.onMouseHoverDistanceChange,r=Object(g.a)(he,[t.slug,"routes",gt]).result,a=Object(i.useState)(void 0),c=Object(A.a)(a,2),o=c[0],s=c[1],u=function(e){n(null===e||void 0===e?void 0:e.distance),s(e)},l=Object(i.useMemo)((function(){if(void 0!==r)return st()(r.distance.map((function(e,t){return{distance:Math.round(e/10)/100,elevation:r.altitude[t]}})),(function(e,t){return e.distance===t.distance}))}),[r]);return void 0===l?null:Object(Ce.jsxs)("div",{style:{width:"100%",height:100,marginBottom:"1em"},children:[Object(Ce.jsx)(At.a,{width:"100%",height:"100%",children:Object(Ce.jsxs)(ut.a,{data:l,margin:{top:25,right:15,left:15,bottom:15},baseValue:"dataMin",children:[Object(Ce.jsx)("defs",{children:Object(Ce.jsx)(pt,{})}),Object(Ce.jsx)(lt.a,{vertical:!1}),Object(Ce.jsx)(dt.a,{name:"Distance",dataKey:"distance",type:"number",allowDecimals:!1,tick:!1,unit:"km",domain:[0,"dataMax"],hide:!0}),Object(Ce.jsx)(jt.a,{name:"Elevation",type:"number",allowDecimals:!1,tickCount:5,domain:["dataMin","auto"],unit:"m",hide:!0}),Object(Ce.jsx)(bt.a,{content:function(e){return Object(Ce.jsx)(ht,Object(b.a)(Object(b.a)({},e),{},{onMouseMove:u}))},isAnimationActive:!1,position:{y:10},cursor:{stroke:"black"}}),Object(Ce.jsx)(ft.a,{type:"monotone",dataKey:"elevation",name:"Elevation",stroke:"black",fillOpacity:1,fill:"url(#colorElevation)",unit:"m",isAnimationActive:!1})]})}),Object(Ce.jsxs)("div",{style:{display:"flex",gap:"1em"},children:[Object(Ce.jsxs)(qe.a,{type:"body-2",style:{whiteSpace:"nowrap"},children:["Distance:"," ",(null===o||void 0===o?void 0:o.distance)?Object(Ce.jsx)(at,{distance:o.distance}):"- km"]}),Object(Ce.jsxs)(qe.a,{type:"body-2",style:{whiteSpace:"nowrap"},children:["Altitude:"," ",(null===o||void 0===o?void 0:o.altitude)?Object(Ce.jsx)(ct,{elevation:o.altitude}):"- m"]})]})]})}function ht(e){return Object(i.useEffect)((function(){void 0===e.payload||0===e.payload.length?e.onMouseMove(void 0):e.onMouseMove({distance:e.payload[0].payload.distance,altitude:e.payload[0].payload.elevation})}),[e]),null}var vt,mt,xt,wt=n(493),yt=n(248),kt=n.n(yt);function Ct(){return Dt.apply(this,arguments)}function Dt(){return(Dt=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(vt){e.next=4;break}return e.next=3,H.a.get("https://us-or-rly101.zwift.com/api/public/events/upcoming").then((function(e){return e.data}));case 3:vt=e.sent;case 4:return e.next=6,vt;case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Bt(e){var t=e.route,n=Object(g.a)(Ct,[]).result,r=Object(i.useMemo)((function(){if(n)return n.filter((function(e){var n=[e.routeId].concat(Object(R.a)(e.eventSubgroups.map((function(e){return e.routeId}))));return t.id&&n.includes(t.id)})).sort((function(e,t){return e.eventStart.localeCompare(t.eventStart)}))}),[n,t]);return void 0===r?Object(Ce.jsx)(Te.a,{children:Object(Ce.jsx)(wt.a,{id:"loading-events",small:!0,circleStyle:{stroke:"black"}})}):0===r.length?Object(Ce.jsx)(Te.a,{children:Object(Ce.jsx)(qe.a,{type:"body-2",children:"No events on this route today."})}):Object(Ce.jsxs)(Ce.Fragment,{children:[r.slice(0,3).map((function(e){var t;return Object(Ce.jsx)(ze.a,{onClick:function(){return window.open("http://zwift.com/events/view/".concat(e.id),"_blank")},rightAddon:Object(Ce.jsx)(Ze.a,{}),rightAddonType:"icon",secondaryText:Object(Ce.jsxs)(Ce.Fragment,{children:[new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",weekday:"short"}).format(Date.parse(e.eventStart)),Object(Ce.jsx)("br",{}),null!==(t=St[e.eventType])&&void 0!==t?t:e.eventType," |\xa0",0!==e.distanceInMeters?Object(Ce.jsx)(at,{distance:e.distanceInMeters/1e3}):e.durationInSeconds>0?Object(Ce.jsxs)(Ce.Fragment,{children:[kt()(e.durationInSeconds)/60,"min"]}):Object(Ce.jsx)(Ce.Fragment,{children:1===e.laps?"1 lap":"".concat(e.laps," laps")})]}),threeLines:!0,children:e.name},e.id)})),r.length>3&&Object(Ce.jsx)(Te.a,{children:Object(Ce.jsxs)(qe.a,{type:"body-2",children:[r.length-3," more"," ",4===r.length?"event":"events"," happening today"]})})]})}!function(e){e.CullingEventOnly="CULLING_EVENT_ONLY",e.CullingEverybody="CULLING_EVERYBODY",e.CullingSubgroupOnly="CULLING_SUBGROUP_ONLY"}(mt||(mt={})),function(e){e.TourOfWatopiaRideStage5="Tour of Watopia - Ride Stage 5",e.TourOfWatopiaRunStage5="Tour of Watopia - Run Stage 5"}(xt||(xt={}));var St={GROUP_RIDE:"Group Ride",GROUP_WORKOUT:"Workout",RACE:"Race",TIME_TRIAL:"Time Trial"},It=n(455),Mt=n(456);function Et(e){var t=e.seconds,n=t%60,r=(t-n)/60%60,a=((t-n)/60-r)/60;return 0===a?0===r?Object(Ce.jsxs)(Ce.Fragment,{children:[n,"s"]}):Object(Ce.jsxs)(Ce.Fragment,{children:[r,":",n.toString().padStart(2,"0"),"min"]}):Object(Ce.jsxs)(Ce.Fragment,{children:[a,":",r.toString().padStart(2,"0"),":",n.toString().padStart(2,"0"),"h"]})}function Tt(e){var t=e.route,n=E(),r=Object(A.a)(n,2),a=r[0],i=r[1],c=S.b.filter((function(e){return e.world===t.world})).filter((function(e){return t.segments.includes(e.slug)})).sort((function(e,t){return e.name.localeCompare(t.name)}));if(0===c.length)return Object(Ce.jsx)(Te.a,{children:Object(Ce.jsx)(qe.a,{type:"body-2",children:"No segments on this route."})});var o=a.segments;return Object(Ce.jsx)(Ce.Fragment,{children:c.map((function(e){return Object(Ce.jsx)(ze.a,{disabled:void 0===e.stravaSegmentId,rightAddonType:"icon",rightAddon:void 0===e.stravaSegmentId?null:o.includes(e)?Object(Ce.jsx)(It.a,{}):Object(Ce.jsx)(Mt.a,{}),secondaryText:Object(Ce.jsx)(Ft,{segment:e}),threeLines:!0,onClick:function(){void 0!==e.stravaSegmentId&&(o.includes(e)?i(Object(b.a)(Object(b.a)({},a),{},{type:"route",route:a.route,segments:o.filter((function(t){return t!==e}))})):i(Object(b.a)(Object(b.a)({},a),{},{type:"route",route:a.route,segments:[].concat(Object(R.a)(o),[e])})))},children:e.name},e.slug)}))})}function Ft(e){var t,n=e.segment,r=B(),a=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t&&n){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,oe(t.toString());case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[n.stravaSegmentId,r]),i=a.result,c=(null!==(t=null===i||void 0===i?void 0:i.athlete_segment_stats.effort_count)&&void 0!==t?t:0)>0?null===i||void 0===i?void 0:i.athlete_segment_stats.pr_elapsed_time:null;return Object(Ce.jsxs)(Ce.Fragment,{children:[Object(Ce.jsx)(at,{distance:n.distance}),n.avgIncline&&Object(Ce.jsxs)(Ce.Fragment,{children:[" ","|"," ",new Intl.NumberFormat("en-US",{minimumFractionDigits:1,maximumFractionDigits:1,style:"percent"}).format(n.avgIncline/100)]}),Object(Ce.jsx)("br",{}),c?Object(Ce.jsxs)(Ce.Fragment,{children:["PB: ",Object(Ce.jsx)(Et,{seconds:c})]}):Qt[n.type]]})}var Qt={climb:"Climb",sprint:"Sprint",segment:"Segment"},Rt=n(457);function Ut(e){var t=e.route,n=B(),r=Object(g.a)(function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&void 0!==n){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,oe(n.toString());case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[n,t.stravaSegmentId]),a=r.result,i=r.loading,c=r.error;if(i)return Object(Ce.jsx)(Te.a,{leftAddon:Object(Ce.jsx)(Rt.a,{}),leftAddonType:"icon",rightAddon:Object(Ce.jsx)(Xe.a,{}),rightAddonType:"icon",children:Object(Ce.jsx)(wt.a,{id:"strava-route-pb-".concat(t.id),circleStyle:{stroke:"black"},small:!0})});if(c||null===a||void 0===a)return null;return Object(Ce.jsx)(ze.a,{leftAddon:Object(Ce.jsx)(Rt.a,{}),leftAddonType:"icon",rightAddon:Object(Ce.jsx)(Xe.a,{}),rightAddonType:"icon",onClick:function(){window.open("https://www.strava.com/segments/".concat(a.id),"_blank")},children:0===a.athlete_segment_stats.effort_count?Object(Ce.jsx)(Ce.Fragment,{children:"No time set"}):Object(Ce.jsx)(Et,{seconds:a.athlete_segment_stats.pr_elapsed_time})})}function Ht(e){var t=e.route,n=e.onMouseHoverDistanceChange,r=e.backButtonText,a=e.onBackButtonClick,i=S.c.find((function(e){return e.slug===t.world}));return Object(Ce.jsxs)(Ee.a,{children:[Object(Ce.jsx)(Te.a,{children:Object(Ce.jsx)(Le.a,{themeType:"outline",onClick:a,children:Object(Ce.jsx)(Ne.a,{icon:Object(Ce.jsx)(Pe.a,{}),children:r})})}),Object(Ce.jsx)(Te.a,{children:Object(Ce.jsx)(qe.a,{type:"headline-6",style:{margin:0},children:t.name})}),Object(Ce.jsxs)(Te.a,{clickable:!1,leftAddon:Object(Ce.jsx)(Ge.a,{}),leftAddonType:"icon",children:[Object(Ce.jsx)(at,{distance:t.distance}),void 0!==t.leadInDistance&&Object(Ce.jsxs)(Ce.Fragment,{children:["\xa0",Object(Ce.jsxs)("small",{children:["(+",Object(Ce.jsx)(at,{distance:t.leadInDistance}),")"]})]})]}),Object(Ce.jsxs)(Te.a,{clickable:!1,leftAddon:Object(Ce.jsx)(Je.a,{}),leftAddonType:"icon",children:[Object(Ce.jsx)(ct,{elevation:t.elevation}),void 0!==t.leadInElevation&&Object(Ce.jsxs)(Ce.Fragment,{children:["\xa0",Object(Ce.jsxs)("small",{children:["(+",Object(Ce.jsx)(ct,{elevation:t.leadInElevation}),")"]})]})]}),t.experience&&Object(Ce.jsxs)(Te.a,{clickable:!1,leftAddon:Object(Ce.jsx)(Ye.a,{}),leftAddonType:"icon",children:[t.experience,"XP"]}),t.eventOnly&&Object(Ce.jsx)(Te.a,{clickable:!1,leftAddon:Object(Ce.jsx)(Ze.a,{}),leftAddonType:"icon",children:"Event only route"}),Object(Ce.jsx)(Te.a,{clickable:!1,leftAddon:Object(Ce.jsx)(Ve.a,{}),children:i.name}),Object(Ce.jsx)(Ut,{route:t}),Object(Ce.jsx)(Te.a,{children:Object(Ce.jsx)(Ot,{route:t,onMouseHoverDistanceChange:n})}),Object(Ce.jsx)(We.a,{children:"Upcoming Events"}),Object(Ce.jsx)(Bt,{route:t}),Object(Ce.jsx)(We.a,{children:"Segments"}),Object(Ce.jsx)(Tt,{route:t}),Object(Ce.jsx)(We.a,{children:"Links"}),t.zwiftInsiderUrl&&Object(Ce.jsx)(ze.a,{onClick:function(){return window.open(t.zwiftInsiderUrl,"_blank")},leftAddon:Object(Ce.jsx)(He.a,{color:"#fc6719",children:Object(Ce.jsx)("img",{src:"data:image/jpeg;base64,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",alt:""})}),leftAddonType:"avatar",rightAddon:Object(Ce.jsx)(Xe.a,{}),rightAddonType:"icon",children:"ZwiftInsider"}),t.stravaSegmentUrl&&Object(Ce.jsx)(ze.a,{onClick:function(){return window.open(t.stravaSegmentUrl,"_blank")},leftAddon:Object(Ce.jsx)(He.a,{color:"#ff6b00",children:Object(Ce.jsx)("img",{src:Ke,alt:""})}),leftAddonType:"avatar",rightAddon:Object(Ce.jsx)(Xe.a,{}),rightAddonType:"icon",children:"Strava Segment"}),t.whatsOnZwiftUrl&&Object(Ce.jsx)(ze.a,{onClick:function(){return window.open(t.whatsOnZwiftUrl,"_blank")},leftAddon:Object(Ce.jsx)(He.a,{color:"#000000",children:Object(Ce.jsx)("img",{src:"data:image/png;base64,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",alt:""})}),leftAddonType:"avatar",rightAddon:Object(Ce.jsx)(Xe.a,{}),rightAddonType:"icon",children:"What's on Zwift"})]})}function Lt(e){var t=e.activityId;return B()?Object(Ce.jsx)(Nt,{activityId:t}):Object(Ce.jsx)(Ee.a,{children:Object(Ce.jsx)(ze.a,{leftAddon:Object(Ce.jsx)(He.a,{color:"#ff6b00",children:Object(Ce.jsx)("img",{src:Ke,alt:""})}),leftAddonType:"avatar",rightAddon:Object(Ce.jsx)(Xe.a,{}),rightAddonType:"icon",secondaryText:"\u2026to view Strava activity",onClick:P,children:"Authorize Strava App\u2026"})})}function Nt(e){var t=e.activityId,n=E(),r=Object(A.a)(n,2),a=r[0],i=r[1],c=Object(g.a)(le,[t]),o=c.result,s=c.loading;return o?Object(Ce.jsxs)(Ee.a,{children:[Object(Ce.jsx)(Te.a,{children:Object(Ce.jsx)(Le.a,{themeType:"outline",onClick:function(){i({world:a.world,query:a.query,type:"strava-activities"})},children:Object(Ce.jsx)(Ne.a,{icon:Object(Ce.jsx)(Pe.a,{}),children:"Strava activities"})})}),Object(Ce.jsx)(Te.a,{children:Object(Ce.jsx)(qe.a,{type:"headline-6",style:{margin:0},children:o.name})}),Object(Ce.jsx)(Te.a,{clickable:!1,leftAddon:Object(Ce.jsx)(Rt.a,{}),leftAddonType:"icon",children:Object(Ce.jsx)(Et,{seconds:o.time})}),Object(Ce.jsx)(Te.a,{clickable:!1,leftAddon:Object(Ce.jsx)(Ge.a,{}),leftAddonType:"icon",children:Object(Ce.jsx)(at,{distance:o.distance})}),Object(Ce.jsx)(Te.a,{clickable:!1,leftAddon:Object(Ce.jsx)(Je.a,{}),leftAddonType:"icon",children:Object(Ce.jsx)(ct,{elevation:o.elevation})}),Object(Ce.jsx)(Te.a,{clickable:!1,leftAddon:Object(Ce.jsx)(Ve.a,{}),children:o.world.name}),Object(Ce.jsx)(We.a,{children:"Links"}),Object(Ce.jsx)(ze.a,{onClick:function(){return window.open("https://www.strava.com/activities/".concat(o.id),"_blank")},leftAddon:Object(Ce.jsx)(He.a,{color:"#000000",children:Object(Ce.jsx)("img",{src:Ke,alt:""})}),leftAddonType:"avatar",rightAddon:Object(Ce.jsx)(Xe.a,{}),rightAddonType:"icon",children:"Activity on Strava"})]}):s?Object(Ce.jsx)(wt.a,{id:"strava-activity-".concat(t),circleStyle:{stroke:"black"}}):Object(Ce.jsx)(Ee.a,{children:Object(Ce.jsx)(Te.a,{secondaryText:"Make sure you can access the activity and it was recorded in Zwift.",threeLines:!0,children:"An error occurred"})})}function Wt(e){e.world;return null}function zt(e){var t=e.onMouseHoverDistanceChange,n=e.backButtonText,r=e.onBackButtonClick,a=E(),i=Object(A.a)(a,1)[0];return"route"===i.type?Object(Ce.jsx)(Ht,{route:i.route,onMouseHoverDistanceChange:t,backButtonText:n,onBackButtonClick:r}):"strava-activity"===i.type?Object(Ce.jsx)(Lt,{activityId:i.stravaActivityId}):Object(Ce.jsx)(Wt,{world:i.world})}var Pt=n(48),Gt=n.n(Pt),Jt=n(471),Yt=n(472),Zt=n(474),Vt=n(475),Xt=n(483),qt=n(473),Kt=n(430),_t=n(441),$t=n(249);var en=n(481),tn=n(466),nn=n(467),rn=n(468),an=n(469),cn=n(250),on=n.n(cn);function sn(e){var t=e.visible,n=e.onClose;return Object(Ce.jsxs)(en.a,{id:"info-dialog","aria-labelledby":"info-dialog-title",visible:t,onRequestClose:n,className:on.a.Dialog,children:[Object(Ce.jsx)(tn.a,{style:{paddingBottom:0},children:Object(Ce.jsx)(nn.a,{id:"info-dialog-title",children:"Zwift Map"})}),Object(Ce.jsxs)(rn.a,{children:[Object(Ce.jsx)(qe.a,{children:"ZwiftMap is a fan project created by Andi P\xe4tzold."}),Object(Ce.jsxs)(qe.a,{children:["All code is open source and available on"," ",Object(Ce.jsx)("a",{href:"https://github.com/andipaetzold/zwiftmap",rel:"noreferrer noopener",target:"_blank",children:"GitHub"}),"."]}),Object(Ce.jsxs)(qe.a,{children:["Route and Segment Information is collected and combined from:"," "]}),Object(Ce.jsxs)("ul",{children:[Object(Ce.jsx)("li",{children:Object(Ce.jsx)("a",{href:"https://strava.com",rel:"noreferrer noopener",target:"_blank",children:"Strava"})}),Object(Ce.jsx)("li",{children:Object(Ce.jsx)("a",{href:"https://whatsonzwift.com",rel:"noreferrer noopener",target:"_blank",children:"What's on Zwift"})}),Object(Ce.jsx)("li",{children:Object(Ce.jsx)("a",{href:"https://zwift.com",rel:"noreferrer noopener",target:"_blank",children:"Zwift"})}),Object(Ce.jsx)("li",{children:Object(Ce.jsx)("a",{href:"https://zwifthub.com",rel:"noreferrer noopener",target:"_blank",children:"ZwiftHub"})}),Object(Ce.jsx)("li",{children:Object(Ce.jsx)("a",{href:"https://zwiftpower.com",rel:"noreferrer noopener",target:"_blank",children:"Zwift Power"})})]}),Object(Ce.jsxs)(qe.a,{children:["World maps were created by",Object(Ce.jsx)("a",{href:"https://zwift.com",rel:"noreferrer noopener",target:"_blank",children:"Zwift"}),"."]}),Object(Ce.jsx)(qe.a,{children:"ZwiftMap does not collect, analyze or store any sensitive information. The app only uses data required for the operation and monitoring."}),Object(Ce.jsx)(qe.a,{type:"headline-6",style:{margin:0},children:"Contact"}),Object(Ce.jsxs)(qe.a,{children:["Andi P\xe4tzold",Object(Ce.jsx)("br",{}),Object(Ce.jsx)("a",{href:"mainto:info@zwiftmap.com",rel:"noreferrer noopener",target:"_blank",children:"info@zwiftmap.com"}),Object(Ce.jsx)("br",{}),"Support this project via"," ",Object(Ce.jsx)("a",{href:"https://paypal.me/andipaetzold",rel:"noreferrer noopener",target:"_blank",children:"PayPal"})]})]}),Object(Ce.jsx)(an.a,{children:Object(Ce.jsx)(Le.a,{id:"dialog-close",onClick:n,children:"Close"})})]})}var An=n(470),un=n(486);function ln(e){var t=e.visible,n=e.onClose,r=tt(),a=Object(A.a)(r,2),i=a[0],c=a[1],o=function(e){e.target.checked&&c(Object(b.a)(Object(b.a)({},i),{},{sport:e.target.value}))},s=function(e){e.target.checked&&c(Object(b.a)(Object(b.a)({},i),{},{units:e.target.value}))};return Object(Ce.jsxs)(en.a,{id:"settings-dialog","aria-labelledby":"settings-dialog-title",visible:t,onRequestClose:n,children:[Object(Ce.jsx)(tn.a,{style:{paddingBottom:0},children:Object(Ce.jsx)(nn.a,{id:"settings-dialog-title",children:"Settings"})}),Object(Ce.jsxs)(rn.a,{children:[Object(Ce.jsxs)(An.a,{legend:"Sport",children:[Object(Ce.jsx)(un.a,{id:"settings-dialog-cycling",name:"settings-dialog-sport",label:"Cycling",value:"cycling",checked:"cycling"===i.sport,onChange:o}),Object(Ce.jsx)(un.a,{id:"settings-dialog-running",name:"settings-dialog-sport",label:"Running",value:"running",checked:"running"===i.sport,onChange:o})]}),Object(Ce.jsxs)(An.a,{legend:"Units",children:[Object(Ce.jsx)(un.a,{id:"settings-dialog-metric",name:"settings-dialog-units",label:"Metric",value:"metric",checked:"metric"===i.units,onChange:s}),Object(Ce.jsx)(un.a,{id:"settings-dialog-imperial",name:"settings-dialog-units",label:"Imperial",value:"imperial",checked:"imperial"===i.units,onChange:s})]})]}),Object(Ce.jsx)(an.a,{children:Object(Ce.jsx)(Le.a,{id:"dialog-close",onClick:n,children:"Close"})})]})}function dn(e){var t=e.onBottomSheetClose,n=Object(i.useRef)(null),r=Object(i.useState)(!1),a=Object(A.a)(r,2),c=a[0],o=a[1],s=Object(Kt.a)(!1),u=Object(A.a)(s,3),l=u[0],d=u[1],j=u[2],b=Object(Kt.a)(!1),f=Object(A.a)(b,3),p=f[0],g=f[1],O=f[2],h=Object($t.useMediaQuery)({query:"(max-width: 750px)"}),v=B();return Object(Ce.jsxs)(Ce.Fragment,{children:[Object(Ce.jsx)(ze.a,{onClick:function(e){e.stopPropagation(),o(!c)},rightAddon:h?Object(Ce.jsx)(Jt.a,{}):Object(Ce.jsx)(Yt.a,{}),rightAddonType:"icon",id:"sidebar-menu",ref:n,children:"Menu"}),Object(Ce.jsx)(Xt.a,{id:"sidebar-menu",controlId:"sidebar-menu",visible:c,onRequestClose:function(){return o(!1)},"aria-labelledby":"sidebar-menu",anchor:_t.b,portal:!0,children:Object(Ce.jsxs)(Ee.a,{children:[Object(Ce.jsx)(qt.a,{onClick:function(){g(),t()},leftAddon:Object(Ce.jsx)(Zt.a,{}),leftAddonType:"icon",children:"Info"}),Object(Ce.jsx)(qt.a,{onClick:function(){d(),t()},leftAddon:Object(Ce.jsx)(Vt.a,{}),leftAddonType:"icon",children:"Settings"}),Object(Ce.jsx)(Me.a,{}),v?Object(Ce.jsx)(qt.a,{onClick:function(){W()},children:"Logout from Strava"}):Object(Ce.jsx)(qt.a,{onClick:P,children:"Login to Strava"})]})}),Object(Ce.jsx)(ln,{visible:l,onClose:j}),Object(Ce.jsx)(sn,{visible:p,onClose:O})]})}var jn=["altitude","distance"];function bn(e){var t=e.route,n=Object(g.a)(he,[t.slug,"routes",jn]).result,r=Object(i.useMemo)((function(){if(void 0!==n){var e=st()(n.distance.map((function(e,t){return{distance:Math.round(e/100)/10,elevation:n.altitude[t]}})),(function(e,t){return e.distance===t.distance})),t=Math.min.apply(Math,Object(R.a)(e.map((function(e){return e.elevation}))));return e.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{elevation:e.elevation-t})}))}}),[n]);return r?Object(Ce.jsxs)(ut.a,{height:50,width:100,data:r,baseValue:"dataMin",children:[Object(Ce.jsx)("defs",{children:Object(Ce.jsx)(pt,{})}),Object(Ce.jsx)(dt.a,{dataKey:"distance",type:"number",domain:[0,"dataMax"],unit:"km",hide:!0}),Object(Ce.jsx)(jt.a,{dataKey:"elevation",type:"number",allowDecimals:!1,domain:[0,750],unit:"m",hide:!0}),Object(Ce.jsx)(ft.a,{type:"monotone",dataKey:"elevation",name:"Elevation",stroke:"black",fillOpacity:1,fill:"url(#colorElevation)",unit:"m",isAnimationActive:!1})]}):Object(Ce.jsx)(wt.a,{id:"elevation-preview-".concat(t.slug),small:!0,circleStyle:{stroke:"black"}})}function fn(e){var t=e.route,n=e.onHoverRoute,r=e.showWorldName,a=E(),i=Object(A.a)(a,2),c=i[0],o=i[1];return Object(Ce.jsx)(ze.a,{secondaryText:Object(Ce.jsx)(pn,{route:t,showWorldName:r}),threeLines:r,onClick:function(){o({world:S.c.find((function(e){return e.slug===t.world})),route:t,segments:[],query:c.query,type:"route"}),n(void 0)},rightAddonType:"large-media",rightAddon:Object(Ce.jsx)(gn,{route:t}),onMouseEnter:function(){return n(t.slug)},onMouseLeave:function(){return n(void 0)},children:t.name})}function pn(e){var t=e.route,n=e.showWorldName;return Object(Ce.jsxs)(Ce.Fragment,{children:[n&&Object(Ce.jsxs)(Ce.Fragment,{children:[S.c.find((function(e){return e.slug===t.world})).name,Object(Ce.jsx)("br",{})]}),Object(Ce.jsx)(at,{distance:t.distance})," |"," ",Object(Ce.jsx)(ct,{elevation:t.elevation})]})}function gn(e){var t=e.route,n=Object(i.useRef)(null),r=function(e){var t=Object(i.useState)(!1),n=Object(A.a)(t,2),r=n[0],a=n[1];return Object(i.useEffect)((function(){var t=e.current,n=new IntersectionObserver((function(e){var t=Object(A.a)(e,1)[0];a(t.isIntersecting)}));return t&&n.observe(t),function(){t&&n.unobserve(t)}}),[]),r}(n);return Object(Ce.jsx)("div",{ref:n,style:{width:"100%",pointerEvents:"none"},children:r?Object(Ce.jsx)(bn,{route:t}):null})}function On(e){var t=e.onHoverRoute,n=tt(),r=Object(A.a)(n,1)[0],a=E(),i=Object(A.a)(a,2),c=i[0],o=i[1],s=B();return Object(Ce.jsxs)(Ce.Fragment,{children:[s&&Object(Ce.jsxs)(Ce.Fragment,{children:[Object(Ce.jsx)(ze.a,{secondaryText:"Last 30 days",onClick:function(){o({world:c.world,query:"",type:"strava-activities"})},children:"Recent Strava Activities"}),Object(Ce.jsx)(Me.a,{})]}),S.a.filter((function(e){return e.world===c.world.slug})).filter((function(e){return e.sports.includes(r.sport)})).filter((function(e){return void 0!==e.stravaSegmentId})).sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return Object(Ce.jsx)(fn,{route:e,onHoverRoute:t,showWorldName:!1},e.slug)}))]})}var hn=n(494),vn=n(22);function mn(){var e=E(),t=Object(A.a)(e,2),n=t[0],r=t[1];return Object(Ce.jsx)(hn.a,{id:"search-input",style:{width:"100%"},placeholder:"Search for worlds and routes\u2026",value:n.query,onChange:function(e){r({world:n.world,type:"default",query:e.target.value})},isRightAddon:!1,rightChildren:""!==n.query&&Object(Ce.jsx)(Le.a,{buttonType:"icon",style:{right:0,position:"absolute"},onClick:function(){r(Object(b.a)(Object(b.a)({},n),{},{query:""}))},"aria-label":"Clear search field",children:Object(Ce.jsx)(vn.a,{children:"clear"})})})}var xn=/strava\.com\/activities\/(\d{10})/,wn=[].concat(Object(R.a)(Object(R.a)(S.c).sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return{type:"world",terms:[e.name].map((function(e){return e.toLocaleLowerCase()})),data:e}}))),Object(R.a)(Object(R.a)(S.a).sort((function(e,t){return e.name.localeCompare(t.name)})).filter((function(e){return void 0!==e.stravaSegmentId})).map((function(e){return{type:"route",terms:[S.c.find((function(t){return t.slug===e.world})).name,e.name].map((function(e){return e.toLocaleLowerCase()})),data:e}}))));var yn={world:{title:"Worlds"},route:{title:"Routes"},segment:{title:"Segments"},"strava-activity":{title:"Strava Activity"}};function kn(e){var t=e.activity,n=e.onHoverRoute;return B()?Object(Ce.jsx)(Cn,{activity:t,onHoverRoute:n}):Object(Ce.jsx)(ze.a,{leftAddon:Object(Ce.jsx)(He.a,{color:"#ff6b00",children:Object(Ce.jsx)("img",{src:Ke,alt:""})}),leftAddonType:"avatar",rightAddon:Object(Ce.jsx)(Xe.a,{}),rightAddonType:"icon",secondaryText:"\u2026to view Strava activity",onClick:P,children:"Authorize Strava App\u2026"})}function Cn(e){var t=e.activity.activityId,n=(e.onHoverRoute,Object(g.a)(le,[t])),r=n.result,a=n.loading,i=E(),c=Object(A.a)(i,2)[1];if(!r)return a?Object(Ce.jsx)(wt.a,{id:"strava-activity-".concat(t),circleStyle:{stroke:"black"}}):Object(Ce.jsx)(Te.a,{secondaryText:"Make sure you can access the activity and it was recorded in Zwift.",threeLines:!0,children:"An error occurred"});return Object(Ce.jsx)(ze.a,{onClick:function(){c({world:r.world,stravaActivityId:r.id,query:"",type:"strava-activity"})},secondaryText:Object(Ce.jsxs)(Ce.Fragment,{children:[Object(Ce.jsx)(at,{distance:r.distance})," |"," ",Object(Ce.jsx)(ct,{elevation:r.elevation}),Object(Ce.jsx)("br",{}),r.avgWatts&&Object(Ce.jsxs)(Ce.Fragment,{children:[Math.round(r.avgWatts),"W | "]}),Object(Ce.jsx)(Et,{seconds:r.time})]}),threeLines:!0,rightAddonType:r.photoUrl?"large-media":void 0,rightAddon:r.photoUrl?Object(Ce.jsx)("img",{src:r.photoUrl,alt:"",width:"100"}):void 0,children:r.name})}function Dn(e){var t=e.world,n=E(),r=Object(A.a)(n,2)[1],a=tt(),i=Object(A.a)(a,1)[0],c="".concat(S.a.filter((function(e){return e.sports.includes(i.sport)})).filter((function(e){return e.world===t.slug})).length," routes | ").concat(S.b.filter((function(e){return e.world===t.slug})).length," segments");return Object(Ce.jsx)(ze.a,{secondaryText:c,onClick:function(){r({world:t,query:"",type:"default"})},children:t.name})}function Bn(e){var t=e.onHoverRoute,n=E(),r=Object(A.a)(n,1)[0],a=tt(),c=Object(A.a)(a,1)[0],o=function(e,t){if(xn.test(e)){var n=xn.exec(e),r=Object(A.a)(n,2)[1];return[{type:"strava-activity",data:{activityId:r,slug:"strava-activity-".concat(r)}}]}var a=e.toLocaleLowerCase().split(" ").filter((function(e){return e.length>0}));return wn.filter((function(e){return"world"===e.type||"segment"===e.type||e.data.sports.includes(t)})).filter((function(e){return a.every((function(t){return e.terms.some((function(e){return e.includes(t)}))}))}))}(r.query,c.sport);return 0===o.length?Object(Ce.jsx)(Te.a,{children:"No worlds or routes found"}):Object(Ce.jsx)(Ce.Fragment,{children:o.map((function(e,n){var r;return Object(Ce.jsxs)(i.Fragment,{children:[(null===(r=o[n-1])||void 0===r?void 0:r.type)!==e.type&&Object(Ce.jsxs)(Ce.Fragment,{children:[o[n-1]&&Object(Ce.jsx)(Me.a,{}),Object(Ce.jsx)(We.a,{children:yn[e.type].title})]}),Object(Ce.jsx)(Sn,{searchResult:e,onHoverRoute:t})]},e.data.slug)}))})}function Sn(e){var t=e.searchResult,n=e.onHoverRoute;switch(t.type){case"world":return Object(Ce.jsx)(Dn,{world:t.data});case"route":return Object(Ce.jsx)(fn,{route:t.data,onHoverRoute:n,showWorldName:!0});case"strava-activity":return Object(Ce.jsx)(kn,{activity:t.data,onHoverRoute:n});default:return null}}var In=(new Date).getTime()/1e3;function Mn(){var e=E(),t=Object(A.a)(e,2),n=t[0],r=t[1],a=Object(g.a)(Object(f.a)(j.a.mark((function e(){var t,n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=1,r=[];case 3:return e.next=5,Ae({after:In-2592e3,per_page:30,page:n});case 5:r=e.sent,t.push.apply(t,Object(R.a)(r)),++n;case 8:if(30===r.length){e.next=3;break}case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e)}))),[]).result;return Object(Ce.jsxs)(Ee.a,{children:[Object(Ce.jsx)(Te.a,{children:Object(Ce.jsx)(Le.a,{themeType:"outline",onClick:function(){r({world:n.world,query:"",type:"default"})},children:Object(Ce.jsx)(Ne.a,{icon:Object(Ce.jsx)(Pe.a,{}),children:"Route List"})})}),Object(Ce.jsx)(We.a,{children:"Recent Strava Activities"}),void 0===a&&Object(Ce.jsx)(Te.a,{children:Object(Ce.jsx)(wt.a,{id:"strava-activities",circleStyle:{stroke:"black"}})}),void 0!==a&&Object(R.a)(a).sort((function(e,t){return-e.start_date.localeCompare(t.start_date)})).map((function(e){return{world:Q(e),activity:e}})).filter((function(e){return void 0!==e.world})).map((function(e){var t=e.world,n=e.activity;return Object(Ce.jsx)(ze.a,{onClick:function(){r({world:t,query:"",type:"strava-activity",stravaActivityId:n.id.toString()})},secondaryText:Object(Ce.jsxs)(Ce.Fragment,{children:[Object(Ce.jsx)(at,{distance:n.distance/1e3})," |"," ",Object(Ce.jsx)(ct,{elevation:n.total_elevation_gain}),Object(Ce.jsx)("br",{}),n.average_watts&&Object(Ce.jsxs)(Ce.Fragment,{children:[Math.round(n.average_watts),"W | "]}),Object(Ce.jsx)(Et,{seconds:n.moving_time})]}),threeLines:!0,children:n.name},n.id)}))]})}function En(e){var t=e.onMouseHoverDistanceChange,n=e.onHoverRoute,r=Object(i.useState)(!1),a=Object(A.a)(r,2),c=a[0],o=a[1],s=E(),u=Object(A.a)(s,2),l=u[0],d=u[1],j=Object(i.useRef)(null);return Object(Ce.jsxs)(Ce.Fragment,{children:[Object(Ce.jsxs)("div",{className:Ue()(Gt.a.Container,Object(Ie.a)({},Gt.a.BottomSheetOpen,c)),ref:j,children:[Object(Ce.jsx)("button",{className:Gt.a.DragHandle,onClick:function(){return o(!1)},children:Object(Ce.jsx)(Fe.a,{})}),Object(Ce.jsxs)(Ee.a,{className:Gt.a.SearchBox,children:[Object(Ce.jsx)(Te.a,{children:Object(Ce.jsx)(mn,{})}),Object(Ce.jsx)(Me.a,{className:Gt.a.NoGapDivider})]}),Object(Ce.jsx)("div",{className:Gt.a.Content,children:"route"===l.type||"strava-activity"===l.type?Object(Ce.jsx)(zt,{onMouseHoverDistanceChange:t,backButtonText:""===l.query?"Route List":"Search Results",onBackButtonClick:function(){d({world:l.world,query:l.query,type:"default"})}}):"strava-activities"===l.type?Object(Ce.jsx)(Mn,{}):Object(Ce.jsx)(Ee.a,{children:""===l.query?Object(Ce.jsx)(On,{onHoverRoute:n}):Object(Ce.jsx)(Bn,{onHoverRoute:n})})}),Object(Ce.jsxs)(Ee.a,{className:Gt.a.BottomMenu,children:[Object(Ce.jsx)(Me.a,{className:Gt.a.NoGapDivider}),Object(Ce.jsx)(dn,{onBottomSheetClose:function(){return o(!1)}})]})]}),Object(Ce.jsx)("button",{className:Ue()(Gt.a.DragHandle,Gt.a.DragHandleBottom,Object(Ie.a)({},Gt.a.BottomSheetOpen,c)),onClick:function(){return o(!0)},children:Object(Ce.jsx)(Qe.a,{})})]})}function Tn(){Object(i.useEffect)((function(){try{H.a.get("".concat("https://api.zwiftmap.com","/ping"))}catch(e){}}),[]),function(){var e=Object(i.useCallback)((function(){var e=new URLSearchParams(window.location.search);e.has("strava-auth")&&(N(JSON.parse(e.get("strava-auth"))),e.delete("strava-auth"),window.history.replaceState(void 0,"","".concat(window.location.origin).concat(window.location.pathname,"?").concat(e.toString())))}),[]);Object(i.useEffect)((function(){e()}),[e]),Object(i.useEffect)((function(){return window.addEventListener("popstate",e),function(){return window.removeEventListener("popstate",e)}}),[e])}();var e=Object(i.useState)(void 0),t=Object(A.a)(e,2),n=t[0],r=t[1],a=Object(i.useState)(),c=Object(A.a)(a,2),o=c[0],s=c[1];return Object(Ce.jsxs)("div",{className:l.a.Wrapper,children:[Object(Ce.jsx)(En,{onMouseHoverDistanceChange:r,onHoverRoute:s}),Object(Ce.jsx)(Se,{mouseHoverDistance:n,previewRoute:o})]})}var Fn;n(428);r.a({enabled:(null!==(Fn="https://8fd04f9fdc64444391867b0088cf64f9@o260685.ingest.sentry.io/5791747")?Fn:"").length>0,dsn:"https://8fd04f9fdc64444391867b0088cf64f9@o260685.ingest.sentry.io/5791747",integrations:[new a.a.BrowserTracing],tracesSampleRate:1}),s.a.render(Object(Ce.jsx)(c.a.StrictMode,{children:Object(Ce.jsx)(Tn,{})}),document.getElementById("app"))},48:function(e,t,n){e.exports={Container:"Sidebar_Container__3o0kK",BottomSheetOpen:"Sidebar_BottomSheetOpen__22Bgs",SearchBox:"Sidebar_SearchBox__3wlGX",Content:"Sidebar_Content__15Hau",BottomMenu:"Sidebar_BottomMenu__2Obmz",NoGapDivider:"Sidebar_NoGapDivider__20DmD",DragHandle:"Sidebar_DragHandle__l0Son",DragHandleBottom:"Sidebar_DragHandleBottom__1sHmD"}}},[[429,1,2]]]);
//# sourceMappingURL=main.2739dfe7.chunk.js.map